/*! For license information please see web.client.api.bundle.js.LICENSE.txt */
var t={67:(t,e,n)=>{var i=n(368);n(48),n(412),n(46),n(250),e.connect=i.connect},825:(t,e,n)=>{var i=n(368),r=n(299),o=n(412);n(48),n(46),n(250);var s={},a={};Object.defineProperty(a,"__esModule",{value:!0}),a.mapValuesAsync=a.mapEntriesAsync=void 0;const c=(t,[e,n])=>({...t,[e]:n});async function d(t,e){return(await Promise.all(e.map((async([e,n])=>[e,await t(n,e)])))).reduce(c,{})}a.mapEntriesAsync=d,a.mapValuesAsync=async function(t,e){let n;return n=e instanceof Map?[...e.entries()]:Object.entries(e),d(t,n)};var l,h,u,p,f=i.commonjsGlobal&&i.commonjsGlobal.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},m=i.commonjsGlobal&&i.commonjsGlobal.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(s,"__esModule",{value:!0});var g=s.DefaultLayoutManager=void 0;const w=a;class y{constructor(t){h.set(this,void 0),u.set(this,new Map),f(this,h,t,"f")}size(){return m(this,u,"f").size}async applyLayoutSnapshot({layouts:t}){if(Object.keys(t).length>1)throw new Error("[LayoutManager] Tried to call applyLayoutSnapshot with more than 1 layout. When implementing multiple layouts via overridden LayoutManager class, you must override and fully implement the applyLayoutSnapshot method without calling super.applyLayoutSnapshot().");const[[e,n]]=Object.entries(t);await y.createLayout(this,{layoutName:e,layout:n})}async showLayout({layoutName:t}){}async getLayoutSnapshot(){return{layouts:await(0,w.mapValuesAsync)((t=>t.getFrameSnapshot()),m(this,u,"f"))}}async removeLayout({layoutName:t}){}getLayoutIdentityForView(t){const e=[...m(this,u,"f").values()].find((e=>e.getCurrentViews().some((e=>e.name===t.name&&e.uuid===t.uuid))));return e?.identity??void 0}isLayoutVisible({layoutName:t}){return m(y,l,"m",p).call(y,this,t).isVisible()}resolveLayoutIdentity(t){if(t&&"layoutName"in t)return t;const e=[...m(this,u,"f").values()];if(1===e.length)return e[0].identity;const n=e.find((t=>t.isVisible()));return n?.identity??void 0}static async resolveLayout(t,e){const n=t.resolveLayoutIdentity(e);if(void 0===n||!("layoutName"in n))throw new Error("[layout-manager] resolveLayout: Could not resolve the layout identity. Make sure you include 'layoutName' in the identity object.");return m(y,l,"m",p).call(y,t,n.layoutName)}static async handleSharedView(t,e,n){await(0,w.mapValuesAsync)((async t=>{if(t.identity.layoutName!==e.layoutName){const e=t.getCurrentViews().find((t=>t.name===n.name));e&&await t.onViewDetached({viewIdentity:e,target:null}).catch(console.error)}}),m(t,u,"f"))}static async handleLastViewRemoved(t,e){await t.removeLayout(e),await m(t,h,"f").handleLastViewRemoved(t)}static async destroyLayout(t,{layoutName:e}){await m(y,l,"m",p).call(y,t,e).destroy(),m(t,u,"f").delete(e)}static async createLayout(t,e){const{layoutName:n}=e;if(m(t,u,"f").has(n))throw new Error(`Layout name ${n} already exists`);await m(t,h,"f").createLayout(e,t)}static registerLayout(t,e,n){m(t,u,"f").set(e,n)}static getAllLayouts(t){return[...m(t,u,"f").values()]}static setInitialSnapshot(t,e){m(t,h,"f").setInitialSnapshot(e)}static createClosedConstructor(...t){return class extends y{constructor(){super(...t)}}}}g=s.DefaultLayoutManager=y,l=y,h=new WeakMap,u=new WeakMap,p=function(t,e){const n=m(t,u,"f").get(e);if(!n)throw new Error(`[layout-manager] getLayoutByName: Could not locate layout with name '${e}'`);return n};var v={};Object.defineProperty(v,"__esModule",{value:!0});var _=v.BaseLayout=void 0;_=v.BaseLayout=class{};var C={};Object.defineProperty(C,"__esModule",{value:!0});var b=C.DOMEmitter=void 0;b=C.DOMEmitter=class{constructor(t){this.container=t}dispatchLocalEvent(t,e){const n={...e,type:t,tabSelector:`tab-${e.name}`,containerSelector:`container-${e.name}`,topic:"openfin-DOM-event"};this.container.dispatchEvent(new CustomEvent(t,{detail:n}))}};var I={};Object.defineProperty(I,"__esModule",{value:!0});var E=I.isVisible=void 0;E=I.isVisible=t=>(0!==t.offsetWidth||0!==t.offsetHeight)&&"hidden"!==window.getComputedStyle(t).visibility&&t.offsetTop>=0&&t.offsetLeft>=0&&t.offsetTop<=window.innerHeight&&t.offsetLeft<=window.innerWidth;const x="initial_",S={show:"top",popout:!1,maximise:!1,close:"close-tab-unused"},A={headerHeight:31},P={hasHeaders:!0,reorderEnabled:!0},M={popoutWholeStack:!1,constrainDragToContainer:!1,constrainDragToHeaders:!1,preventDragout:!1,showMaximiseIcon:!1,showPopoutIcon:!1,showCloseIcon:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,selectionEnabled:!1};var L,R,O;class T{constructor(t){this.layout=t,L.set(this,void 0),R.set(this,void 0),this.handleResize=t=>{t.forEach((t=>this.resizeElement(t.target)))},this.handleMutation=()=>{this.layout.viewComponentsByContainerElement.forEach((t=>{this.resizeElement(t.container.element)}))},i.__classPrivateFieldSet(this,L,new ResizeObserver(this.handleResize),"f"),i.__classPrivateFieldSet(this,R,new MutationObserver(this.handleMutation),"f")}observeMutations(t){i.__classPrivateFieldGet(this,R,"f")?.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]})}destroy(){i.__classPrivateFieldGet(this,L,"f").disconnect(),i.__classPrivateFieldGet(this,R,"f").disconnect()}observeContainer(t){i.__classPrivateFieldGet(this,L,"f").observe(t)}unobserveContainer(t){i.__classPrivateFieldGet(this,L,"f").unobserve(t)}resizeElement(t){const e=this.layout.viewComponentsByContainerElement.get(t);e&&e.resize()}}function k(t=[],e){for(const n of t)"component"===n.type?Object.keys(e).forEach((t=>{t in n&&(n.componentState={[`${x}${t}`]:n[t],...n.componentState}),n[t]=e[t]})):k(n.content,e)}function z(t=[],e,n){for(const i of t)"component"===i.type?Object.keys(e).forEach((t=>{if(`${x}${t}`in i.componentState)return i[t]=i.componentState[`${x}${t}`],void delete i.componentState[`${x}${t}`];i[t]=e[t]})):(!i.size||"row"!==n&&"column"!==n||(i["row"===n?"width":"height"]=i.size?.includes(".")?parseFloat(i.size):parseInt(i.size)),z(i.content,e,i.type))}function B(t){if(t.root){t.root.content&&z([t.root],{componentName:"view",isClosable:!0});const e=t.root;t.content=[e],delete t.root}return t}L=new WeakMap,R=new WeakMap;class F{static create(t){const e=document.createElement("of-view");return Object.entries(t).forEach((([t,n])=>{e.setAttribute(t,n)})),e}}customElements.define("of-view",(t=>class extends t{connectedCallback(){if(!this.name||!this.uuid)throw new Error("<of-view> Name or uuid attribute missing");if(!this.src)throw new Error("<of-view> missing 'src' attribute.");this.#t||(this.#t=document.createElement("iframe"),this.#t.src=this.src,this.#t.style.height="100%",this.#t.style.width="100%",this.#t.style.border="none",this.forceFrameName?this.#t.setAttribute("name",this.forceFrameName):this.#t.setAttribute("name",i.encodeOptions({brokerUrl:this.brokerUrl,name:this.name,uuid:this.uuid,providerId:this.providerId,contextGroup:this.contextGroup},"of-frame")),this.#t.setAttribute("id",this.name),this.appendChild(this.#t))}#t;get brokerUrl(){return this.getAttribute("of-broker")}set brokerUrl(t){t&&this.setAttribute("of-broker",t)}get name(){return this.getAttribute("of-name")}set name(t){t&&this.setAttribute("of-name",t)}get forceFrameName(){return this.getAttribute("forceFrameName")}set forceFrameName(t){t&&this.setAttribute("forceFrameName",t)}get uuid(){return this.getAttribute("of-uuid")}set uuid(t){t&&this.setAttribute("of-uuid",t)}get src(){return this.getAttribute("src")}set src(t){t&&this.setAttribute("src",t)}get providerId(){return this.getAttribute("of-provider-id")}set providerId(t){t&&this.setAttribute("of-provider-id",t)}get contextGroup(){return this.getAttribute("of-context-group")}set contextGroup(t){t&&this.setAttribute("of-context-group",t)}static get observedAttributes(){return["name"]}})(HTMLElement));class D{constructor(t,e,n,{brokerUrl:i,interopConfig:r},s){this.container=t,this.config=e,this.ofView=null,this.isDragging=()=>this.container.tab.element?.className.includes("lm_dragging")??!1;const{url:a,web:c,interop:d}=e||{},l=`internal-generated-view-${o.v4()}`;if(this.identity={uuid:n,name:l},this.container.element.setAttribute("of-name",l),this.container.element.id=`container-${l}`,void 0===a)return void this.handleUrlMissing();const h=this.updateTitleIfNotSet(a),u={"of-broker":i,"of-uuid":n,"of-name":l,src:a};c?.frameName&&(u.forceFrameName=c.frameName);const p=d?.currentContextGroup??r?.currentContextGroup;p&&(u["of-context-group"]=p),r?.providerId&&(u["of-provider-id"]=r?.providerId),this.ofView=F.create(u),this.ofView.title=h??`Iframe: ${a}`,s.appendChild(this.ofView),this.ofView.style.position="absolute"}updateTitleIfNotSet(t){return"view"===this.container.parent.title&&this.container.parent.setTitle(t),this.container.parent.title}handleUrlMissing(){const t=document.createElement("div");t.setAttribute("style","padding: 20px"),t.innerText="No URL provided",this.container.element.appendChild(t)}destroy(){this.ofView?.remove(),this.ofView=null}resize(){if(this.ofView){if(this.isDragging())return void(this.ofView.style.display="none");const t=this.container.element.getBoundingClientRect();this.ofView.style.position="absolute",this.ofView.style.height=`${t.height}px`,this.ofView.style.width=`${t.width}px`,this.ofView.style.inset=`${t.top}px ${t.right}px ${t.bottom}px ${t.left}px`,this.ofView.style.display="block"}}}class U extends _{static overrideConfig(t){const e={...P,...t.settings,...M};return e.reorderEnabled?k(t.content,{isClosable:!0}):k(t.content,{reorderEnabled:!1}),{dimensions:A,...t,settings:e,header:{...S,show:!1!==t.settings?.hasHeaders&&S.show}}}constructor(t,e,n,{options:i},o){super(),this.identity=t,this.container=e,this.initialConfig=n,this.layoutManager=o,this.viewComponentsByContainerElement=new Map,this.createViewComponent=(t,e)=>{const n=new D(t,e,this.identity.uuid,this.options,this.iframeContainer);return e&&!1===e[`${x}isClosable`]&&this.stylesheet.insertRule(`#tab-${n.identity.name} .lm_close_tab { display: none; }`),this.viewComponentsByContainerElement.set(t.element,n),this.resizeController.observeContainer(t.element),n},this.iframeContainer=document.createElement("div"),this.iframeContainer.id=`openfin-layout-iframe-container-${this.identity.layoutName}`,this.domEmitter=new b(e),this.setupStylesheets(),this.layout=new r.GoldenLayout(this.container),this.layout.resizeWithContainerAutomatically=!0,this.options=i,this.layout.registerComponent("view",this.createViewComponent),this.setupListeners(),this.resizeController=new T(this),this.layout.loadLayout(U.overrideConfig(n));const s=document.createElement("div");s.id=`openfin-layout-shadow-container-${this.identity.layoutName}`,s.attachShadow({mode:"open",delegatesFocus:!1}).appendChild(this.iframeContainer),this.container.appendChild(s),this.resizeController.observeMutations(this.container)}setupStylesheets(){if(this.container.setAttribute("data-openfin-layout-name",this.identity.layoutName),this.stylesheet=new CSSStyleSheet,this.stylesheet.insertRule(".lm_close { display: none; }"),document.adoptedStyleSheets.push(this.stylesheet),this.initialConfig.settings?.preventSplitterResize){const t=`\n            [data-openfin-layout-name='${this.identity.layoutName}'] .lm_splitter {\n                pointer-events: none;\n            }`;this.stylesheet.insertRule(t)}}addView(t){throw new Error("Method not implemented.")}replaceView({viewToReplace:t,newView:e}){throw new Error("Method not implemented.")}replaceLayout(t){throw new Error("Method not implemented.")}closeView(t){throw new Error("Method not implemented.")}applyPreset(t){throw new Error("Method not implemented.")}getCurrentViews(){return[...this.viewComponentsByContainerElement.values()].map((t=>t.identity))}async getFrameSnapshot(){return B(r.LayoutConfig.fromResolved(this.layout.toConfig()))}isVisible(){return E(this.container)}async onViewDetached(){throw new Error("Method not implemented.")}async destroy(){this.layout.destroy(),this.iframeContainer.remove(),this.resizeController.destroy(),document.adoptedStyleSheets=document.adoptedStyleSheets.filter((t=>t!==this.stylesheet)),this.viewComponentsByContainerElement.clear()}setupListeners(){this.container.addEventListener("pointerdown",(t=>{if(t.target instanceof HTMLElement){const e=t.target.classList;["lm_tab","lm_title","lm_splitter","lm_drag_handle"].some((t=>e.contains(t)))&&(this.handleDragStart(),2===t.button&&t.stopPropagation())}}),!0),document.addEventListener("pointerup",(()=>this.handleDragEnd()),!0),this.layout.on("tabCreated",(t=>{const e=t.componentItem.container.element.getAttribute("of-name")??o.v4(),n={name:e,uuid:e};t.element.id=`tab-${e}`,this.domEmitter.dispatchLocalEvent("tab-created",n)}));const t=t=>{const e=t.handleResize.bind(t);t.handleResize=function(t){"block"===getComputedStyle(t).display&&e()}.bind(t,this.container)};this.layout.on("itemCreated",(({target:e})=>{const n=e;if(n.isStack)return void t(n);if(!n.isComponent)return;const i=n.element.querySelector("[of-name]")?.getAttribute("of-name")??o.v4(),r={name:i,uuid:i};this.domEmitter.dispatchLocalEvent("container-created",r)})),this.layout.on("itemDestroyed",(t=>{if(!t.target.isComponent)return;const e=t.target;this.removeViewComponent(e.component)})),this.layout.on("itemDropped",(()=>{this.handleDragEnd()}))}handleDragStart(){this.iframeContainer.style.pointerEvents="none"}handleDragEnd(){this.iframeContainer.style.pointerEvents=""}removeViewComponent(t){if(t.config&&!1===t.config[`${x}isClosable`]){const e=[...this.stylesheet.cssRules].findIndex((e=>e.cssText.includes(`#tab-${t.identity.name}`)));this.stylesheet.deleteRule(e)}t.destroy(),this.viewComponentsByContainerElement.delete(t.container.element),this.resizeController.unobserveContainer(t.container.element),0===this.getCurrentViews().length&&g.handleLastViewRemoved(this.layoutManager,this.identity)}}class j{constructor(t,e,n){this.windowIdentity=t,this.connectConfig=e,this.fallbackContainer=n}async createLayout(t,e){if(!("container"in t)&&!this.fallbackContainer)throw new Error("Container property is not optional in web");const{layout:n,layoutName:i}=t,r=t.container??this.fallbackContainer,o={...this.windowIdentity,layoutName:i};this.webLayout=new U(o,r,n,this.connectConfig,e),g.registerLayout(e,i,this.webLayout),this.fallbackContainer=null}async getLayoutSnapshot(t){return t.getLayoutSnapshot()}async handleLastViewRemoved(t){}}const W=t=>t;O=new WeakMap,e.WebLayoutEntryPoint=class{constructor(t){O.set(this,void 0),this.initLayoutManager=async(t,e,{container:n,layoutManagerOverride:r})=>{const o=r??W,s=new j(e.me,i.__classPrivateFieldGet(this,O,"f"),n);return new(o(g.createClosedConstructor(s)))},this.applyLayoutSnapshot=async(t,e,n)=>{await e.applyLayoutSnapshot(i.__classPrivateFieldGet(this,O,"f").platform.layoutSnapshot)},this.createLayout=async(t,e)=>g.createLayout(t,e),this.destroyLayout=async(t,e)=>g.destroyLayout(t,e),i.__classPrivateFieldSet(this,O,t,"f")}}},368:(t,e,n)=>{var i=n(48),r=n(46),o=n(250),s=n(412);const a=(t,e)=>`${e}<${btoa(JSON.stringify(t))}>`;var c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},d={},l={},h={},u={};async function p(t){const e=[];for(const n of t){const t=await n();e.push(t)}return e}Object.defineProperty(u,"__esModule",{value:!0}),u.promiseMapSerial=u.serial=u.promiseMap=u.promisify=void 0,u.promisify=function(t){return(...e)=>new Promise(((n,i)=>{t(...e,((t,e)=>t?i(t):n(e)))}))},u.promiseMap=async function(t,e){return Promise.all(t.map(e))},u.serial=p,u.promiseMapSerial=async function(t,e){return p(t.map(((t,n,i)=>()=>e(t,n,i))))};var f,m=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},g=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(h,"__esModule",{value:!0}),h.Reply=h.EmitterBase=h.Base=void 0;const w=u;class y{constructor(t){this.isNodeEnvironment=()=>"node"===this.wire.environment.type,this.isOpenFinEnvironment=()=>"openfin"===this.wire.environment.type,this.isBrowserEnvironment=()=>"other"===this.wire.environment.type,this.wire=t}get fin(){return this.wire.getFin()}get me(){return this.wire.me}}h.Base=y,h.EmitterBase=class extends y{constructor(t,e,...n){super(t),this.topic=e,f.set(this,void 0),this.eventNames=()=>this.hasEmitter()?this.getOrCreateEmitter().eventNames():[],this.emit=(t,e,...n)=>!!this.hasEmitter()&&this.getOrCreateEmitter().emit(t,e,...n),this.hasEmitter=()=>this.wire.eventAggregator.has(g(this,f,"f")),this.getOrCreateEmitter=()=>this.wire.eventAggregator.getOrCreate(g(this,f,"f")),this.listeners=t=>this.hasEmitter()?this.getOrCreateEmitter().listeners(t):[],this.listenerCount=t=>this.hasEmitter()?this.getOrCreateEmitter().listenerCount(t):0,this.registerEventListener=async(t,e={},n,i)=>{const r={...this.identity,timestamp:e.timestamp||Date.now(),topic:this.topic,type:t},o=this.getOrCreateEmitter();n(o);try{await this.wire.sendAction("subscribe-to-desktop-event",r)}catch(t){throw i(o),this.deleteEmitterIfNothingRegistered(o),t}},this.deregisterEventListener=async(t,e={})=>{if(this.hasEmitter()){const n={...this.identity,timestamp:e.timestamp||Date.now(),topic:this.topic,type:t};return await this.wire.sendAction("unsubscribe-to-desktop-event",n).catch((()=>null)),this.getOrCreateEmitter()}return Promise.resolve()},m(this,f,[e,...n],"f"),this.listeners=t=>this.hasEmitter()?this.getOrCreateEmitter().listeners(t):[]}async on(t,e,n){return await this.registerEventListener(t,n,(n=>{n.on(t,e)}),(n=>{n.removeListener(t,e)})),this}async addListener(t,e,n){return this.on(t,e,n)}async once(t,e,n){const i=()=>this.deregisterEventListener(t);return await this.registerEventListener(t,n,(n=>{n.once(t,i),n.once(t,e)}),(n=>{n.removeListener(t,i),n.removeListener(t,e)})),this}async prependListener(t,e,n){return await this.registerEventListener(t,n,(n=>{n.prependListener(t,e)}),(n=>{n.removeListener(t,e)})),this}async prependOnceListener(t,e,n){const i=()=>this.deregisterEventListener(t);return await this.registerEventListener(t,n,(n=>{n.prependOnceListener(t,e),n.once(t,i)}),(n=>{n.removeListener(t,e),n.removeListener(t,i)})),this}async removeListener(t,e,n){const i=await this.deregisterEventListener(t,n);return i&&(i.removeListener(t,e),this.deleteEmitterIfNothingRegistered(i)),this}async deregisterAllListeners(t){const e={...this.identity,type:t,topic:this.topic};if(this.hasEmitter()){const t=this.getOrCreateEmitter(),n=t.listenerCount(e.type),i=[];for(let t=0;t<n;t++)i.push(this.wire.sendAction("unsubscribe-to-desktop-event",e).catch((()=>null)));return await Promise.all(i),t}}async removeAllListeners(t){const e=async t=>{const e=await this.deregisterAllListeners(t);e&&(e.removeAllListeners(t),this.deleteEmitterIfNothingRegistered(e))};if(t)await e(t);else if(this.hasEmitter()){const t=this.getOrCreateEmitter().eventNames();await(0,w.promiseMap)(t,e)}return this}deleteEmitterIfNothingRegistered(t){0===t.eventNames().length&&this.wire.eventAggregator.delete(g(this,f,"f"))}},f=new WeakMap,h.Reply=class{};var v={};Object.defineProperty(v,"__esModule",{value:!0});var _=v.RuntimeError=v.NotSupportedError=v.NotImplementedError=v.NoAckError=v.DuplicateCorrelationError=v.UnexpectedActionError=v.DisconnectedError=void 0;class C extends Error{constructor(t){super(`Expected websocket state OPEN but found ${t}`),this.readyState=t}}v.DisconnectedError=C;class b extends Error{}v.UnexpectedActionError=b;class I extends Error{}v.DuplicateCorrelationError=I;class E extends Error{}v.NoAckError=E;class x extends Error{}v.NotImplementedError=x;class S extends Error{}v.NotSupportedError=S;class A extends Error{constructor(t){const{message:e,name:n,stack:i,...r}=t;super(e),this.name=n||"Error",this.stack=i??this.toString(),Object.keys(r).forEach((t=>{this[t]=r[t]}))}}class P extends Error{static getCallSite(t=0){const e=Error.stackTraceLimit,n=t+1;Error.stackTraceLimit=e+n;const i=Error.prepareStackTrace;Error.prepareStackTrace=(t,e)=>e;const r=(new Error).stack?.slice(n)??[];return Error.prepareStackTrace=i,Error.stackTraceLimit=e,r}static prepareStackTrace(t,e){if("function"==typeof Error.prepareStackTrace)return Error.prepareStackTrace(t,e);let n="";n+=t.name||"Error",n+=`: ${t.message||""}`;for(const t of e)n+=`\n    at ${t.toString()}`;return n}constructor(t,e){const{reason:n,error:i}=t;super(n),this.name="RuntimeError",i?.stack&&(this.cause=new A(i)),e&&(this.stack=P.prepareStackTrace(this,e))}}_=v.RuntimeError=P;var M={},L={},R={};Object.defineProperty(R,"__esModule",{value:!0}),R.validateIdentity=void 0,R.validateIdentity=function(t){let e;return"object"==typeof t&&"string"==typeof t.uuid||(e="Not a valid identity object"),e};var O,T={},k={},z={},B={},F={},D={},U={};Object.defineProperty(U,"__esModule",{value:!0}),U.handleDeprecatedWarnings=void 0,U.handleDeprecatedWarnings=t=>{(t.contentNavigation?.whitelist||t.contentNavigation?.blacklist||t.contentRedirect?.whitelist||t.contentRedirect?.blacklist)&&console.warn("The properties 'whitelist' and 'blacklist' have been marked as deprecated and will be removed in a future version. Please use 'allowlist' and 'denylist'.")};var j={},W={};Object.defineProperty(W,"__esModule",{value:!0}),W.AsyncRetryableLazy=$=W.Lazy=void 0;var $=W.Lazy=class{constructor(t){this.producerFn=t}getValue(){return this.value||(this.value=this.producerFn()),this.value}};W.AsyncRetryableLazy=class{constructor(t){this.producerFn=t}async getValue(){return this.promise||(this.promise=this.producerFn().catch((t=>{throw delete this.promise,t}))),this.promise}};var H={},N={},G={};Object.defineProperty(G,"__esModule",{value:!0}),G.ApiConsumer=void 0,G.ApiConsumer=class{constructor(t){this.strategy=t,this.consume=async t=>(await this.strategy.getExposedFunctions(t)).reduce(((e,n)=>({...e,[n.key]:this.strategy.createFunction(n,t)})),{})}};var V={},q={};Object.defineProperty(q,"__esModule",{value:!0}),q.expose=q.getExposedProperties=void 0;const Z=Symbol("exposedProperties");q.getExposedProperties=t=>t[Z]||t.prototype[Z]||[],q.expose=t=>(e,n,i)=>{e[Z]=e[Z]||[],e[Z].push({key:n,descriptor:i,options:t})},Object.defineProperty(V,"__esModule",{value:!0}),V.ApiExposer=void 0;const Y=q;V.ApiExposer=class{constructor(t){this.strategy=t,this.exposeInstance=async(t,e)=>{const n=(0,Y.getExposedProperties)(t),i=await Promise.all(n.map((async({key:n,options:i})=>({key:n,options:await this.strategy.exposeFunction(t[n].bind(t),{key:n,options:i,meta:e})}))));await this.strategy.exposeMeta(e,i)}}};var J={},K={},X={};Object.defineProperty(X,"__esModule",{value:!0}),X.ChannelsConsumer=void 0,X.ChannelsConsumer=class{constructor(t){this.channel=t,this.getExposedFunctions=async t=>{const{id:e}=t,{props:n}=await this.channel.dispatch(`api-meta:${e}`);return n},this.createFunction=t=>(...e)=>{const{action:n}=t.options;return this.channel.dispatch(n,{args:e})}}};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.ChannelsExposer=void 0,Q.ChannelsExposer=class{constructor(t){this.channelProviderOrClient=t,this.exposeFunction=async(t,e)=>{const{key:n,options:i,meta:r}=e,{id:o}=r,s=`${o}.${i?.action||n}`;return await this.channelProviderOrClient.register(s,(async({args:e})=>t(...e))),{action:s}},this.exposeMeta=async({id:t},e)=>{const n=`api-meta:${t}`;await this.channelProviderOrClient.register(n,(()=>({props:e})))}}},function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(X,t),n(Q,t)}(K),function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(K,t)}(J),function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(G,t),n(V,t),n(J,t),n(q,t)}(N);var tt={};Object.defineProperty(tt,"__esModule",{value:!0}),tt.createRelayedDispatch=tt.relayChannelClientApi=void 0;const et=["no longer connected","RTCDataChannel closed unexpectedly","The client you are trying to dispatch from is disconnected from the target provider"];tt.relayChannelClientApi=async(t,e)=>{t.register(`relay:${e}`,(({action:e,target:n,payload:i})=>t.dispatch(n,e,i))),await Promise.resolve()},tt.createRelayedDispatch=(t,e,n,i)=>async(r,o)=>{try{return await t.dispatch(`relay:${n}`,{action:r,payload:o,target:e})}catch(t){if(s=t.message,et.some((t=>s.includes(t)))&&i)throw new Error(i);throw t}var s};var nt,it,rt,ot=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},st=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(H,"__esModule",{value:!0}),H.ColumnOrRow=H.TabStack=H.LayoutNode=void 0;const at=N,ct=tt;class dt{constructor(t,e){nt.set(this,void 0),this.isRoot=()=>st(this,nt,"f").isRoot(this.entityId),this.exists=()=>st(this,nt,"f").exists(this.entityId),this.getParent=async()=>{const t=await st(this,nt,"f").getParent(this.entityId);if(t)return dt.getEntity(t,st(this,nt,"f"))},this.createAdjacentStack=async(t,e)=>{const n=await st(this,nt,"f").createAdjacentStack(this.entityId,t,e);return dt.getEntity({entityId:n,type:"stack"},st(this,nt,"f"))},this.getAdjacentStacks=async t=>(await st(this,nt,"f").getAdjacentStacks({targetId:this.entityId,edge:t})).map((t=>dt.getEntity({type:"stack",entityId:t.entityId},st(this,nt,"f")))),ot(this,nt,t,"f"),this.entityId=e}}H.LayoutNode=dt,nt=new WeakMap,dt.newLayoutEntitiesClient=async(t,e,n)=>{const i=(0,ct.createRelayedDispatch)(t,n,"layout-relay","You are trying to interact with a layout component on a window that does not exist or has been destroyed.");return new at.ApiConsumer(new at.ChannelsConsumer({dispatch:i})).consume({id:e})},dt.getEntity=(t,e)=>{const{entityId:n,type:i}=t;switch(i){case"column":case"row":return new ht(e,n,i);case"stack":return new lt(e,n);default:throw new Error(`Unrecognised Layout Entity encountered ('${JSON.stringify(t)})`)}};class lt extends dt{constructor(t,e){super(t,e),it.set(this,void 0),this.type="stack",this.getViews=()=>st(this,it,"f").getStackViews(this.entityId),this.addView=async(t,e={index:0})=>st(this,it,"f").addViewToStack(this.entityId,t,e),this.removeView=async t=>{await st(this,it,"f").removeViewFromStack(this.entityId,t)},this.setActiveView=async t=>{await st(this,it,"f").setStackActiveView(this.entityId,t)},ot(this,it,t,"f")}}H.TabStack=lt,it=new WeakMap;class ht extends dt{constructor(t,e,n){super(t,e),rt.set(this,void 0),this.getContent=async()=>(await st(this,rt,"f").getContent(this.entityId)).map((t=>dt.getEntity(t,st(this,rt,"f")))),ot(this,rt,t,"f"),this.type=n}}H.ColumnOrRow=ht,rt=new WeakMap;var ut={};Object.defineProperty(ut,"__esModule",{value:!0}),ut.DEFAULT_LAYOUT_KEY=ut.LAYOUT_CONTROLLER_ID=void 0,ut.LAYOUT_CONTROLLER_ID="layout-entities",ut.DEFAULT_LAYOUT_KEY="__default__";var pt={};Object.defineProperty(pt,"__esModule",{value:!0}),pt.WebContents=void 0;const ft=h;class mt extends ft.EmitterBase{constructor(t,e,n){super(t,n,e.uuid,e.name),this.identity=e,this.entityType=n}capturePage(t){return this.wire.sendAction("capture-page",{options:t,...this.identity}).then((({payload:t})=>t.data))}executeJavaScript(t){return this.wire.sendAction("execute-javascript-in-window",{...this.identity,code:t}).then((({payload:t})=>t.data))}getZoomLevel(){return this.wire.sendAction("get-zoom-level",this.identity).then((({payload:t})=>t.data))}setZoomLevel(t){return this.wire.sendAction("set-zoom-level",{...this.identity,level:t}).then((()=>{}))}navigate(t){return this.wire.sendAction("navigate-window",{...this.identity,url:t}).then((()=>{}))}navigateBack(){return this.wire.sendAction("navigate-window-back",{...this.identity}).then((()=>{}))}async navigateForward(){await this.wire.sendAction("navigate-window-forward",{...this.identity})}stopNavigation(){return this.wire.sendAction("stop-window-navigation",{...this.identity}).then((()=>{}))}reload(t=!1){return this.wire.sendAction("reload-window",{ignoreCache:t,...this.identity}).then((()=>{}))}print(t={}){return this.wire.sendAction("print",{...this.identity,options:t}).then((()=>{}))}findInPage(t,e){return this.wire.sendAction("find-in-page",{...this.identity,searchTerm:t,options:e}).then((({payload:t})=>t.data))}stopFindInPage(t){return this.wire.sendAction("stop-find-in-page",{...this.identity,action:t}).then((()=>{}))}getPrinters(){return this.wire.sendAction("get-printers",{...this.identity}).then((({payload:t})=>t.data))}async focus({emitSynthFocused:t}={emitSynthFocused:!0}){await this.wire.sendAction("focus-window",{emitSynthFocused:t,...this.identity})}async showDeveloperTools(){await this.wire.sendAction("show-developer-tools",this.identity)}async getProcessInfo(){const{payload:{data:t}}=await this.wire.sendAction("get-process-info",this.identity);return t}async getSharedWorkers(){return this.wire.sendAction("get-shared-workers",this.identity).then((({payload:t})=>t.data))}async inspectSharedWorker(){await this.wire.sendAction("inspect-shared-worker",{...this.identity})}async inspectSharedWorkerById(t){await this.wire.sendAction("inspect-shared-worker-by-id",{...this.identity,workerId:t})}async inspectServiceWorker(){await this.wire.sendAction("inspect-service-worker",{...this.identity})}async showPopupWindow(t){if(this.wire.sendAction(`${this.entityType}-show-popup-window`,this.identity).catch((()=>{})),t?.onPopupReady){const e=async({popupName:e})=>{try{const n=this.fin.Window.wrapSync({uuid:this.fin.me.uuid,name:e});await t.onPopupReady(n)}catch(t){throw new Error(`Something went wrong during onPopupReady execution: ${t}`)}};await this.once("popup-ready",e)}const{payload:e}=await this.wire.sendAction("try-create-popup-window",{options:{...t,hasResultCallback:!!t?.onPopupResult,hasReadyCallback:!!t?.onPopupReady},...this.identity}),{data:{willOpen:n,options:i}}=e;if(n&&await this.fin.Window.create(i.initialOptions),t?.onPopupResult){const e=async e=>{await t.onPopupResult((t=>{const{name:e,uuid:n,result:i,data:r}=t,o={identity:{name:e,uuid:n},result:i};return r&&(o.data=r),o})(e))},n=async()=>{await this.removeListener("popup-result",e)};await this.on("popup-result",e),await this.once("popup-teardown",n)}const{payload:r}=await this.wire.sendAction("show-popup-window",{options:i,...this.identity});return r.data}}var gt,wt,yt,vt,_t;function Ct(){return wt||(wt=1,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(function(){if(O)return D;O=1,Object.defineProperty(D,"__esModule",{value:!0}),D.ViewModule=void 0;const t=h,e=R,n=Ct(),i=U;class r extends t.Base{async create(t){const{uuid:e}=this.wire.me;if(!t.name||"string"!=typeof t.name)throw new Error("Please provide a name property as a string in order to create a View.");return(0,i.handleDeprecatedWarnings)(t),this.wire.environment.childViews?await this.wire.environment.createChildContent({entityType:"view",options:{...t,uuid:e}}):await this.wire.sendAction("create-view",{...t,uuid:e}),this.wrapSync({uuid:e,name:t.name})}async wrap(t){this.wire.sendAction("view-wrap");const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n.View(this.wire,t)}wrapSync(t){this.wire.sendAction("view-wrap-sync").catch((t=>{}));const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n.View(this.wire,t)}getCurrent(){if(this.wire.sendAction("view-get-current").catch((t=>{})),!this.wire.me.isView)throw new Error("You are not in a View context");const{uuid:t,name:e}=this.wire.me;return this.wrap({uuid:t,name:e})}getCurrentSync(){if(this.wire.sendAction("view-get-current-sync").catch((t=>{})),!this.wire.me.isView)throw new Error("You are not in a View context");const{uuid:t,name:e}=this.wire.me;return this.wrapSync({uuid:t,name:e})}}return D.ViewModule=r,D}(),t),n(function(){if(gt)return j;gt=1;var t,e=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(j,"__esModule",{value:!0}),j.View=void 0;const n=v,i=W,r=H,o=ut,s=pt,a=Mt();class d extends s.WebContents{constructor(s,c){super(s,c,"view"),this.identity=c,t.set(this,new i.Lazy((()=>this.fin.Platform.wrapSync(this.identity).getClient()))),this.attach=async t=>{await this.wire.sendAction("attach-view",{target:t,...this.identity})},this.destroy=async()=>{await this.wire.sendAction("destroy-view",{...this.identity})},this.show=async()=>{await this.wire.sendAction("show-view",{...this.identity})},this.showAt=async(t,e={})=>{await this.wire.sendAction("show-view-at",{bounds:t,...this.identity,options:e})},this.bringToFront=async()=>{await this.wire.sendAction("bring-view-to-front",{...this.identity})},this.hide=async()=>{await this.wire.sendAction("hide-view",{...this.identity})},this.setBounds=async t=>{await this.wire.sendAction("set-view-bounds",{bounds:t,...this.identity})},this.getBounds=async()=>(await this.wire.sendAction("get-view-bounds",{...this.identity})).payload.data,this.getInfo=async()=>(await this.wire.sendAction("get-view-info",{...this.identity})).payload.data,this.getParentLayout=async()=>{this.wire.sendAction("view-get-parent-layout",{...this.identity}).catch((()=>{}));let n=(await this.getCurrentWindow()).identity;n.identity&&(n=n.identity);try{const i=await e(this,t,"f").getValue(),s=await r.LayoutNode.newLayoutEntitiesClient(i,o.LAYOUT_CONTROLLER_ID,n),a=await s.getLayoutIdentityForViewOrThrow(this.identity);return this.fin.Platform.Layout.wrap(a)}catch(t){if(!["No action registered at target for","getLayoutIdentityForViewOrThrow is not a function"].some((e=>t.message.includes(e))))throw t;return this.fin.Platform.Layout.wrap(n)}},this.getOptions=async()=>this.wire.sendAction("get-view-options",{...this.identity}).then((({payload:t})=>t.data)),this.updateOptions=async t=>this.wire.sendAction("update-view-options",{options:t,...this.identity}).then((()=>{})),this.getCurrentWindow=async()=>{const{payload:{data:t}}=await this.wire.sendAction("get-view-window",{...this.identity});return new a._Window(this.wire,t)},this.getCurrentStack=async()=>{this.wire.sendAction("view-get-current-stack").catch((()=>{}));try{const n=await this.getCurrentWindow(),i=await e(this,t,"f").getValue(),s=await r.LayoutNode.newLayoutEntitiesClient(i,o.LAYOUT_CONTROLLER_ID,n.identity),a=await s.getStackByView(this.identity);return r.LayoutNode.getEntity(a,s)}catch(t){throw new n.RuntimeError({reason:"This view does not belong to a stack.",error:t})}},this.triggerBeforeUnload=async()=>(await this.wire.sendAction("trigger-before-unload",{...this.identity})).payload.data,this.bindToElement=async t=>{if(!t)throw new Error("Element not found.");return this.wire.environment.observeBounds(t,(async t=>this.setBounds(t)))}}async focus({emitSynthFocused:t}={emitSynthFocused:!0}){const e=await this.getCurrentWindow();await e.focusedWebViewWasChanged(),await super.focus({emitSynthFocused:t})}}return j.View=d,t=new WeakMap,j}(),t)}(F)),F}function bt(){if(yt)return B;yt=1,Object.defineProperty(B,"__esModule",{value:!0}),B.Application=void 0;const t=h,e=Mt(),n=Ct();class i extends t.EmitterBase{constructor(t,n){super(t,"application",n.uuid),this.identity=n,this.window=new e._Window(this.wire,{uuid:this.identity.uuid,name:this.identity.uuid})}windowListFromIdentityList(t){const n=[];return t.forEach((t=>{n.push(new e._Window(this.wire,{uuid:t.uuid,name:t.name}))})),n}isRunning(){return this.wire.sendAction("is-application-running",this.identity).then((({payload:t})=>t.data))}async quit(t=!1){try{await this._close(t),await this.wire.sendAction("destroy-application",{force:t,...this.identity})}catch(t){if(!["Remote connection has closed","Could not locate the requested application"].some((e=>t.message.includes(e))))throw t}}async _close(t=!1){try{await this.wire.sendAction("close-application",{force:t,...this.identity})}catch(t){if(!t.message.includes("Remote connection has closed"))throw t}}close(t=!1){return console.warn("Deprecation Warning: Application.close is deprecated Please use Application.quit"),this.wire.sendAction("application-close",this.identity).catch((t=>{})),this._close(t)}getChildWindows(){return this.wire.sendAction("get-child-windows",this.identity).then((({payload:t})=>{const e=[];return t.data.forEach((t=>{e.push({uuid:this.identity.uuid,name:t})})),this.windowListFromIdentityList(e)}))}getManifest(){return this.wire.sendAction("get-application-manifest",this.identity).then((({payload:t})=>t.data))}getParentUuid(){return this.wire.sendAction("get-parent-application",this.identity).then((({payload:t})=>t.data))}getShortcuts(){return this.wire.sendAction("get-shortcuts",this.identity).then((({payload:t})=>t.data))}async getViews(){const{payload:t}=await this.wire.sendAction("application-get-views",this.identity);return t.data.map((t=>new n.View(this.wire,t)))}getZoomLevel(){return this.wire.sendAction("get-application-zoom-level",this.identity).then((({payload:t})=>t.data))}getWindow(){return this.wire.sendAction("application-get-window",this.identity).catch((t=>{})),Promise.resolve(this.window)}registerUser(t,e){return this.wire.sendAction("register-user",{userName:t,appName:e,...this.identity}).then((()=>{}))}removeTrayIcon(){return this.wire.sendAction("remove-tray-icon",this.identity).then((()=>{}))}restart(){return this.wire.sendAction("restart-application",this.identity).then((()=>{}))}run(){return console.warn("Deprecation Warning: Application.run is deprecated Please use fin.Application.start"),this.wire.sendAction("application-run",this.identity).catch((t=>{})),this._run()}_run(t={}){return this.wire.sendAction("run-application",{manifestUrl:this._manifestUrl,opts:t,...this.identity}).then((()=>{}))}scheduleRestart(){return this.wire.sendAction("relaunch-on-close",this.identity).then((()=>{}))}async sendApplicationLog(){const{payload:t}=await this.wire.sendAction("send-application-log",this.identity);return t.data}async setJumpList(t){await this.wire.sendAction("set-jump-list",{config:t,...this.identity})}setTrayIcon(t){return this.wire.sendAction("set-tray-icon",{enabledIcon:t,...this.identity}).then((()=>{}))}setShortcuts(t){return this.wire.sendAction("set-shortcuts",{data:t,...this.identity}).then((()=>{}))}async setShortcutQueryParams(t){await this.wire.sendAction("set-shortcut-query-args",{data:t,...this.identity})}setZoomLevel(t){return this.wire.sendAction("set-application-zoom-level",{level:t,...this.identity}).then((()=>{}))}async setAppLogUsername(t){await this.wire.sendAction("set-app-log-username",{data:t,...this.identity})}getTrayIconInfo(){return this.wire.sendAction("get-tray-icon-info",this.identity).then((({payload:t})=>t.data))}hasTrayIcon(){return this.wire.sendAction("has-tray-icon",this.identity).then((({payload:t})=>t.data))}terminate(){return this.wire.sendAction("terminate-application",this.identity).then((()=>{}))}wait(){return this.wire.sendAction("wait-for-hung-application",this.identity).then((()=>{}))}getInfo(){return this.wire.sendAction("get-info",this.identity).then((({payload:t})=>t.data))}async getProcessInfo(){const{payload:{data:t}}=await this.wire.sendAction("application-get-process-info",this.identity);return t}async setFileDownloadLocation(t){const{name:e}=this.wire.me,n={uuid:this.identity.uuid,name:e};await this.wire.sendAction("set-file-download-location",{...n,downloadLocation:t})}async getFileDownloadLocation(){const{payload:{data:t}}=await this.wire.sendAction("get-file-download-location",this.identity);return t}async showTrayIconPopupMenu(t){const{name:e}=this.wire.me,n={uuid:this.identity.uuid,name:e},{payload:i}=await this.wire.sendAction("show-tray-icon-popup-menu",{...n,options:t});return i.data}async closeTrayIconPopupMenu(){const{name:t}=this.wire.me,e={uuid:this.identity.uuid,name:t};await this.wire.sendAction("close-tray-icon-popup-menu",{...e})}}return B.Application=i,B}function It(){return _t||(_t=1,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(function(){if(vt)return z;vt=1,Object.defineProperty(z,"__esModule",{value:!0}),z.ApplicationModule=void 0;const t=h,e=R,n=bt();class i extends t.Base{async wrap(t){this.wire.sendAction("wrap-application").catch((t=>{}));const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n.Application(this.wire,t)}wrapSync(t){this.wire.sendAction("wrap-application-sync").catch((t=>{}));const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n.Application(this.wire,t)}async _create(t){return void 0===t.waitForPageLoad&&(t.waitForPageLoad=!1),void 0===t.autoShow&&void 0===t.isPlatformController&&(t.autoShow=!0),await this.wire.sendAction("create-application",t),this.wrap({uuid:t.uuid})}create(t){return console.warn("Deprecation Warning: fin.Application.create is deprecated. Please use fin.Application.start"),this.wire.sendAction("application-create").catch((t=>{})),this._create(t)}async start(t){this.wire.sendAction("start-application").catch((t=>{}));const e=await this._create(t);return await this.wire.sendAction("run-application",{uuid:t.uuid}),e}async startManyManifests(t,e){return this.wire.sendAction("run-applications",{applications:t,opts:e}).then((()=>{}))}getCurrent(){return this.wire.sendAction("get-current-application").catch((t=>{})),this.wrap({uuid:this.wire.me.uuid})}getCurrentSync(){return this.wire.sendAction("get-current-application-sync").catch((t=>{})),this.wrapSync({uuid:this.wire.me.uuid})}async startFromManifest(t,e){this.wire.sendAction("application-start-from-manifest").catch((t=>{}));const n=await this._createFromManifest(t);return await n._run(e),n}createFromManifest(t){return console.warn("Deprecation Warning: fin.Application.createFromManifest is deprecated. Please use fin.Application.startFromManifest"),this.wire.sendAction("application-create-from-manifest").catch((t=>{})),this._createFromManifest(t)}_createFromManifest(t){return this.wire.sendAction("get-application-manifest",{manifestUrl:t}).then((({payload:t})=>{const e=t.data.platform?t.data.platform.uuid:t.data.startup_app.uuid;return this.wrap({uuid:e})})).then((e=>(e._manifestUrl=t,e)))}}return z.ApplicationModule=i,z}(),t),n(bt(),t)}(k)),k}pt.WebContents=mt;var Et,xt,St,At={};function Pt(){if(Et)return T;Et=1,Object.defineProperty(T,"__esModule",{value:!0}),T._Window=void 0;const t=It(),e=pt,n=Ct(),i=U,r=At;class o extends e.WebContents{constructor(t,e){super(t,e,"window")}async createWindow(t){this.wire.sendAction("window-create-window",this.identity).catch((t=>{}));const e=await(0,r.promisifySubscription)(this,"fire-constructor-callback");void 0===t.waitForPageLoad&&(t.waitForPageLoad=!1),void 0===t.autoShow&&(t.autoShow=!0),(0,i.handleDeprecatedWarnings)(t);const n=this.wire.environment.createChildContent({entityType:"window",options:t}),[o]=await Promise.all([e.getValue(),n]);let s;const{success:a}=o,c=o.data,{message:d}=c;s=a?{httpResponseCode:c.httpResponseCode,apiInjected:c.apiInjected}:{message:c.message,networkErrorCode:c.networkErrorCode,stack:c.stack};const l={message:d,cbPayload:s,success:a};try{this.getWebWindow().fin.__internal_.openerSuccessCBCalled()}catch(t){}return l.success?this:Promise.reject(l)}getAllFrames(){return this.wire.sendAction("get-all-frames",this.identity).then((({payload:t})=>t.data))}getBounds(){return this.wire.sendAction("get-window-bounds",this.identity).then((({payload:t})=>t.data))}center(){return this.wire.sendAction("center-window",this.identity).then((()=>{}))}blur(){return this.wire.sendAction("blur-window",this.identity).then((()=>{}))}bringToFront(){return this.wire.sendAction("bring-window-to-front",this.identity).then((()=>{}))}animate(t,e){return this.wire.sendAction("animate-window",{transitions:t,options:e,...this.identity}).then((()=>{}))}hide(){return this.wire.sendAction("hide-window",this.identity).then((()=>{}))}close(t=!1){return this.wire.sendAction("close-window",{force:t,...this.identity}).then((()=>{Object.setPrototypeOf(this,null)}))}focusedWebViewWasChanged(){return this.wire.sendAction("focused-webview-changed",this.identity).then((()=>{}))}getNativeId(){return this.wire.sendAction("get-window-native-id",this.identity).then((({payload:t})=>t.data))}async getCurrentViews(){const{payload:t}=await this.wire.sendAction("window-get-views",this.identity);return t.data.map((t=>new n.View(this.wire,t)))}disableFrame(){return console.warn("Function is deprecated; use disableUserMovement instead."),this.wire.sendAction("disable-window-frame",this.identity).then((()=>{}))}disableUserMovement(){return this.wire.sendAction("disable-window-frame",this.identity).then((()=>{}))}enableFrame(){return console.warn("Function is deprecated; use enableUserMovement instead."),this.wire.sendAction("enable-window-frame",this.identity).then((()=>{}))}enableUserMovement(){return this.wire.sendAction("enable-window-frame",this.identity).then((()=>{}))}flash(){return this.wire.sendAction("flash-window",this.identity).then((()=>{}))}stopFlashing(){return this.wire.sendAction("stop-flash-window",this.identity).then((()=>{}))}getInfo(){return this.wire.sendAction("get-window-info",this.identity).then((({payload:t})=>t.data))}async getLayout(t){this.wire.sendAction("window-get-layout",this.identity).catch((t=>{}));const e=await this.getOptions();if(!e.layout&&!e.layoutSnapshot)throw new Error("Window does not have a Layout");return this.fin.Platform.Layout.wrap(t??this.identity)}getOptions(){return this.wire.sendAction("get-window-options",this.identity).then((({payload:t})=>t.data))}getParentApplication(){return this.wire.sendAction("window-get-parent-application",this.identity).catch((t=>{})),Promise.resolve(new t.Application(this.wire,this.identity))}getParentWindow(){return this.wire.sendAction("window-get-parent-window",this.identity).catch((t=>{})),Promise.resolve(new t.Application(this.wire,this.identity)).then((t=>t.getWindow()))}async getSnapshot(t){const e={area:t,...this.identity};return console.warn("Window.getSnapshot has been deprecated, please use Window.capturePage"),(await this.wire.sendAction("get-window-snapshot",e)).payload.data}getState(){return this.wire.sendAction("get-window-state",this.identity).then((({payload:t})=>t.data))}getWebWindow(){return this.wire.sendAction("window-get-web-window",this.identity).catch((t=>{})),this.wire.environment.getWebWindow(this.identity)}isMainWindow(){return this.wire.sendAction("window-is-main-window",this.identity).catch((t=>{})),this.me.uuid===this.me.name}isShowing(){return this.wire.sendAction("is-window-showing",this.identity).then((({payload:t})=>t.data))}maximize(){return this.wire.sendAction("maximize-window",this.identity).then((()=>{}))}minimize(){return this.wire.sendAction("minimize-window",this.identity).then((()=>{}))}moveBy(t,e,n){return this.wire.sendAction("move-window-by",{deltaLeft:t,deltaTop:e,positioningOptions:n,...this.identity}).then((()=>{}))}moveTo(t,e,n){return this.wire.sendAction("move-window",{left:t,top:e,positioningOptions:n,...this.identity}).then((()=>{}))}resizeBy(t,e,n,i){return this.wire.sendAction("resize-window-by",{deltaWidth:Math.floor(t),deltaHeight:Math.floor(e),anchor:n,positioningOptions:i,...this.identity}).then((()=>{}))}resizeTo(t,e,n,i){return this.wire.sendAction("resize-window",{width:Math.floor(t),height:Math.floor(e),anchor:n,positioningOptions:i,...this.identity}).then((()=>{}))}restore(){return this.wire.sendAction("restore-window",this.identity).then((()=>{}))}setAsForeground(){return this.wire.sendAction("set-foreground-window",this.identity).then((()=>{}))}setBounds(t,e){return this.wire.sendAction("set-window-bounds",{...t,...this.identity,positioningOptions:e}).then((()=>{}))}show(t=!1){return this.wire.sendAction("show-window",{force:t,...this.identity}).then((()=>{}))}showAt(t,e,n=!1){return this.wire.sendAction("show-at-window",{force:n,left:Math.floor(t),top:Math.floor(e),...this.identity}).then((()=>{}))}updateOptions(t){return this.wire.sendAction("update-window-options",{options:t,...this.identity}).then((()=>{}))}authenticate(t,e){return this.wire.sendAction("window-authenticate",{userName:t,password:e,...this.identity}).then((()=>{}))}async showPopupMenu(t){const{payload:e}=await this.wire.sendAction("show-popup-menu",{options:t,...this.identity});return e.data}async closePopupMenu(){return this.wire.sendAction("close-popup-menu",{...this.identity}).then((()=>{}))}async dispatchPopupResult(t){this.wire.sendAction("window-dispatch-popup-result",this.identity).catch((t=>{})),await this.wire.sendAction("dispatch-popup-result",{data:t,...this.identity})}async print(t={content:"self"}){switch(t.content){case void 0:case"self":return super.print(t);case"screenshot":return this.wire.sendAction("print-screenshot",this.identity).then((()=>{}));case"views":return this.wire.sendAction("print-views",{...this.identity,options:t}).then((()=>{}));default:return}}}return T._Window=o,T}function Mt(){return St||(St=1,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(function(){if(xt)return L;xt=1,Object.defineProperty(L,"__esModule",{value:!0}),L._WindowModule=void 0;const t=h,e=R,n=Pt();class i extends t.Base{async wrap(t){this.wire.sendAction("window-wrap").catch((t=>{}));const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n._Window(this.wire,t)}wrapSync(t){this.wire.sendAction("window-wrap-sync").catch((t=>{}));const i=(0,e.validateIdentity)(t);if(i)throw new Error(i);return new n._Window(this.wire,t)}create(t){return this.wire.sendAction("create-window").catch((t=>{})),new n._Window(this.wire,{uuid:this.me.uuid,name:t.name}).createWindow(t)}getCurrent(){if(this.wire.sendAction("get-current-window").catch((t=>{})),!this.wire.me.isWindow)throw new Error("You are not in a Window context");const{uuid:t,name:e}=this.wire.me;return this.wrap({uuid:t,name:e})}getCurrentSync(){if(this.wire.sendAction("get-current-window-sync").catch((t=>{})),!this.wire.me.isWindow)throw new Error("You are not in a Window context");const{uuid:t,name:e}=this.wire.me;return this.wrapSync({uuid:t,name:e})}}return L._WindowModule=i,L}(),t),n(Pt(),t)}(M)),M}Object.defineProperty(At,"__esModule",{value:!0}),At.promisifySubscription=void 0,At.promisifySubscription=async(t,e,n=()=>!0,i)=>{let r,o,s;const a=new Promise(((t,e)=>{r=t,o=e})),c=t=>{n(t)&&(clearTimeout(s),r(t))};return await t.on(e,c),i&&(s=setTimeout((()=>o(new Error("event timed out"))),i)),a.finally((()=>{t.removeListener(e,c).catch((()=>null))})),{getValue:()=>a}},Object.defineProperty(l,"__esModule",{value:!0}),l.System=void 0;const Lt=h,Rt=v,Ot=Mt(),Tt=r;class kt extends Lt.EmitterBase{constructor(t){super(t,"system")}sendExternalProcessRequest(t,e){return new Promise(((n,i)=>{const r="external-process-exited";let o,s,a,c;"function"==typeof e.listener&&(a=t=>{const n=t||{};s={topic:"exited",uuid:n.processUuid||"",exitCode:n.exitCode||0},o===t.processUuid&&(e.listener(s),c.removeListener(r,a))},this.wire.me.name||(this.wire.me.name=this.wire.me.uuid),c=new Ot._Window(this.wire,this.wire.me),c.on(r,a)),this.wire.sendAction(t,e).then((({payload:t})=>{o=t.data.uuid,n(t.data),s&&o===s.uuid&&(e.listener(s),c.removeListener(r,a))})).catch((t=>{c&&c.removeListener(r,a),i(t)}))}))}getVersion(){return this.wire.sendAction("get-version").then((({payload:t})=>t.data))}clearCache(t){return this.wire.sendAction("clear-cache",t).then((()=>{}))}deleteCacheOnExit(){return this.wire.sendAction("delete-cache-request").then((()=>{}))}exit(){return this.wire.sendAction("exit-desktop").then((()=>{}))}async fetchManifest(t){const{payload:{data:e}}=await this.wire.sendAction("fetch-manifest",{manifestUrl:t});return e}flushCookieStore(){return this.wire.sendAction("flush-cookie-store").then((()=>{}))}getAllWindows(){return this.wire.sendAction("get-all-windows").then((({payload:t})=>t.data))}getAllApplications(){return this.wire.sendAction("get-all-applications").then((({payload:t})=>t.data))}getCommandLineArguments(){return this.wire.sendAction("get-command-line-arguments").then((({payload:t})=>t.data))}async getCrashReporterState(){const{payload:{data:{diagnosticMode:t,isRunning:e}}}=await this.wire.sendAction("get-crash-reporter-state");return console.warn("diagnosticMode property is deprecated. It will be removed in a future version"),{diagnosticMode:t,diagnosticsMode:t,isRunning:e}}async startCrashReporter(t){const e=t,n={...e,diagnosticMode:e.diagnosticsMode||e.diagnosticMode},{payload:{data:{diagnosticMode:i,isRunning:r}}}=await this.wire.sendAction("start-crash-reporter",n);return{diagnosticMode:i,diagnosticsMode:i,isRunning:r}}getUniqueUserId(){return this.wire.sendAction("get-unique-user-id").then((({payload:t})=>t.data))}getEntityInfo(t,e){return this.wire.sendAction("get-entity-info",{uuid:t,name:e}).then((({payload:t})=>t.data))}getEnvironmentVariable(t){return this.wire.sendAction("get-environment-variable",{environmentVariables:t}).then((({payload:t})=>t.data))}getFocusedWindow(){return this.wire.sendAction("get-focused-window").then((({payload:t})=>t.data))}async isAppCertified(t){const{payload:{data:{certifiedInfo:e}}}=await this.wire.sendAction("is-app-certified",{manifestUrl:t});return e}getInstalledRuntimes(){return this.wire.sendAction("get-installed-runtimes").then((({payload:t})=>t.data.runtimes))}async getInstalledApps(){const{payload:{data:{installedApps:t}}}=await this.wire.sendAction("get-installed-apps");return t}getLog(t){return this.wire.sendAction("view-log",t).then((({payload:t})=>t.data))}getMachineId(){return this.wire.sendAction("get-machine-id").then((({payload:t})=>t.data))}getMinLogLevel(){return this.wire.sendAction("get-min-log-level").then((({payload:t})=>t.data))}getLogList(){return this.wire.sendAction("list-logs").then((({payload:t})=>t.data))}getMonitorInfo(){return this.wire.sendAction("get-monitor-info").then((({payload:t})=>t.data))}getMousePosition(){return this.wire.sendAction("get-mouse-position").then((({payload:t})=>t.data))}getProcessList(){return console.warn("System.getProcessList has been deprecated. Please consider using our new process APIs: Window.getProcessInfo, View.getProcessInfo, Application.getProcessInfo, System.getAllProcessInfo"),this.wire.sendAction("process-snapshot").then((({payload:t})=>t.data))}async getAllProcessInfo(){const{payload:{data:t}}=await this.wire.sendAction("get-all-process-info",this.identity);return t}getProxySettings(){return this.wire.sendAction("get-proxy-settings").then((({payload:t})=>t.data))}getRuntimeInfo(){return this.wire.sendAction("get-runtime-info").then((({payload:t})=>t.data))}getRvmInfo(){return this.wire.sendAction("get-rvm-info").then((({payload:t})=>t.data))}getHostSpecs(){return this.wire.sendAction("get-host-specs").then((({payload:t})=>t.data))}getOSInfo(){return this.wire.sendAction("get-os-info").then((({payload:t})=>t.data))}launchExternalProcess(t){return this.sendExternalProcessRequest("launch-external-process",t)}monitorExternalProcess(t){return this.sendExternalProcessRequest("monitor-external-process",t)}log(t,e){return this.wire.sendAction("write-to-log",{level:t,message:e}).then((()=>{}))}openUrlWithBrowser(t){return this.wire.sendAction("open-url-with-browser",{url:t}).then((()=>{}))}async registerCustomProtocol(t){if("object"!=typeof t)throw new Error("Must provide an object with a `protocolName` property having a string value.");await this.wire.sendAction("register-custom-protocol",t)}async unregisterCustomProtocol(t){await this.wire.sendAction("unregister-custom-protocol",{protocolName:t})}async getCustomProtocolState(t){return this.wire.sendAction("get-custom-protocol-state",{protocolName:t}).then((({payload:t})=>t.data))}releaseExternalProcess(t){return this.wire.sendAction("release-external-process",{uuid:t}).then((()=>{}))}showDeveloperTools(t){return this.wire.sendAction("show-developer-tools",t).then((()=>{}))}terminateExternalProcess(t){return this.wire.sendAction("terminate-external-process",t).then((()=>{}))}updateProxySettings(t){return this.wire.sendAction("update-proxy",t).then((()=>{}))}async downloadAsset(t,e){const n=()=>{};let i=n,r=n;const o=new Promise(((t,e)=>{i=t,r=e}));if("openfin"!==this.wire.environment.type)throw new Rt.NotSupportedError("downloadAsset only supported in an OpenFin Render process");const s=Rt.RuntimeError.getCallSite(),a=this.wire.environment.getNextMessageId().toString(),c=`asset-download-progress-${a}`,d=`asset-download-error-${a}`,l=`asset-download-complete-${a}`,h=t=>{const n={downloadedBytes:t.downloadedBytes,totalBytes:t.totalBytes};e(n)},u=()=>{this.removeListener(c,h)};await Promise.all([this.on(c,h),this.once(d,(t=>{u();const{reason:e,err:n}=t;r(new Rt.RuntimeError({reason:e,error:n},s))})),this.once(l,(()=>{u(),i()}))]);const p=Object.assign(t,{downloadId:a});return await this.wire.sendAction("download-asset",p).catch((t=>{throw u(),t})),o}downloadRuntime(t,e){const n=Rt.RuntimeError.getCallSite();return new Promise(((i,r)=>{if("openfin"!==this.wire.environment.type)return void r(new Rt.NotSupportedError("downloadRuntime only supported in an OpenFin Render process"));const o=this.wire.environment.getNextMessageId().toString(),s=`runtime-download-progress-${o}`,a=`runtime-download-error-${o}`,c=`runtime-download-complete-${o}`,d=t=>{const n={downloadedBytes:t.downloadedBytes,totalBytes:t.totalBytes};e(n)},l=()=>{this.removeListener(s,d)};this.on(s,d),this.once(a,(t=>{l();const{reason:e,err:i}=t;r(new Rt.RuntimeError({reason:e,error:i},n))})),this.once(c,(()=>{l(),i()}));const h=Object.assign(t,{downloadId:o});this.wire.sendAction("download-runtime",h).catch((t=>{l(),r(t)}))}))}downloadPreloadScripts(t){return this.wire.sendAction("download-preload-scripts",{scripts:t}).then((({payload:t})=>t.data))}getAllExternalApplications(){return this.wire.sendAction("get-all-external-applications").then((({payload:t})=>t.data))}getAppAssetInfo(t){return this.wire.sendAction("get-app-asset-info",t).then((({payload:t})=>t.data))}getCookies(t){const e=this.wire.environment.getUrl(),n=Object.assign(t,{url:e});return this.wire.sendAction("get-cookies",n).then((({payload:t})=>t.data))}setMinLogLevel(t){return this.wire.sendAction("set-min-log-level",{level:t}).then((()=>{}))}resolveUuid(t){return this.wire.sendAction("resolve-uuid",{entityKey:t}).then((({payload:t})=>t.data))}executeOnRemote(t,e){return e.requestingIdentity=t,this.wire.ferryAction(e)}readRegistryValue(t,e,n){return this.wire.sendAction("read-registry-value",{rootKey:t,subkey:e,value:n}).then((({payload:t})=>t.data))}registerExternalConnection(t){return this.wire.sendAction("register-external-connection",{uuid:t}).then((({payload:t})=>t.data))}async getServiceConfiguration(t){if("string"!=typeof t.name)throw new Error("Must provide an object with a `name` property having a string value");const{name:e}=t;return this.wire.sendAction("get-service-configuration",{name:e}).then((({payload:t})=>t.data))}async getSystemAppConfig(t){if("string"!=typeof t)throw new Error("Must provide a string value for name of system app");return this.wire.sendAction("get-system-app-configuration",{name:t}).then((({payload:t})=>t.data))}async registerShutdownHandler(t){this.wire.sendAction("system-register-shutdown-handler").catch((t=>{}));const{uuid:e,name:n}=this.wire.me;this.on("system-shutdown",(i=>{t({proceed:()=>{this.wire.environment.raiseEvent("application/system-shutdown-handled",{uuid:e,name:n,topic:"application"})}})}))}runRvmHealthCheck(){return this.wire.sendAction("run-rvm-health-check").then((({payload:t})=>t.data))}async launchManifest(t,e={}){const{subscribe:n,...i}=e,r=i;if(n){const t=new Tt.EventEmitter;n(t);const e="app-version-progress",i="runtime-status",o="app-version-complete",s="app-version-error",a=this.wire.environment.getNextMessageId().toString();r.appVersionId=a;const c=[o,e,i,s],d=t=>{const{appVersionId:e,topic:n,type:i,...r}=t;return{...r,type:c.find((t=>i.includes(t)))}},l=e=>{const n=d(e);t.emit(n.type,n)},h=()=>{this.removeListener(`${e}.${a}`,l),this.removeListener(`${i}.${a}`,l),this.removeListener(`${o}.${a}`,l),this.removeListener(`${s}.${a}`,l),this.removeListener(`${o}.${a}`,h),this.removeListener(`${s}.${a}`,h)};await Promise.all([this.on(`${e}.${a}`,l),this.on(`${i}.${a}`,l),this.once(`${o}.${a}`,l),this.once(`${s}.${a}`,l),this.once(`${o}.${a}`,h),this.once(`${s}.${a}`,h)])}return(await this.wire.sendAction("launch-manifest",{manifestUrl:t,opts:r})).payload.data.manifest}async queryPermissionForCurrentContext(t){const e={uuid:this.wire.me.uuid,name:this.wire.me.name};return(await this.wire.sendAction("query-permission-for-current-context",{apiName:t,identity:e})).payload.data}async enableNativeWindowIntegrationProvider(t){const{payload:e}=await this.wire.sendAction("enable-native-window-integration-provider",{permissions:t});return e.data}async registerUsage({data:t,type:e}){await this.wire.sendAction("register-usage",{data:t,type:e})}async getPrinters(){const{payload:t}=await this.wire.sendAction("system-get-printers");return t.data}async updateProcessLoggingOptions(t){await this.wire.sendAction("system-update-process-logging-options",{options:t})}async getDomainSettings(){const{payload:{data:t}}=await this.wire.sendAction("get-domain-settings",this.identity);return t}async setDomainSettings(t){await this.wire.sendAction("set-domain-settings",{domainSettings:t,...this.identity})}}l.System=kt;var zt={},Bt={};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.RefCounter=void 0,Bt.RefCounter=class{constructor(){this.topicRefMap=new Map}incRefCount(t){const e=this.topicRefMap.get(t);let n;if(e){const i=e+1;n=i,this.topicRefMap.set(t,i)}else this.topicRefMap.set(t,1),n=1;return n}decRefCount(t){const e=this.topicRefMap.get(t);let n;if(e){const i=e-1;this.topicRefMap.set(t,i),n=i}else n=-1;return n}actOnFirst(t,e,n){return 1===this.incRefCount(t)?e():n()}actOnLast(t,e,n){return 0===this.decRefCount(t)?e():n()}};var Ft={},Dt={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.ChannelBase=Ut.ProtectedItems=void 0;const jt=t=>async(e,n,i)=>{const r=await t(e,n,i);return void 0===r?n:r};Ut.ProtectedItems=class{constructor(t,e){this.providerIdentity=t,this.close=e}};class Wt{static defaultAction(t){throw new Error(`No action registered at target for ${t}`)}constructor(){this.subscriptions=new Map}async processAction(t,e,n){try{const i=this.subscriptions.has(t)?this.subscriptions.get(t):(e,n)=>(this.defaultAction??Wt.defaultAction)(t,e,n),r=this.preAction?await this.preAction(t,e,n):e,o=await i(r,n);return this.postAction?await this.postAction(t,o,n):o}catch(e){if(this.errorMiddleware)return this.errorMiddleware(t,e,n);throw e}}beforeAction(t){if(this.preAction)throw new Error("Already registered beforeAction middleware");this.preAction=jt(t)}onError(t){if(this.errorMiddleware)throw new Error("Already registered error middleware");this.errorMiddleware=t}afterAction(t){if(this.postAction)throw new Error("Already registered afterAction middleware");this.postAction=jt(t)}remove(t){this.subscriptions.delete(t)}setDefaultAction(t){if(this.defaultAction)throw new Error("default action can only be set once");this.defaultAction=t}register(t,e){if(this.subscriptions.has(t))throw new Error(`Subscription already registered for action: ${t}. Unsubscribe before adding new subscription`);return this.subscriptions.set(t,e),!0}}Ut.ChannelBase=Wt;var $t,Ht,Nt,Gt=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},Vt=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.ChannelClient=void 0;const qt=Ut,Zt=new Map;class Yt extends qt.ChannelBase{static closeChannelByEndpointId(t){const e=Zt.get(t);e&&Gt(e,Nt,"f").call(e)}static handleProviderDisconnect(t){for(const e of Zt.values())e.providerIdentity.channelId===t.channelId&&(e.disconnectListener(t),Gt(e,Nt,"f").call(e))}constructor(t,e,n){super(),$t.set(this,void 0),Ht.set(this,void 0),this.processAction=(t,e,n)=>super.processAction(t,e,n),Nt.set(this,(()=>{Zt.delete(this.endpointId),Gt(this,Ht,"f").close()})),Vt(this,$t,new qt.ProtectedItems(t,e),"f"),this.disconnectListener=()=>{},this.endpointId=t.endpointId,Vt(this,Ht,n,"f"),Zt.set(this.endpointId,this),n.receive(this.processAction)}get providerIdentity(){return Gt(this,$t,"f").providerIdentity}async dispatch(t,e){if(Gt(this,Ht,"f").isEndpointConnected(this.providerIdentity.channelId))return Gt(this,Ht,"f").send(this.providerIdentity.channelId,t,e);throw new Error("The client you are trying to dispatch from is disconnected from the target provider.")}onDisconnection(t){this.disconnectListener=e=>{try{t(e)}catch(t){throw new Error(`Error while calling the onDisconnection callback: ${t.message}`)}finally{this.disconnectListener=()=>{}}}}async disconnect(){await this.sendDisconnectAction(),Gt(this,Nt,"f").call(this)}async sendDisconnectAction(){const t=Gt(this,$t,"f");await t.close()}static async wireClose(t,e,n){const{channelName:i,uuid:r,name:o}=e;await t.sendAction("disconnect-from-channel",{channelName:i,uuid:r,name:o,endpointId:n})}}Dt.ChannelClient=Yt,$t=new WeakMap,Ht=new WeakMap,Nt=new WeakMap;var Jt={},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.exhaustiveCheck=void 0,Kt.exhaustiveCheck=function(t,e){throw new Error(`Unsupported value: ${t}${e?`\n Supported values are: ${e.join("")}`:""}`)};var Xt,Qt,te,ee={},ne=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},ie=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(ee,"__esModule",{value:!0}),ee.ClassicInfo=ee.ClassicStrategy=void 0,ee.ClassicStrategy=class{constructor(t,e,n,i){this.messageReceiver=e,this.endpointId=n,this.providerIdentity=i,Xt.set(this,void 0),Qt.set(this,new Map),te.set(this,new Map),this.send=async(t,e,n)=>{const i=ie(this,Qt,"f").get(t);if(!i)throw new Error(`Could not locate routing info for endpoint ${t}`);const r={...i};r.isLocalEndpointId&&delete r.endpointId,delete r.isLocalEndpointId;const o=ie(this,Xt,"f").sendAction("send-channel-message",{...r,providerIdentity:this.providerIdentity,action:e,payload:n});return ie(this,te,"f").get(t)?.add(o),(await o.catch((t=>{throw new Error(t.message)})).finally((()=>{ie(this,te,"f").get(t)?.delete(o)}))).payload.data.result},this.close=async()=>{this.messageReceiver.removeEndpoint(this.providerIdentity.channelId,this.endpointId),[...ie(this,Qt,"f").keys()].forEach((t=>this.closeEndpoint(t))),ne(this,Qt,new Map,"f")},ne(this,Xt,t,"f")}onEndpointDisconnect(t,e){}receive(t){this.messageReceiver.addEndpoint(t,this.providerIdentity.channelId,this.endpointId)}async closeEndpoint(t){const e=ie(this,Qt,"f").get(t);ie(this,Qt,"f").delete(t);const n=ie(this,te,"f").get(t);n?.forEach((n=>{const i=`Channel connection with identity uuid: ${e?.uuid} / name: ${e?.name} / endpointId: ${t} no longer connected.`;n.cancel(new Error(i))}))}isEndpointConnected(t){return ie(this,Qt,"f").has(t)}addEndpoint(t,e){ie(this,Qt,"f").set(t,e.endpointIdentity),ie(this,te,"f").set(t,new Set)}isValidEndpointPayload(t){return"string"==typeof t?.endpointIdentity?.endpointId||"string"==typeof t?.endpointIdentity?.channelId}},Xt=new WeakMap,Qt=new WeakMap,te=new WeakMap,ee.ClassicInfo={version:5,minimumVersion:0,type:"classic"};var re={},oe={},se={};Object.defineProperty(se,"__esModule",{value:!0}),se.errorToPOJO=void 0,se.errorToPOJO=function(t){return{stack:t.stack,name:t.name,message:t.message,toString:()=>t.stack||t.toString()}};var ae,ce,de=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},le=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(oe,"__esModule",{value:!0}),oe.RTCEndpoint=void 0;const he=se;oe.RTCEndpoint=class{static isValidEndpointPayload(t){const e=t=>"object"==typeof t&&null!==t;return e(t)&&e(t.endpointIdentity)&&e(t.rtc)&&"string"==typeof t.endpointIdentity.endpointId}constructor({rtc:t,endpointIdentity:e}){this.responseMap=new Map,ae.set(this,null),ce.set(this,void 0),this.connectionStateChangeHandler=t=>{"connected"!==this.rtc.rtcClient.connectionState&&(this.rtc.rtcClient.removeEventListener("connectionstatechange",this.connectionStateChangeHandler),this.close(),de(this,ce,"f")&&de(this,ce,"f").call(this))},this.send=async(t,e)=>{const n=`message-${Math.random()}`,i=new Promise(((t,e)=>{this.responseMap.set(n,{resolve:t,reject:e})}));return this.rtc.channels.request.send(JSON.stringify({action:t,payload:e,messageId:n})),i},this.close=()=>{this.responseMap.forEach((t=>t.reject("Connection has closed."))),this.responseMap=new Map,this.rtc.channels.request.close(),this.rtc.channels.response.close(),this.rtc.rtcClient.close()},this.rtc=t,this.endpointIdentity=e,this.rtc.channels.response.addEventListener("message",(t=>{let{data:e}=t;t.data instanceof ArrayBuffer&&(e=(new TextDecoder).decode(t.data));const{messageId:n,payload:i,success:r,error:o}=JSON.parse(e),{resolve:s,reject:a}=this.responseMap.get(n)??{};s&&a?(this.responseMap.delete(n),r?s(i):a(o)):(console.log("Could not find id in responseMap."),console.log(t))})),this.rtc.channels.request.addEventListener("message",(async t=>{let{data:n}=t;t.data instanceof ArrayBuffer&&(n=(new TextDecoder).decode(t.data));const{messageId:i,action:r,payload:o}=JSON.parse(n);if(de(this,ae,"f"))try{const t=await de(this,ae,"f").call(this,r,o,e);this.rtc.channels.response.send(JSON.stringify({messageId:i,payload:t,success:!0}))}catch(t){"open"===this.rtc.channels.response.readyState&&this.rtc.channels.response.send(JSON.stringify({messageId:i,error:(0,he.errorToPOJO)(t),success:!1}))}else"open"===this.rtc.channels.response.readyState&&this.rtc.channels.response.send(JSON.stringify({messageId:i,success:!1,error:"Connection not ready."}))})),this.rtc.rtcClient.addEventListener("connectionstatechange",this.connectionStateChangeHandler),Object.values(this.rtc.channels).forEach((t=>{t.onclose=t=>{[...this.responseMap.values()].forEach((t=>t.reject(new Error("RTCDataChannel closed unexpectedly, this is most commonly caused by message size. Note: RTC Channels have a message size limit of ~255kB.")))),this.close(),de(this,ce,"f")&&de(this,ce,"f").call(this)}}))}onDisconnect(t){if(de(this,ce,"f"))throw new Error("RTCEndpoint disconnectListener cannot be set twice.");le(this,ce,t,"f")}receive(t){if(de(this,ae,"f"))throw new Error("You have already set a listener for this RTC Endpoint.");le(this,ae,t,"f")}get connected(){return"connected"===this.rtc.rtcClient.connectionState}},ae=new WeakMap,ce=new WeakMap;var ue,pe,fe,me={},ge=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},we=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(me,"__esModule",{value:!0}),me.EndpointStrategy=void 0,me.EndpointStrategy=class{constructor(t,e,n){this.EndpointType=t,this.StrategyName=n,ue.set(this,null),pe.set(this,new Map),fe.set(this,!0),this.send=async(t,e,n)=>this.getEndpointById(t).send(e,n),this.close=async()=>{ge(this,fe,"f")&&(ge(this,pe,"f").forEach((t=>t.close())),we(this,pe,new Map,"f")),we(this,fe,!1,"f")},this.isValidEndpointPayload=e}onEndpointDisconnect(t,e){this.getEndpointById(t).onDisconnect(e)}receive(t){if(ge(this,ue,"f"))throw new Error(`You have already set a listener for this ${this.StrategyName} Strategy`);we(this,ue,t,"f"),ge(this,pe,"f").forEach((t=>t.receive(ge(this,ue,"f"))))}getEndpointById(t){const e=ge(this,pe,"f").get(t);if(!e)throw new Error(`Client with endpoint id ${t} is not connected`);return e}get connected(){return ge(this,fe,"f")}isEndpointConnected(t){return ge(this,pe,"f").has(t)}addEndpoint(t,e){if(!ge(this,fe,"f"))return void console.warn(`Adding endpoint to disconnected ${this.StrategyName} Strategy`);const n=new this.EndpointType(e);ge(this,ue,"f")&&n.receive(ge(this,ue,"f")),ge(this,pe,"f").set(t,n)}async closeEndpoint(t){ge(this,pe,"f").delete(t)}},ue=new WeakMap,pe=new WeakMap,fe=new WeakMap,Object.defineProperty(re,"__esModule",{value:!0}),re.RTCInfo=re.RTCStrategy=void 0;const ye=oe,ve=me;class _e extends ve.EndpointStrategy{constructor(){super(ye.RTCEndpoint,ye.RTCEndpoint.isValidEndpointPayload,"RTC")}}re.RTCStrategy=_e,re.RTCInfo={version:2,minimumVersion:0,type:"rtc"};var Ce={};Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.RTCICEManager=void 0;const be=h;class Ie extends be.EmitterBase{constructor(t){super(t,"channel"),this.ensureChannelOpened=t=>new Promise(((e,n)=>{if("open"===t.readyState)e();else if("connecting"===t.readyState){const n=()=>{t.removeEventListener("open",n),e()};t.addEventListener("open",n)}else n(new Error("This Channel has already closed"))}))}static createDataChannelPromise(t,e){let n;const i=new Promise((t=>{n=t})),r=i=>{const o=()=>{i.channel.removeEventListener("open",o),n(i.channel)};i.channel.label===t&&(i.channel.addEventListener("open",o),e.removeEventListener("datachannel",r))};return e.addEventListener("datachannel",r),i}async listenForProviderIce(t,e){await this.on(this.createProviderEventName(t),e,{timestamp:Date.now()})}async raiseProviderIce(t,e){await this.wire.environment.raiseEvent(this.createRouteString(this.createProviderEventName(t)),e)}async listenForClientIce(t,e){await this.on(this.createClientEventName(t),e,{timestamp:Date.now()})}async raiseClientIce(t,e){await this.wire.environment.raiseEvent(this.createRouteString(this.createClientEventName(t)),e)}cleanupIceListeners(t){this.removeAllListeners(this.createClientEventName(t)),this.removeAllListeners(this.createProviderEventName(t))}createClientEventName(t){return`ice-client-${t}`}createProviderEventName(t){return`ice-provider-${t}`}createRouteString(t){return`channel/${t}`}createRtcPeer(){return this.wire.environment.getRtcPeer()}async startClientOffer(){const t=Math.random().toString(),e=this.createRtcPeer();e.addEventListener("icecandidate",(async e=>{e.candidate&&await this.raiseClientIce(t,{candidate:e.candidate?.toJSON()})})),await this.listenForProviderIce(t,(async t=>{await e.addIceCandidate(t.candidate)}));const n={request:e.createDataChannel("request"),response:e.createDataChannel("response")},i=await e.createOffer();await e.setLocalDescription(i);const r=Promise.all([n.request,n.response].map(this.ensureChannelOpened)).then((()=>{}));return{rtcClient:e,channels:n,offer:i,rtcConnectionId:t,channelsOpened:r}}async finishClientOffer(t,e,n){return await t.setRemoteDescription(e),await n,!0}async createProviderAnswer(t,e){const n=this.createRtcPeer(),i=Ie.createDataChannelPromise("request",n),r=Ie.createDataChannelPromise("response",n);n.addEventListener("icecandidate",(async e=>{e.candidate&&await this.raiseProviderIce(t,{candidate:e.candidate?.toJSON()})})),await this.listenForClientIce(t,(async t=>{await n.addIceCandidate(t.candidate)})),await n.setRemoteDescription(e);const o=await n.createAnswer();await n.setLocalDescription(o);const s=Promise.all([i,r]).then((([e,n])=>(this.cleanupIceListeners(t),{request:e,response:n})));return{rtcClient:n,answer:o,channels:s}}}Ce.RTCICEManager=Ie;var Ee={},xe={};function Se(t){return[...t.split(".").reverse().entries()].reduce(((t,[e,n])=>t+ +n*1e4**e),0)}function Ae(t,e){return Se(t)>=Se(e)}function Pe(t){return t.split("/")[0]}Object.defineProperty(xe,"__esModule",{value:!0}),xe.runtimeUuidMeetsMinimumRuntimeVersion=xe.parseRuntimeUuid=xe.meetsMinimumRuntimeVersion=void 0,xe.meetsMinimumRuntimeVersion=Ae,xe.parseRuntimeUuid=Pe,xe.runtimeUuidMeetsMinimumRuntimeVersion=function(t,e){return Ae(Pe(t),e)};var Me,Le,Re,Oe,Te,ke=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},ze=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.ChannelProvider=void 0;const Be=Ut,Fe=xe;class De extends Be.ChannelBase{get connections(){return[...ke(this,Me,"f")]}static handleClientDisconnection(t,e){const n=t.connections.find((t=>t.endpointId===e.endpointId));n?ke(t,Oe,"f").call(t,n):t.connections.filter((t=>t.uuid===e.uuid&&t.name===e.name)).forEach(ke(t,Oe,"f")),t.disconnectListener(e)}static setProviderRemoval(t,e){De.removalMap.set(t,e)}constructor(t,e,n){super(),Me.set(this,void 0),Le.set(this,void 0),Re.set(this,void 0),Oe.set(this,(t=>{const e=this.connections.filter((e=>e.endpointId!==t.endpointId));ke(this,Re,"f").closeEndpoint(t.endpointId),ze(this,Me,e,"f")})),this.processAction=async(t,e,n)=>(De.clientIsMultiRuntime(n)&&!(0,Fe.runtimeUuidMeetsMinimumRuntimeVersion)(n.runtimeUuid,"18.87.56.0")?this.handleMultiRuntimeLegacyClient(n):this.checkForClientConnection(n),super.processAction(t,e,n)),Te.set(this,(()=>{ke(this,Re,"f").close();const t=De.removalMap.get(this);t&&t()})),ze(this,Le,new Be.ProtectedItems(t,e),"f"),this.connectListener=()=>{},this.disconnectListener=()=>{},ze(this,Me,[],"f"),ze(this,Re,n,"f"),n.receive(this.processAction)}dispatch(t,e,n){const i=t.endpointId??this.getEndpointIdForOpenFinId(t,e);return i&&ke(this,Re,"f").isEndpointConnected(i)?ke(this,Re,"f").send(i,e,n):Promise.reject(new Error(`Client connection with identity uuid: ${t.uuid} / name: ${t.name} / endpointId: ${i} no longer connected.`))}async processConnection(t,e){return ke(this,Me,"f").push(t),this.connectListener(t,e)}publish(t,e){return this.connections.map((n=>ke(this,Re,"f").send(n.endpointId,t,e)))}onConnection(t){this.connectListener=t}onDisconnection(t){this.disconnectListener=t}async destroy(){const t=ke(this,Le,"f");t.providerIdentity,ze(this,Me,[],"f"),await t.close(),ke(this,Te,"f").call(this)}async getAllClientInfo(){return this.connections.map((t=>{const{uuid:e,name:n,endpointId:i,entityType:r,connectionUrl:o}=t;return{uuid:e,name:n,endpointId:i,entityType:r,connectionUrl:o}}))}checkForClientConnection(t){if(!this.isClientConnected(t))throw new Error(`This action was sent from a client that is not connected to the provider.\n                    Client Identity: {uuid: ${t.uuid}, name: ${t.name}, endpointId: ${t.endpointId}}`)}isClientConnected(t){return De.clientIdentityIncludesEndpointId(t)?this.connections.some((e=>e.endpointId===t.endpointId&&e.uuid===t.uuid&&e.name===t.name)):this.isLegacyClientConnected(t)}isLegacyClientConnected(t){return this.connections.some((e=>e.uuid===t.uuid&&e.name===t.name))}handleMultiRuntimeLegacyClient(t){if(!this.isLegacyClientConnected(t))throw new Error(`This action was sent from a client that is not connected to the provider. Client Identity:\n                    {uuid: ${t.uuid}, name: ${t.name}, endpointId: ${t.endpointId}}`)}getEndpointIdForOpenFinId(t,e){const n=this.connections.filter((e=>e.name===t.name&&e.uuid===t.uuid));if(n.length>=2){const n=ke(this,Le,"f"),{uuid:i,name:r}=t,o=n?.providerIdentity.uuid,s=n?.providerIdentity.name;console.warn(`WARNING: Dispatch call may have unintended results. The "to" argument of your dispatch call is missing the\n                "endpointId" parameter. The identity you are dispatching to ({uuid: ${i}, name: ${r}})\n                has multiple channelClients for this channel. Your dispatched action: (${e}) from the provider:\n                ({uuid: ${o}, name: ${s}}) will only be processed by the most recently-created client.`)}return n.pop()?.endpointId}static clientIdentityIncludesEndpointId(t){return void 0!==t.endpointId}static clientIsMultiRuntime(t){return void 0!==t.runtimeUuid}static async wireClose(t,e){await t.sendAction("destroy-channel",{channelName:e})}}Ee.ChannelProvider=De,Me=new WeakMap,Le=new WeakMap,Re=new WeakMap,Oe=new WeakMap,Te=new WeakMap,De.removalMap=new WeakMap;var Ue={};Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.MessageReceiver=void 0;const je=Dt,We=h;class $e extends We.Base{constructor(t){super(t),this.onmessage=t=>"process-channel-message"===t.action&&(this.processChannelMessage(t),!0),this.endpointMap=new Map,this.latestEndpointIdByChannelId=new Map,t.registerMessageHandler(this.onmessage.bind(this))}async processChannelMessage(t){const{senderIdentity:e,providerIdentity:n,action:i,ackToSender:r,payload:o,intendedTargetIdentity:s}=t.payload,a=s.channelId??s.endpointId??this.latestEndpointIdByChannelId.get(n.channelId),c=this.endpointMap.get(a);if(!c)return r.payload.success=!1,r.payload.reason=`Client connection with identity uuid: ${this.wire.me.uuid} / name: ${this.wire.me.name} / endpointId: ${a} no longer connected.`,this.wire.sendRaw(r);try{const t=await c(i,o,e);return r.payload.payload=r.payload.payload||{},r.payload.payload.result=t,this.wire.sendRaw(r)}catch(t){return r.payload.success=!1,r.payload.reason=t.message,this.wire.sendRaw(r)}}addEndpoint(t,e,n){this.endpointMap.set(n,t),e!==n&&this.latestEndpointIdByChannelId.set(e,n)}removeEndpoint(t,e){this.endpointMap.delete(e),this.latestEndpointIdByChannelId.get(t)===e&&this.latestEndpointIdByChannelId.delete(t)}checkForPreviousClientConnection(t){const e=this.latestEndpointIdByChannelId.get(t);e&&(je.ChannelClient.closeChannelByEndpointId(e),console.warn("You have created a second connection to an older provider. First connection has been removed from the clientMap"),console.warn("If the provider calls publish(), you may receive multiple messages."))}}Ue.MessageReceiver=$e;var He={};Object.defineProperty(He,"__esModule",{value:!0}),He.ProtocolManager=void 0,He.ProtocolManager=class{constructor(t){this.ProtocolsInPreferenceOrder=t,this.DefaultClientProtocols=["classic"],this.DefaultProviderProtocols=["classic"],this.getClientProtocols=t=>{const e=t?this.ProtocolsInPreferenceOrder.filter((e=>t.includes(e))):this.DefaultClientProtocols;if(!e.length)throw new Error(`No valid protocols were passed in. Accepted values are: ${this.ProtocolsInPreferenceOrder.join(", ")}.`);return e},this.getProviderProtocols=t=>{const e=t?this.ProtocolsInPreferenceOrder.filter((e=>t.includes(e))):this.DefaultProviderProtocols;if(!e.length)throw new Error(`No valid protocols were passed in. Accepted values are: ${this.ProtocolsInPreferenceOrder.join(", ")}.`);return e},this.getCompatibleProtocols=(t,e)=>e.supportedProtocols.filter((e=>t.some((t=>t.type===e.type&&e.version>=t.minimumVersion&&t.version>=(e.minimumVersion??0))))).slice(0,e.maxProtocols)}};var Ne={};Object.defineProperty(Ne,"__esModule",{value:!0});class Ge{static combine(t,e){return new Ge(t,e)}constructor(t,e){this.primary=t,this.secondary=e}onEndpointDisconnect(t,e){this.primary.onEndpointDisconnect(t,(()=>{this.secondary.isEndpointConnected(t)||e()})),this.secondary.onEndpointDisconnect(t,(()=>{this.primary.isEndpointConnected(t)||e()}))}isValidEndpointPayload(t){return this.primary.isValidEndpointPayload(t)||this.secondary.isValidEndpointPayload(t)}async closeEndpoint(t){await this.primary.closeEndpoint(t),await this.secondary.closeEndpoint(t)}isEndpointConnected(t){return this.primary.isEndpointConnected(t)||this.secondary.isEndpointConnected(t)}async addEndpoint(t,e){this.primary.isValidEndpointPayload(e)&&await this.primary.addEndpoint(t,e),this.secondary.isValidEndpointPayload(e)&&await this.secondary.addEndpoint(t,e)}receive(t){this.primary.receive(t),this.secondary.receive(t)}send(t,e,n){return this.primary.isEndpointConnected(t)?this.primary.send(t,e,n):this.secondary.send(t,e,n)}async close(){await Promise.all([this.primary.close(),this.secondary.close()])}}Ne.default=Ge;var Ve,qe,Ze=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},Ye=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ConnectionManager=void 0;const Je=Kt,Ke=h,Xe=ee,Qe=re,tn=Ce,en=Ee,nn=Ue,rn=He,on=Ne;class sn extends Ke.Base{static getProtocolOptionsFromStrings(t){return t.map((t=>{switch(t){case"rtc":return Qe.RTCInfo;case"classic":return Xe.ClassicInfo;default:return(0,Je.exhaustiveCheck)(t,["rtc","classic"])}}))}constructor(t){super(t),Ve.set(this,void 0),qe.set(this,void 0),this.removeChannelFromProviderMap=t=>{this.providerMap.delete(t)},this.onmessage=t=>"process-channel-connection"===t.action&&(this.processChannelConnection(t),!0),this.providerMap=new Map,this.protocolManager=new rn.ProtocolManager("node"===this.wire.environment.type?["classic"]:["rtc","classic"]),Ze(this,Ve,new nn.MessageReceiver(t),"f"),Ze(this,qe,new tn.RTCICEManager(t),"f"),t.registerMessageHandler(this.onmessage.bind(this))}createProvider(t,e){const n=Object.assign(this.wire.environment.getDefaultChannelOptions().create,t||{}),i=this.protocolManager.getProviderProtocols(n?.protocols),r=i.map((t=>{switch(t){case"rtc":return new Qe.RTCStrategy;case"classic":return new Xe.ClassicStrategy(this.wire,Ye(this,Ve,"f"),e.channelId,e);default:return(0,Je.exhaustiveCheck)(t,["rtc","classic"])}}));let o;if(2===r.length){const[t,e]=r;o=on.default.combine(t,e)}else{if(1!==r.length)throw new Error("failed to combine strategies");[o]=r}const s=new en.ChannelProvider(e,(()=>en.ChannelProvider.wireClose(this.wire,e.channelName)),o),a=e.channelId;return this.providerMap.set(a,{provider:s,strategy:o,supportedProtocols:sn.getProtocolOptionsFromStrings(i)}),en.ChannelProvider.setProviderRemoval(s,this.removeChannelFromProviderMap.bind(this)),s}async createClientOffer(t){const e=this.protocolManager.getClientProtocols(t?.protocols);let n;return{offer:{supportedProtocols:await Promise.all(e.map((async t=>{switch(t){case"rtc":{const{rtcClient:t,channels:e,offer:i,rtcConnectionId:r,channelsOpened:o}=await Ye(this,qe,"f").startClientOffer();return n={rtcClient:t,channels:e,channelsOpened:o},{type:"rtc",version:Qe.RTCInfo.version,payload:{offer:i,rtcConnectionId:r}}}case"classic":return{type:"classic",version:Xe.ClassicInfo.version};default:return(0,Je.exhaustiveCheck)(t,["rtc","classic"])}}))),maxProtocols:2},rtc:n}}async createClientStrategy(t,e){e.endpointId||(e.endpointId=this.wire.environment.getNextMessageId(),Ye(this,Ve,"f").checkForPreviousClientConnection(e.channelId));const n=e.answer??{supportedProtocols:[{type:"classic",version:1}]},i=(await Promise.all(n.supportedProtocols.map((async n=>"rtc"===n.type&&t?(await Ye(this,qe,"f").finishClientOffer(t.rtcClient,n.payload.answer,t.channelsOpened),new Qe.RTCStrategy):"classic"===n.type?new Xe.ClassicStrategy(this.wire,Ye(this,Ve,"f"),e.endpointId,e):null)))).filter((t=>null!==t));let r;if(t&&!i.some((t=>t instanceof Qe.RTCStrategy))&&t&&t.rtcClient.close(),i.length>=2)r=on.default.combine(i[0],i[1]);else{if(!i.length)throw new Error("No compatible protocols");[r]=i}const o={endpointIdentity:e,rtc:t};return r.addEndpoint(e.channelId,o),r}async processChannelConnection(t){const{clientIdentity:e,providerIdentity:n,ackToSender:i,payload:r,offer:o}=t.payload;e.endpointId?e.isLocalEndpointId=!1:(e.endpointId=this.wire.environment.getNextMessageId(),e.isLocalEndpointId=!0);const s=n.channelId,a=this.providerMap.get(s);if(!a)return i.payload.success=!1,i.payload.reason=`Channel "${n.channelName}" has been destroyed.`,this.wire.sendRaw(i);const{provider:c,strategy:d,supportedProtocols:l}=a;try{if(!(c instanceof en.ChannelProvider))throw Error("Cannot connect to a channel client");const t=o??{supportedProtocols:[{type:"classic",version:1}],maxProtocols:1},n=this.protocolManager.getCompatibleProtocols(l,t);if(!n.length)throw new Error("This provider does not support any of the offered protocols.");const s=await c.processConnection(e,r);i.payload.payload=i.payload.payload||{};let a={supportedProtocols:[],endpointPayloadPromise:Promise.resolve({endpointIdentity:e})};return a=await n.reduce((async(t,e)=>{const n=await t;if("rtc"===e.type){const{answer:t,rtcClient:i,channels:r}=await Ye(this,qe,"f").createProviderAnswer(e.payload.rtcConnectionId,e.payload.offer);n.supportedProtocols.push({type:"rtc",version:Qe.RTCInfo.version,payload:{answer:t}}),n.endpointPayloadPromise=n.endpointPayloadPromise.then((t=>r.then((e=>({...t,rtc:{rtcClient:i,channels:e}})))))}else n.supportedProtocols.push({type:"classic",version:Xe.ClassicInfo.version});return n}),Promise.resolve(a)),a.endpointPayloadPromise.then((t=>d.addEndpoint(e.endpointId,t))),i.payload.payload.result=s,i.payload.payload.answer=a,this.wire.sendRaw(i)}catch(t){return i.payload.success=!1,i.payload.reason=t.message,this.wire.sendRaw(i)}}}Jt.ConnectionManager=sn,Ve=new WeakMap,qe=new WeakMap;var an,cn,dn,ln=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},hn=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.Channel=void 0;const un=r,pn=W,fn=h,mn=Dt,gn=Jt,wn=Ee;function yn(t){const e=Math.floor(t/10),n=Math.min(3e4,500*2**e);return new Promise((t=>{setTimeout((()=>{t(!1)}),n)}))}class vn extends fn.EmitterBase{constructor(t){super(t,"channel"),an.set(this,void 0),cn.set(this,new un.EventEmitter),dn.set(this,new pn.AsyncRetryableLazy((async()=>{await Promise.all([this.on("disconnected",(t=>{mn.ChannelClient.handleProviderDisconnect(t)})),this.on("connected",((...t)=>{hn(this,cn,"f").emit("connected",...t)}))]).catch((()=>new Error("error setting up channel connection listeners")))}))),ln(this,an,new gn.ConnectionManager(t),"f")}async getAllChannels(){return this.wire.sendAction("get-all-channels").then((({payload:t})=>t.data))}async onChannelConnect(t){await this.on("connected",t)}async onChannelDisconnect(t){await this.on("disconnected",t)}async safeConnect(t,e,n){const i={count:0};do{let r=()=>{};const o=new Promise((e=>{r=n=>{t===n.channelName&&e(!0)},hn(this,cn,"f").on("connected",r)}));try{if(i.count>0){i.gotConnectedEvent=await Promise.race([yn(i.count),o]);const e=await this.wire.sendAction("connect-to-channel",{...n,retryInfo:i});return console.log(`Successfully connected to channelName: ${t}`),e.payload.data}const e=this.wire.sendAction("connect-to-channel",n);return i.originalMessageId=e.messageId,(await e).payload.data}catch(n){if(!n.message.includes("internal-nack"))throw n;e&&0===i.count&&console.warn(`No channel found for channelName: ${t}. Waiting for connection...`)}finally{i.count+=1,hn(this,cn,"f").removeListener("connected",r)}}while(e);throw new Error(`No channel found for channelName: ${t}.`)}async connect(t,e={}){if(await hn(this,dn,"f").getValue(),!t||"string"!=typeof t)throw new Error("Please provide a channelName string to connect to a channel.");const n={wait:!0,...this.wire.environment.getDefaultChannelOptions().connect,...e},{offer:i,rtc:r}=await hn(this,an,"f").createClientOffer(n);let o;(this.fin.me.isFrame||this.fin.me.isView||this.fin.me.isWindow)&&(o=(await this.fin.me.getInfo()).url);const s={channelName:t,...n,offer:i,connectionUrl:o},a=await this.safeConnect(t,n.wait,s),c=await hn(this,an,"f").createClientStrategy(r,a),d=new mn.ChannelClient(a,(()=>mn.ChannelClient.wireClose(this.wire,a,a.endpointId)),c);return c.onEndpointDisconnect(a.channelId,(async()=>{try{await d.sendDisconnectAction()}catch(t){console.warn(`Something went wrong during disconnect for client with uuid: ${a.uuid} / name: ${a.name} / endpointId: ${a.endpointId}.`)}finally{mn.ChannelClient.handleProviderDisconnect(a)}})),d}async create(t,e){if(!t)throw new Error("Please provide a channelName to create a channel");const{payload:{data:n}}=await this.wire.sendAction("create-channel",{channelName:t}),i=hn(this,an,"f").createProvider(e,n);return this.on("client-disconnected",(e=>{e.channelName===t&&wn.ChannelProvider.handleClientDisconnection(i,e)})),i}}Ft.Channel=vn,an=new WeakMap,cn=new WeakMap,dn=new WeakMap,Object.defineProperty(zt,"__esModule",{value:!0}),zt.InterAppPayload=zt.InterApplicationBus=void 0;const _n=r,Cn=h,bn=Bt,In=Ft,En=R;class xn extends Cn.Base{constructor(t){super(t),this.events={subscriberAdded:"subscriber-added",subscriberRemoved:"subscriber-removed"},this.refCounter=new bn.RefCounter,this.Channel=new In.Channel(t),this.emitter=new _n.EventEmitter,t.registerMessageHandler(this.onmessage.bind(this)),this.on=this.emitter.on.bind(this.emitter),this.removeAllListeners=this.emitter.removeAllListeners.bind(this.emitter)}async publish(t,e){await this.wire.sendAction("publish-message",{topic:t,message:e,sourceWindowName:this.me.name})}async send(t,e,n){const i=(0,En.validateIdentity)(t);if(i)throw new Error(i);await this.wire.sendAction("send-message",{destinationUuid:t.uuid,destinationWindowName:t.name,topic:e,message:n,sourceWindowName:this.me.name})}subscribe(t,e,n){const i=this.createSubscriptionKey(t.uuid,t.name||"*",e);return this.emitter.on(i,n),this.refCounter.actOnFirst(i,(async()=>{await this.wire.sendAction("subscribe",{sourceUuid:t.uuid,sourceWindowName:t.name||"*",topic:e,destinationWindowName:this.me.name})}),(()=>Promise.resolve()))}unsubscribe(t,e,n){const i=t.name||"*",r=this.createSubscriptionKey(t.uuid,i,e);return this.emitter.removeListener(r,n),this.refCounter.actOnLast(r,(async()=>{await this.wire.sendAction("unsubscribe",{sourceUuid:t.uuid,sourceWindowName:i,topic:e,destinationWindowName:this.me.name})}),(()=>new Promise((t=>t)).then((()=>{}))))}processMessage(t){const{payload:{message:e,sourceWindowName:n,sourceUuid:i,topic:r}}=t,o=[this.createSubscriptionKey(i,n,r),this.createSubscriptionKey(i,"*",r),this.createSubscriptionKey("*","*",r)],s={uuid:i,name:n};o.forEach((t=>{this.emitter.emit(t,e,s)}))}emitSubscriverEvent(t,e){const{payload:{targetName:n,uuid:i,topic:r}}=e,o={name:n,uuid:i,topic:r};this.emitter.emit(t,o)}createSubscriptionKey(t,e,n){const i=e||"*";if(!(t&&i&&n))throw new Error("Missing uuid, name, or topic string");return function(...t){return t.map((t=>Buffer.from(`${t}`).toString("base64"))).join("/")}(t,i,n)}onmessage(t){const{action:e}=t;switch(e){case"process-message":this.processMessage(t);break;case this.events.subscriberAdded:this.emitSubscriverEvent(this.events.subscriberAdded,t);break;case this.events.subscriberRemoved:this.emitSubscriverEvent(this.events.subscriberRemoved,t)}return!0}}zt.InterApplicationBus=xn,zt.InterAppPayload=class{};var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.Clipboard=void 0;const An=h;class Pn extends An.Base{async writeText(t){await this.wire.sendAction("clipboard-write-text",t)}async readText(t){const{payload:e}=await this.wire.sendAction("clipboard-read-text",{type:t});return e.data}async writeImage(t){await this.wire.sendAction("clipboard-write-image",t)}async readImage(t={format:"dataURL"}){const{payload:e}=await this.wire.sendAction("clipboard-read-image",t);return e.data}async writeHtml(t){await this.wire.sendAction("clipboard-write-html",t)}async readHtml(t){const{payload:e}=await this.wire.sendAction("clipboard-read-html",{type:t});return e.data}async writeRtf(t){await this.wire.sendAction("clipboard-write-rtf",t)}async readRtf(t){const{payload:e}=await this.wire.sendAction("clipboard-read-rtf",{type:t});return e.data}async write(t){await this.wire.sendAction("clipboard-write",t)}async getAvailableFormats(t){const{payload:e}=await this.wire.sendAction("clipboard-read-formats",{type:t});return e.data}}Sn.Clipboard=Pn;var Mn={},Ln={},Rn={};Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.ExternalApplication=void 0;const On=h;class Tn extends On.EmitterBase{constructor(t,e){super(t,"external-application",e.uuid),this.identity=e}getInfo(){return this.wire.sendAction("get-external-application-info",this.identity).then((({payload:t})=>t.data))}}Rn.ExternalApplication=Tn,Object.defineProperty(Ln,"__esModule",{value:!0}),Ln.ExternalApplicationModule=void 0;const kn=h,zn=Rn;class Bn extends kn.Base{wrap(t){return this.wire.sendAction("external-application-wrap").catch((t=>{})),Promise.resolve(new zn.ExternalApplication(this.wire,{uuid:t}))}wrapSync(t){return this.wire.sendAction("external-application-wrap-sync").catch((t=>{})),new zn.ExternalApplication(this.wire,{uuid:t})}}Ln.ExternalApplicationModule=Bn,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(Ln,t),n(Rn,t)}(Mn);var Fn={},Dn={},Un={};Object.defineProperty(Un,"__esModule",{value:!0}),Un._Frame=void 0;const jn=h;class Wn extends jn.EmitterBase{constructor(t,e){super(t,"frame",e.uuid,e.name),this.identity=e}getInfo(){return this.wire.sendAction("get-frame-info",this.identity).then((({payload:t})=>t.data))}getParentWindow(){return this.wire.sendAction("get-parent-window",this.identity).then((({payload:t})=>t.data))}}Un._Frame=Wn,Object.defineProperty(Dn,"__esModule",{value:!0}),Dn._FrameModule=void 0;const $n=h,Hn=R,Nn=Un;class Gn extends $n.Base{async wrap(t){this.wire.sendAction("frame-wrap").catch((t=>{}));const e=(0,Hn.validateIdentity)(t);if(e)throw new Error(e);return new Nn._Frame(this.wire,t)}wrapSync(t){this.wire.sendAction("frame-wrap-sync").catch((t=>{}));const e=(0,Hn.validateIdentity)(t);if(e)throw new Error(e);return new Nn._Frame(this.wire,t)}getCurrent(){return this.wire.sendAction("frame-get-current").catch((t=>{})),Promise.resolve(new Nn._Frame(this.wire,this.wire.environment.getCurrentEntityIdentity()))}getCurrentSync(){return this.wire.sendAction("frame-get-current-sync").catch((t=>{})),new Nn._Frame(this.wire,this.wire.environment.getCurrentEntityIdentity())}}Dn._FrameModule=Gn,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(Dn,t),n(Un,t)}(Fn);var Vn={};Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.GlobalHotkey=void 0;const qn=h;class Zn extends qn.EmitterBase{constructor(t){super(t,"global-hotkey")}async register(t,e){await this.on(t,e),await this.wire.sendAction("global-hotkey-register",{hotkey:t})}async unregister(t){await this.removeAllListeners(t),await this.wire.sendAction("global-hotkey-unregister",{hotkey:t})}async unregisterAll(){await Promise.all(this.eventNames().filter((t=>!("registered"===t||"unregistered"===t))).map((t=>this.removeAllListeners(t)))),await this.wire.sendAction("global-hotkey-unregister-all",{})}async isRegistered(t){const{payload:{data:e}}=await this.wire.sendAction("global-hotkey-is-registered",{hotkey:t});return e}}Vn.GlobalHotkey=Zn;var Yn,Jn={},Kn={},Xn={},Qn=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Platform=void 0;const ti=h,ei=R,ni=new Map;class ii extends ti.EmitterBase{constructor(t,e){super(e.wire,"application",t.uuid),this.getClient=t=>{this.wire.sendAction("platform-get-client",this.identity).catch((t=>{}));const e=t||this.identity,{uuid:n}=e;if(!ni.has(n)){const t=Qn(this,Yn,"f").call(this,n);ni.set(n,t)}return ni.get(n)},Yn.set(this,(async t=>{try{const e=`custom-frame-${t}`,n=await this._channel.connect(e,{wait:!1});return n.onDisconnection((()=>{ni.delete(t)})),n}catch(e){throw ni.delete(t),new Error("The targeted Platform is not currently running. Listen for application-started event for the given Uuid.")}})),this.launchLegacyManifest=this.launchContentManifest;const n=(0,ei.validateIdentity)(t);if(n)throw new Error(n);this._channel=e,this.identity={uuid:t.uuid},this.Layout=this.fin.Platform.Layout,this.Application=this.fin.Application.wrapSync(this.identity)}async createView(t,e,n){this.wire.sendAction("platform-create-view",this.identity).catch((t=>{}));const i=await this.getClient(),r=await i.dispatch("create-view",{target:e,opts:t,targetView:n});if(!r||(0,ei.validateIdentity)(r.identity))throw new Error(`When overwriting the createView call, please return an object that has a valid 'identity' property: ${JSON.stringify(r)}`);return this.fin.View.wrapSync(r.identity)}async createWindow(t){this.wire.sendAction("platform-create-window",this.identity).catch((t=>{}));const e=await this.getClient();t.reason||(t.reason="api-call");const n=await e.dispatch("create-view-container",t);if(!n||(0,ei.validateIdentity)(n.identity))throw new Error(`When overwriting the createWindow call, please return an object that has a valid 'identity' property: ${JSON.stringify(n)}`);const{identity:i}=n,r=this.fin.Window.wrapSync(i);return r.name=i.name,r.uuid=i.uuid,r}async quit(){return this.wire.sendAction("platform-quit",this.identity).catch((t=>{})),(await this.getClient()).dispatch("quit")}async closeView(t){this.wire.sendAction("platform-close-view",this.identity).catch((t=>{}));const e=await this.getClient();await e.dispatch("close-view",{view:t})}async reparentView(t,e){console.warn("Platform.reparentView has been deprecated, please use Platform.createView"),this.wire.sendAction("platform-reparent-view",this.identity).catch((t=>{}));const n={...t,uuid:t.uuid??this.identity.uuid},i=await this.fin.View.wrap(n),r=await i.getOptions();return this.createView(r,e)}async getSnapshot(){return this.wire.sendAction("platform-get-snapshot",this.identity).catch((t=>{})),(await this.getClient()).dispatch("get-snapshot")}async getViewSnapshot(t){return(await this.getClient()).dispatch("get-view-snapshot",{viewIdentity:t})}async applySnapshot(t,e){this.wire.sendAction("platform-apply-snapshot",this.identity).catch((t=>{}));const n="Requested snapshot must be a valid Snapshot object, or a url or filepath to such an object.";let i;if("string"==typeof t)try{i=(await this._channel.wire.sendAction("get-application-manifest",{manifestUrl:t})).payload.data}catch(t){throw new Error(`${n}: ${t}`)}else i=t;if(!i.windows)throw new Error(n);const r=await this.getClient();return await r.dispatch("apply-snapshot",{snapshot:i,options:e}),this}async fetchManifest(t){return(await this.getClient()).dispatch("platform-fetch-manifest",{manifestUrl:t})}async launchContentManifest(t){this.wire.sendAction("platform-launch-content-manifest",this.identity).catch((()=>{}));const e=await this.getClient(),n=await this.fetchManifest(t);return e.dispatch("launch-into-platform",{manifest:n,manifestUrl:t}),this}async setWindowContext(t={},e){if(this.wire.sendAction("platform-set-window-context",this.identity).catch((t=>{})),!t)throw new Error("Please provide a serializable object or string to set the context.");const n=await this.getClient(),{entityType:i}=e?await this.fin.System.getEntityInfo(e.uuid,e.name):this.fin.me;await n.dispatch("set-window-context",{context:t,entityType:i,target:e||{uuid:this.fin.me.uuid,name:this.fin.me.name}})}async getWindowContext(t){this.wire.sendAction("platform-get-window-context",this.identity).catch((t=>{}));const e=await this.getClient(),{entityType:n}=t?await this.fin.System.getEntityInfo(t.uuid,t.name):this.fin.me;return e.dispatch("get-window-context",{target:t||{uuid:this.fin.me.uuid,name:this.fin.me.name},entityType:n})}async closeWindow(t,e={skipBeforeUnload:!1}){return this.wire.sendAction("platform-close-window",this.identity).catch((t=>{})),(await this.getClient()).dispatch("close-window",{windowId:t,options:e})}}Xn.Platform=ii,Yn=new WeakMap;var ri={},oi={},si={},ai={};function ci(t){switch(t){case"columns":case"grid":case"rows":case"tabs":return!0;default:return!1}}Object.defineProperty(ai,"__esModule",{value:!0}),ai.overrideFromComposables=ai.isValidPresetType=void 0,ai.isValidPresetType=ci,ai.overrideFromComposables=function(...t){return e=>t.reduceRight(((t,e)=>n=>e(t(n))),(t=>t))(e)},ai.default={isValidPresetType:ci};var di,li=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(si,"__esModule",{value:!0}),si.Layout=void 0;const hi=W,ui=R,pi=h,fi=ai,mi=H,gi=ut;class wi extends pi.Base{constructor(t,e){super(e),di.set(this,new hi.Lazy((async()=>mi.LayoutNode.newLayoutEntitiesClient(await this.platform.getClient(),gi.LAYOUT_CONTROLLER_ID,this.identity)))),this.replace=async t=>{this.wire.sendAction("layout-replace").catch((t=>{}));const e=await this.platform.getClient();await e.dispatch("replace-layout",{target:this.identity,opts:{layout:t}})},this.replaceView=async(t,e)=>{this.wire.sendAction("layout-replace-view").catch((t=>{}));const n=await this.platform.getClient();await n.dispatch("replace-view",{target:this.identity,opts:{viewToReplace:t,newView:e}})},this.applyPreset=async t=>{this.wire.sendAction("layout-apply-preset").catch((t=>{}));const e=await this.platform.getClient(),{presetType:n}=t;if(!n||!(0,fi.isValidPresetType)(n))throw new Error("Cannot apply preset layout, please include an applicable presetType property in the PresetLayoutOptions.");await e.dispatch("apply-preset-layout",{target:this.identity,opts:{presetType:n}})};const n=(0,ui.validateIdentity)(t);if(n)throw new Error(n);this.identity=t,this.platform=this.fin.Platform.wrapSync({uuid:t.uuid}),t.uuid===this.fin.me.uuid&&t.name===this.fin.me.name&&(this.init=this.fin.Platform.Layout.init)}async getConfig(){return this.wire.sendAction("layout-get-config").catch((t=>{})),(await this.platform.getClient()).dispatch("get-frame-snapshot",{target:this.identity})}async getCurrentViews(){this.wire.sendAction("layout-get-views").catch((t=>{}));const t=await this.platform.getClient();return(await t.dispatch("get-layout-views",{target:this.identity})).map((t=>this.fin.View.wrapSync(t)))}async getRootItem(){this.wire.sendAction("layout-get-root-item").catch((()=>{}));const t=await li(this,di,"f").getValue(),e=await t.getRoot("layoutName"in this.identity?this.identity:void 0);return mi.LayoutNode.getEntity(e,t)}}si.Layout=wi,di=new WeakMap;var yi,vi,_i,Ci,bi,Ii=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},Ei=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(oi,"__esModule",{value:!0}),oi.LayoutModule=void 0;const xi=h,Si=si,Ai=ut;class Pi extends xi.Base{constructor(){super(...arguments),yi.add(this),vi.set(this,!1),_i.set(this,null),this.init=async(t={})=>{if(this.wire.sendAction("layout-init").catch((t=>{})),!this.wire.environment.layoutAllowedInContext(this.fin))throw new Error("Layout.init can only be called from a Window context.");if(Ii(this,vi,"f"))throw new Error("Layout.init was already called, please use Layout.create to add additional layouts.");"openfin"===this.wire.environment.type&&await this.fin.Platform.getCurrentSync().getClient(),Ei(this,vi,!0,"f"),Ei(this,_i,await this.wire.environment.initLayoutManager(this.fin,this.wire,t),"f"),await this.wire.environment.applyLayoutSnapshot(this.fin,Ii(this,_i,"f"),t);const e={name:this.fin.me.name,uuid:this.fin.me.uuid};if(!t.layoutManagerOverride){const t={layoutName:Ai.DEFAULT_LAYOUT_KEY,...e};return Ii(this,Ci,"f").call(this,t)}return this.wrapSync(e)},Ci.set(this,(t=>{const e="[Layout] You are using a deprecated property `layoutManager` - it will throw if you access it starting in v37.",n=new Proxy({},{get(t,n){throw console.warn(`[Layout-mgr-proxy] accessing ${n.toString()}`),new Error(e)}}),i=Object.assign(this.wrapSync(t),{layoutManager:n});return new Proxy(i,{get(t,n){if("layoutManager"===n)throw console.warn(`[Layout-proxy] accessing ${n.toString()}`),new Error(e);return t[n]}})})),this.getCurrentLayoutManagerSync=()=>Ii(this,yi,"m",bi).call(this,"fin.Platform.Layout.getCurrentLayoutManagerSync()"),this.create=async t=>this.wire.environment.createLayout(Ii(this,yi,"m",bi).call(this,"fin.Platform.Layout.create()"),t),this.destroy=async t=>this.wire.environment.destroyLayout(Ii(this,yi,"m",bi).call(this,"fin.Platform.Layout.destroy()"),t)}async wrap(t){return this.wire.sendAction("layout-wrap").catch((t=>{})),new Si.Layout(t,this.wire)}wrapSync(t){return this.wire.sendAction("layout-wrap-sync").catch((t=>{})),new Si.Layout(t,this.wire)}async getCurrent(){if(this.wire.sendAction("layout-get-current").catch((t=>{})),!this.fin.me.isWindow)throw new Error("You are not in a Window context.  Only Windows can have a Layout.");const{uuid:t,name:e}=this.fin.me;return this.wrap({uuid:t,name:e})}getCurrentSync(){if(this.wire.sendAction("layout-get-current-sync").catch((t=>{})),!this.fin.me.isWindow)throw new Error("You are not in a Window context.  Only Windows can have a Layout.");const{uuid:t,name:e}=this.fin.me;return this.wrapSync({uuid:t,name:e})}}oi.LayoutModule=Pi,vi=new WeakMap,_i=new WeakMap,Ci=new WeakMap,yi=new WeakSet,bi=function(t){if(!Ii(this,_i,"f"))throw new Error(`You must call init before using the API ${t}`);return Ii(this,_i,"f")},function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(oi,t),n(si,t)}(ri),Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.PlatformModule=void 0;const Mi=h,Li=Xn,Ri=ri;class Oi extends Mi.Base{constructor(t,e){super(t),this._channel=e,this.Layout=new Ri.LayoutModule(this.wire)}async init(t){if(!fin.__internal_.isPlatform||fin.me.name!==fin.me.uuid)throw new Error("fin.Platform.init should only be called from a custom platform provider running in the main window of the application.");return this.wire.environment.initPlatform(this.fin,t)}async wrap(t){return this.wire.sendAction("platform-wrap").catch((t=>{})),new Li.Platform({uuid:t.uuid},this._channel)}wrapSync(t){return this.wire.sendAction("platform-wrap-sync").catch((t=>{})),new Li.Platform({uuid:t.uuid},this._channel)}async getCurrent(){return this.wire.sendAction("platform-get-current").catch((t=>{})),this.wrap({uuid:this.wire.me.uuid})}getCurrentSync(){return this.wire.sendAction("platform-get-current-sync").catch((t=>{})),this.wrapSync({uuid:this.wire.me.uuid})}start(t){return this.wire.sendAction("platform-start").catch((t=>{})),new Promise((async(e,n)=>{try{const{uuid:n}=t,i=await this.fin.Application._create({...t,isPlatformController:!0});i.once("platform-api-ready",(()=>e(this.wrapSync({uuid:n})))),i._run({uuid:n})}catch(t){n(t)}}))}startFromManifest(t,e){return this.wire.sendAction("platform-start-from-manifest").catch((t=>{})),new Promise((async(n,i)=>{try{const i=await this.fin.Application._createFromManifest(t);i.once("platform-api-ready",(()=>n(this.wrapSync({uuid:i.identity.uuid})))),i._run(e)}catch(t){i(t)}}))}}Kn.PlatformModule=Oi,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(Kn,t),n(Xn,t)}(Jn);var Ti={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getMe=t.getBaseMe=t.environmentUnsupportedMessage=void 0;const e=Ct(),n=Fn,i=Mt(),r=Mn;function o(t,e,n){return{isView:"view"===t,isWindow:"window"===t,isFrame:"iframe"===t,isExternal:"external connection"===t,uuid:e,name:n,entityType:t}}t.environmentUnsupportedMessage="You are not running in OpenFin.",t.getBaseMe=o,t.getMe=function(s){const{uuid:a,name:c,entityType:d}=s.me,l={setContext(){throw new Error(t.environmentUnsupportedMessage)},addContextHandler(){throw new Error(t.environmentUnsupportedMessage)},getContextGroups(){throw new Error(t.environmentUnsupportedMessage)},joinContextGroup(){throw new Error(t.environmentUnsupportedMessage)},removeFromContextGroup(){throw new Error(t.environmentUnsupportedMessage)},getAllClientsInContextGroup(){throw new Error(t.environmentUnsupportedMessage)},getInfoForContextGroup(){throw new Error(t.environmentUnsupportedMessage)}},h="Interop API has not been instantiated. Either connection has failed or you have not declared interop in your config.",u={setContext(){throw new Error(h)},addContextHandler(){throw new Error(h)},getContextGroups(){throw new Error(h)},joinContextGroup(){throw new Error(h)},removeFromContextGroup(){throw new Error(h)},getAllClientsInContextGroup(){throw new Error(h)},getInfoForContextGroup(){throw new Error(h)}},p={eventNames:()=>{throw new Error(t.environmentUnsupportedMessage)},emit:()=>{throw new Error(t.environmentUnsupportedMessage)},listeners:()=>{throw new Error(t.environmentUnsupportedMessage)},listenerCount:()=>{throw new Error(t.environmentUnsupportedMessage)},on:()=>{throw new Error(t.environmentUnsupportedMessage)},addListener:()=>{throw new Error(t.environmentUnsupportedMessage)},once:()=>{throw new Error(t.environmentUnsupportedMessage)},prependListener:()=>{throw new Error(t.environmentUnsupportedMessage)},prependOnceListener:()=>{throw new Error(t.environmentUnsupportedMessage)},removeListener:()=>{throw new Error(t.environmentUnsupportedMessage)},removeAllListeners:()=>{throw new Error(t.environmentUnsupportedMessage)}};switch(d){case"view":return Object.assign(new e.View(s,{uuid:a,name:c}),o(d,a,c),{interop:u,isOpenFin:!0});case"window":return Object.assign(new i._Window(s,{uuid:a,name:c}),o(d,a,c),{interop:u,isOpenFin:!0});case"iframe":return Object.assign(new n._Frame(s,{uuid:a,name:c}),o(d,a,c),{interop:u,isOpenFin:!0});case"external connection":return Object.assign(new r.ExternalApplication(s,{uuid:a}),o(d,a,c),{interop:u,isOpenFin:!1});default:return{...o(d,a,c),...p,interop:l,isOpenFin:!1}}}}(Ti);var ki={},zi={},Bi={};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.createWarningObject=Bi.createUnusableObject=void 0,Bi.createUnusableObject=function(t){const e=()=>{throw new Error(t)};return new Proxy({},{apply:e,construct:e,defineProperty:e,deleteProperty:e,get:e,getOwnPropertyDescriptor:e,getPrototypeOf:e,has:e,isExtensible:e,ownKeys:e,preventExtensions:e,set:e,setPrototypeOf:e})},Bi.createWarningObject=function(t,e){return new Proxy(e,{get:(...e)=>(console.warn(t),Reflect.get(...e)),set:(...e)=>(console.warn(t),Reflect.set(...e)),getOwnPropertyDescriptor:(...e)=>(console.warn(t),Reflect.getOwnPropertyDescriptor(...e)),ownKeys:(...e)=>(console.warn(t),Reflect.ownKeys(...e))})};var Fi,Di={},Ui={},ji={};!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntentHandler=t.BROKER_ERRORS=t.generateOverrideWarning=t.generateOverrideError=t.wrapContextHandler=t.wrapInTryCatch=t.generateId=void 0,t.generateId=()=>`${Math.random()}${Date.now()}`,t.wrapInTryCatch=(t,e)=>(...n)=>{try{return t(...n)}catch(t){throw new Error((e||"")+t)}},t.wrapContextHandler=(t,e)=>async n=>{try{await t(n)}catch(t){throw console.error(`Error thrown by handler ${e} for context type ${n.type}: ${t}`),t}},t.generateOverrideError=(t,e)=>`You have tried to to use ${t} but ${e} has not been overridden in the Interop Broker. Please override this function. Refer to our documentation for more info.`,t.generateOverrideWarning=(t,e,n,i)=>{const{uuid:r,name:o}=n;return i?`Entity with identity: ${r}/${o} has called ${i} or ${t} but ${e} has not been overridden.`:`Entity with identity: ${r}/${o} has called ${t} but ${e} has not been overridden.`},t.BROKER_ERRORS={fireIntent:(0,t.generateOverrideError)("fireIntent","handleFiredIntent"),fireIntentForContext:(0,t.generateOverrideError)("fireIntentForContext","handleFiredIntentForContext"),getInfoForIntent:(0,t.generateOverrideError)("getInfoForIntent","handleInfoForIntent"),getInfoForIntentsByContext:(0,t.generateOverrideError)("getInfoForIntentsByContext","handleInfoForIntentsByContext"),joinSessionContextGroupWithJoinContextGroup:"The Context Group you have tried to join is a Session Context Group. Custom Context Groups can only be defined by the Interop Broker through code or manifest configuration. Please use joinSessionContextGroup.",fdc3Open:(0,t.generateOverrideError)("fdc3.open","fdc3HandleOpen"),fdc3FindInstances:(0,t.generateOverrideError)("fdc3.findInstances","fdc3HandleFindInstances"),fdc3GetAppMetadata:(0,t.generateOverrideError)("fdc3.getAppMetadata","fdc3HandleGetAppMetadata"),fdc3GetInfo:(0,t.generateOverrideError)("fdc3.getInfo","fdc3HandleGetInfo")},t.wrapIntentHandler=(t,e)=>async n=>{try{return t(n)}catch(t){throw console.error(`Error thrown by handler ${e}: ${t}`),t}}}(ji);var Wi,$i,Hi={};function Ni(){if($i)return Di;$i=1;var t,e,n,i=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},r=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Di,"__esModule",{value:!0}),Di.InteropBroker=void 0;const s=h,a=function(){if(Fi)return Ui;Fi=1,Object.defineProperty(Ui,"__esModule",{value:!0});const t=gr();return Ui.default=class{constructor(t,e){this.provider=t,this.id=e,this.lastContext=void 0,this.contextGroupMap=new Map,this.clients=new Map,this.registerListeners()}registerListeners(){this.provider.register(`sessionContextGroup:getContext-${this.id}`,this.getCurrentContext.bind(this)),this.provider.register(`sessionContextGroup:setContext-${this.id}`,this.setContext.bind(this)),this.provider.register(`sessionContextGroup:handlerAdded-${this.id}`,this.handlerAdded.bind(this)),this.provider.register(`sessionContextGroup:handlerRemoved-${this.id}`,this.handlerRemoved.bind(this))}getCurrentContext(t){return t.type?this.contextGroupMap.get(t.type):this.lastContext}setContext(e,n){const{context:i}=e,r=t.InteropBroker.checkContextIntegrity(i);if(!1===r.isValid)throw new Error(`Failed to set Context - bad Context. Reason: ${r.reason}. Context: ${JSON.stringify(i)}`);if(!this.getClientState(n))throw new Error(`Client with Identity: ${n.uuid} ${n.name} not in Session Client State Map`);this.contextGroupMap.set(i.type,i),this.lastContext=i,Array.from(this.clients.values()).forEach((t=>{t.contextHandlers.get(i.type)?.forEach((e=>{this.provider.dispatch(t.clientIdentity,e,i)})),t.globalHandler&&this.provider.dispatch(t.clientIdentity,t.globalHandler,i)}))}getClientState(t){return this.clients.get(t.endpointId)}async handlerAdded(t,e){const{handlerId:n,contextType:i}=t,r=this.getClientState(e);if(!r)throw new Error(`Client with Identity: ${e.uuid} ${e.name} not in Client State Map`);if(i){const t=r.contextHandlers.get(i)||[];r.contextHandlers.set(i,[...t,n]);const o=this.contextGroupMap.get(i);o&&await this.provider.dispatch(e,n,o)}else{r.globalHandler=n;const t=[...this.contextGroupMap.keys()].map((async t=>{const i=this.contextGroupMap.get(t);i&&await this.provider.dispatch(e,n,i)}));await Promise.all(t)}}handlerRemoved(t,e){const{handlerId:n}=t,i=this.clients.get(e.endpointId);i?(Array.from(i.contextHandlers).forEach((([,t])=>{const e=t.indexOf(n);e>-1&&t.splice(e,1)})),i.globalHandler===n&&(i.globalHandler=void 0)):console.warn(`Trying to remove a handler from a client that isn't mapped. handlerId: ${n}. clientIdentity: ${e}`)}registerNewClient(t){if(!this.clients.has(t.endpointId)){const e={contextHandlers:new Map,clientIdentity:t,globalHandler:void 0};this.clients.set(t.endpointId,e)}}onDisconnection(t){this.clients.delete(t.endpointId)}},Ui}(),d=ji,l=o,u=function(){if(Wi)return Hi;Wi=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.PrivateChannelProvider=void 0;const t=Ni();return Hi.PrivateChannelProvider=class e{constructor(t,e){this.provider=t,this.id=e,this.clients=new Map,this.registerListeners(),this.contextByContextType=new Map,this.lastContext=void 0,this.provider.onConnection((t=>this.registerNewClient(t))),this.provider.onDisconnection((async t=>{const{endpointId:e}=t;this.clients.has(e)&&await this.handleClientDisconnecting(t),0===(await this.provider.getAllClientInfo()).length&&this.provider.destroy()}))}getClientState(t){return this.clients.get(t.endpointId)}registerListeners(){this.provider.register("broadcast",this.broadcast.bind(this)),this.provider.register("getCurrentContext",this.getCurrentContext.bind(this)),this.provider.register("contextHandlerAdded",this.contextHandlerAdded.bind(this)),this.provider.register("contextHandlerRemoved",this.contextHandlerRemoved.bind(this)),this.provider.register("nonStandardHandlerRemoved",this.nonStandardHandlerRemoved.bind(this)),this.provider.register("onAddContextHandlerAdded",this.onAddContextHandlerAdded.bind(this)),this.provider.register("onDisconnectHandlerAdded",this.onDisconnectHandlerAdded.bind(this)),this.provider.register("onUnsubscribeHandlerAdded",this.onUnsubscribeHandlerAdded.bind(this)),this.provider.register("clientDisconnecting",((t,e)=>{this.handleClientDisconnecting(e)}))}broadcast(e,n){const{context:i}=e;if(!this.getClientState(n))throw new Error(`Client with Identity: ${n.uuid} ${n.name}, tried to call broadcast, is not connected to this Private Channel`);const r=t.InteropBroker.checkContextIntegrity(i);if(!1===r.isValid)throw new Error(`Failed to broadcast - bad Context. Reason: ${r.reason}. Context: ${JSON.stringify(i)}`);this.contextByContextType.set(i.type,i),this.lastContext=i,Array.from(this.clients.values()).forEach((t=>{const e=t.handlerIdsByContextTypes.get(i.type);e&&e.forEach((e=>{this.provider.dispatch(t.clientIdentity,e,i)})),t.globalHandler&&this.provider.dispatch(t.clientIdentity,t.globalHandler,i)}))}getCurrentContext(t,e){const{contextType:n}=t;if(!this.getClientState(e))throw new Error(`Client with Identity: ${e.uuid} ${e.name}, tried to call getCurrentContext, is not connected to this Private Channel`);return void 0!==n?this.contextByContextType.get(n)||null:this.lastContext?this.lastContext:null}contextHandlerAdded(t,e){const{handlerId:n,contextType:i}=t,r=this.getClientState(e);if(!r)throw new Error(`Client with Identity: ${e.uuid} ${e.name}, tried to call addContextListener, is not connected to this Private Channel`);if(i){const t=r.handlerIdsByContextTypes.get(i)||[];r.handlerIdsByContextTypes.set(i,[...t,n])}else r.globalHandler=n;Array.from(this.clients.values()).forEach((t=>{t.clientIdentity.endpointId!==e.endpointId&&t.onAddContextListenerHandlerId&&this.provider.dispatch(t.clientIdentity,t.onAddContextListenerHandlerId,i)}))}async contextHandlerRemoved(t,e){const{handlerId:n}=t,i=this.getClientState(e);if(i){let r;if(i.globalHandler===n)i.globalHandler=void 0;else for(const[t,e]of i.handlerIdsByContextTypes){const i=e.indexOf(n);i>-1&&(e.splice(i,1),r=t)}const o=(await this.getConnectedClients()).map((async t=>{const{clientIdentity:n,clientIdentity:{endpointId:i},onUnsubscribeHandlerId:o}=t;i!==e.endpointId&&o&&await this.provider.dispatch(n,o,r)}));try{await Promise.all(o)}catch(t){throw console.error(`Problem when attempting to dispatch to onUnsubscribeHandlers. Error: ${t} Removing Client: ${n}. uuid: ${e.uuid}. name: ${e.name}. endpointId: ${e.endpointId}`),new Error(t)}}else console.warn(`Trying to remove a handler from a client that isn't mapped. handlerId: ${n}. uuid: ${e.uuid}. name: ${e.name}. endpointId: ${e.endpointId}.`)}nonStandardHandlerRemoved(t,e){const{handlerId:n}=t,i=this.getClientState(e);i?i.onDisconnectHandlerId===n?i.onDisconnectHandlerId=void 0:i.onAddContextListenerHandlerId===n?i.onAddContextListenerHandlerId=void 0:i.onUnsubscribeHandlerId===n&&(i.onUnsubscribeHandlerId=void 0):console.warn(`Trying to remove a handler from a client that isn't mapped. handlerId: ${n}. clientIdentity: ${e}`)}onAddContextHandlerAdded(t,e){const n=this.getClientState(e),{handlerId:i}=t;if(!n)throw new Error(`Client with Identity: ${e.uuid} ${e.name}, tried to call onAddContextListener, is not connected to this Private Channel`);n.onAddContextListenerHandlerId=i,Array.from(this.clients.values()).forEach((t=>{t.clientIdentity.endpointId!==e.endpointId&&Array.from(t.handlerIdsByContextTypes.keys()).forEach((t=>{this.provider.dispatch(e,i,t)}))}))}onDisconnectHandlerAdded(t,e){const n=this.getClientState(e),{handlerId:i}=t;if(!n)throw new Error(`Client with Identity: ${e.uuid} ${e.name}, tried to call onDisconnect, is not connected to this Private Channel`);n.onDisconnectHandlerId=i}onUnsubscribeHandlerAdded(t,e){const n=this.getClientState(e),{handlerId:i}=t;if(!n)throw new Error(`Client with Identity: ${e.uuid} ${e.name}, tried to call onUnsubscribe, is not connected to this Private Channel`);n.onUnsubscribeHandlerId=i}removeClient(t){const e=this.getClientState(t);if(!e)throw new Error(`Client with Identity: ${t.uuid} ${t.name}, tried to call disconnect, is not connected to this Private Channel`);e.handlerIdsByContextTypes.clear(),this.clients.delete(t.endpointId)}async fireOnDisconnectForOtherClients(t){const{endpointId:e}=t,n=(await this.getConnectedClients()).map((async t=>{const{clientIdentity:{endpointId:n},onDisconnectHandlerId:i}=t;n!==e&&i&&await this.provider.dispatch(t.clientIdentity,i)}));try{await Promise.all(n)}catch(e){throw console.error(`Problem when attempting to dispatch to onDisconnectHandlers. Error: ${e} Disconnecting Client: uuid: ${t.uuid}. name: ${t.name}. endpointId: ${t.endpointId}`),new Error(e)}}async unsubscribeAll(t){const{endpointId:e}=t,n=this.clients.get(e);if(n){const e=Array.from(n.handlerIdsByContextTypes.values()).flat(),i=n.globalHandler;if(e.length>0){const n=e.map((async e=>this.contextHandlerRemoved({handlerId:e},t)));try{await Promise.all(n)}catch(t){console.error(t.message)}}if(i)try{await this.contextHandlerRemoved({handlerId:i},t)}catch(t){console.error(t.message)}}}async handleClientDisconnecting(t){await this.unsubscribeAll(t),this.removeClient(t),await this.fireOnDisconnectForOtherClients(t)}registerNewClient(t){if(!this.clients.has(t.endpointId)){const e={clientIdentity:t,handlerIdsByContextTypes:new Map,globalHandler:void 0,onAddContextListenerHandlerId:void 0,onUnsubscribeHandlerId:void 0,onDisconnectHandlerId:void 0};this.clients.set(t.endpointId,e)}}async getConnectedClients(){const t=await this.provider.getAllClientInfo();return Array.from(this.clients.values()).filter((e=>{const{uuid:n,name:i}=e.clientIdentity;return t.some((t=>i===t.name&&n===t.uuid))}))}static init(t,n){return new e(t,n)}},Hi}(),p=W,f=[{id:"green",displayMetadata:{color:"#00CC88",name:"green"}},{id:"purple",displayMetadata:{color:"#8C61FF",name:"purple"}},{id:"orange",displayMetadata:{color:"#FF8C4C",name:"orange"}},{id:"red",displayMetadata:{color:"#FF5E60",name:"red"}},{id:"pink",displayMetadata:{color:"#FF8FB8",name:"pink"}},{id:"yellow",displayMetadata:{color:"#E9FF8F",name:"yellow"}}];let m=class o extends s.Base{constructor(o,s,a){super(o),t.set(this,void 0),e.set(this,void 0),n.set(this,void 0),this.getProvider=()=>r(this,n,"f").getValue(),this.interopClients=new Map,this.contextGroupsById=new Map,i(this,e,a.contextGroups??[...f],"f"),i(this,t,a.fdc3Info,"f"),a?.logging&&(this.logging=a.logging),this.intentClientMap=new Map,this.lastContextMap=new Map,this.sessionContextGroupMap=new Map,i(this,n,new p.Lazy(s),"f"),this.setContextGroupMap(),this.setupChannelProvider()}static createClosedConstructor(...t){return class extends o{constructor(...e){if(e.length){const[n,i,r]=e;if(r&&"object"==typeof r&&!(0,l.isEqual)(r,t[2]))return console.warn("You have modified the parameters of the InteropOverride constructor. This behavior is deprecated and will be removed in a future version. You can modify these options in your manifest. Please consult our Interop docs for guidance on migrating to the new override scheme."),void super(t[0],t[1],r);console.warn("You are attempting to pass arguments to the InteropOverride constructor. This is not necessary, and these passed arguments will be ignored. You are likely using an older InteropBroker override scheme. Please consult our Interop docs for guidance on migrating to the new override scheme.")}super(...t)}}}setContext({context:t},e){this.wire.sendAction("interop-broker-set-context").catch((t=>{}));const n=this.getClientState(e);if(!n||!n.contextGroupId)throw n?new Error("You must join a context group before you can set context."):new Error(`Client with Identity: ${e.uuid} ${e.name} not in Client State Map`);{const{contextGroupId:e}=n;this.setContextForGroup({context:t},e)}}setContextForGroup({context:t},e){this.wire.sendAction("interop-broker-set-context-for-group").catch((t=>{}));const n=this.contextGroupsById.get(e);if(!n)throw new Error(`Unable to set context for context group that isn't in the context group mapping: ${e}.`);const i=o.checkContextIntegrity(t);if(!1===i.isValid)throw new Error(`Failed to set Context - bad Context. Reason: ${i.reason}. Context: ${JSON.stringify(t)}`);const r=t.type;n.set(r,t),this.lastContextMap.set(e,r),Array.from(this.interopClients.values()).filter((t=>t.contextGroupId===e)).forEach((e=>{for(const[,n]of e.contextHandlers)o.isContextTypeCompatible(r,n.contextType)&&this.invokeContextHandler(e.clientIdentity,n.handlerId,t)}))}getCurrentContext(t,e){this.wire.sendAction("interop-broker-get-current-context").catch((t=>{}));const n=this.getClientState(e);if(!n?.contextGroupId)throw new Error("You must be a member of a context group to call getCurrentContext");const{contextGroupId:i}=n,r=this.contextGroupsById.get(i),o=this.lastContextMap.get(i),s=t?.contextType??o;return r&&s?r.get(s):void 0}async joinContextGroup({contextGroupId:t,target:e},n){if(this.wire.sendAction("interop-broker-join-context-group").catch((t=>{})),this.sessionContextGroupMap.has(t))throw new Error(d.BROKER_ERRORS.joinSessionContextGroupWithJoinContextGroup);if(e){o.hasEndpointId(e)&&await this.addClientToContextGroup({contextGroupId:t},e);try{const n=this.channel.connections.filter((t=>t.uuid===e.uuid&&t.name===e.name));if(!n.length)throw new Error(`Given Identity ${e.uuid} ${e.name} is not connected to the Interop Broker.`);n.length>1&&console.warn(`More than one connection found for identity ${e.uuid} ${e.name}`);const i=[];for(const e of n)i.push(this.addClientToContextGroup({contextGroupId:t},e));await Promise.all(i)}catch(t){throw new Error(t)}}else await this.addClientToContextGroup({contextGroupId:t},n)}async addClientToContextGroup({contextGroupId:t},e){this.wire.sendAction("interop-broker-add-client-to-context-group").catch((t=>{}));const n=this.getClientState(e);if(!n)throw new Error(`Client with Identity: ${e.uuid} ${e.name} not in Client State Map`);if(!this.getContextGroups().find((e=>e.id===t)))throw new Error(`Attempting to join a context group that does not exist: ${t}. You may only join existing context groups.`);if(n.contextGroupId!==t){n.contextGroupId=t,await this.setCurrentContextGroupInClientOptions(e,t);const i=this.contextGroupsById.get(t);for(const[,t]of n.contextHandlers){const{contextType:n,handlerId:r}=t;if(void 0===n)i.forEach(((t,n)=>{this.invokeContextHandler(e,r,t)}));else if(i.has(n)){const t=i.get(n);t&&this.invokeContextHandler(e,r,t)}}}}async removeFromContextGroup({target:t},e){if(this.wire.sendAction("interop-broker-remove-from-context-group").catch((t=>{})),t){o.hasEndpointId(t)&&await this.removeClientFromContextGroup(t);try{const e=this.channel.connections.filter((e=>e.uuid===t.uuid&&e.name===t.name));if(!e.length)throw new Error(`No connection found for given Identity ${t.uuid} ${t.name}`);e.length>1&&console.warn(`More than one connection found for identity ${t.uuid} ${t.name}`);const n=[];for(const t of e)n.push(this.removeClientFromContextGroup(t));await Promise.all(n)}catch(t){throw new Error(t)}}else await this.removeClientFromContextGroup(e)}async removeClientFromContextGroup(t){this.wire.sendAction("interop-broker-remove-client-from-context-group").catch((t=>{}));const e=this.getClientState(t);e&&(e.contextGroupId=void 0),await this.setCurrentContextGroupInClientOptions(t,null)}getContextGroups(){return this.wire.sendAction("interop-broker-get-context-groups").catch((t=>{})),r(this,e,"f").map((t=>({...t})))}getInfoForContextGroup({contextGroupId:t}){return this.wire.sendAction("interop-broker-get-info-for-context-group").catch((t=>{})),this.getContextGroups().find((e=>e.id===t))}getAllClientsInContextGroup({contextGroupId:t}){return this.wire.sendAction("interop-broker-get-all-clients-in-context-group").catch((t=>{})),Array.from(this.interopClients.values()).filter((e=>e.contextGroupId===t)).map((t=>t.clientIdentity))}async handleFiredIntent(t,e){const n=(0,d.generateOverrideWarning)("fdc3.raiseIntent","InteropBroker.handleFiredIntent",e,"interopClient.fireIntent");throw console.warn(n),new Error(d.BROKER_ERRORS.fireIntent)}async setIntentTarget(t,e){this.wire.sendAction("interop-broker-set-intent-target").catch((t=>{}));const n=this.intentClientMap.get(e.name),i=`intent-handler-${t.name}`;if(n){const e=n.get(i);if(e){if(e.pendingIntents.push(t),e.clientIdentity&&e.isReady){const{clientIdentity:t,pendingIntents:r}=e;try{const n=r[r.length-1];await this.invokeIntentHandler(t,i,n),e.pendingIntents=[]}catch(n){console.error(`Error invoking intent handler for client ${t.uuid}/${t.name}/${t.endpointId}`),e.isReady=!1}}}else n.set(i,{isReady:!1,pendingIntents:[t]})}else{this.intentClientMap.set(e.name,new Map);const n=this.intentClientMap.get(e.name);n&&n.set(i,{isReady:!1,pendingIntents:[t]})}}async handleInfoForIntent(t,e){const n=(0,d.generateOverrideWarning)("fdc3.findIntent","InteropBroker.handleInfoForIntent",e,"interopClient.getInfoForIntent");throw console.warn(n),new Error(d.BROKER_ERRORS.getInfoForIntent)}async handleInfoForIntentsByContext(t,e){const n=(0,d.generateOverrideWarning)("fdc3.findIntentsByContext","InteropBroker.handleInfoForIntentsByContext",e,"interopClient.getInfoForIntentsByContext");throw console.warn(n),new Error(d.BROKER_ERRORS.getInfoForIntentsByContext)}async handleFiredIntentForContext(t,e){const n=(0,d.generateOverrideWarning)("fdc3.raiseIntentForContext","InteropBroker.handleFiredIntentForContext",e,"interopClient.fireIntentForContext");throw console.warn(n),new Error(d.BROKER_ERRORS.fireIntentForContext)}async clientDisconnected(t){}async fdc3HandleOpen({app:t,context:e},n){const i=(0,d.generateOverrideWarning)("fdc3.open","InteropBroker.fdc3HandleOpen",n);throw console.warn(i),new Error(d.BROKER_ERRORS.fdc3Open)}async fdc3HandleFindInstances(t,e){const n=(0,d.generateOverrideWarning)("fdc3.open","InteropBroker.fdc3HandleFindInstances",e);throw console.warn(n),new Error(d.BROKER_ERRORS.fdc3FindInstances)}async fdc3HandleGetAppMetadata(t,e){const n=(0,d.generateOverrideWarning)("fdc3.getAppMetadata","InteropBroker.fdc3HandleGetAppMetadata",e);throw console.warn(n),new Error(d.BROKER_ERRORS.fdc3GetAppMetadata)}async invokeContextHandler(t,e,n){const i=await this.getProvider();try{await i.dispatch(t,e,n)}catch(i){console.error(`Error invoking context handler ${e} for context type ${n.type} in client ${t.uuid}/${t.name}/${t.endpointId}`,i)}}async invokeIntentHandler(t,e,n){const i=await this.getProvider();await i.dispatch(t,e,n)}async fdc3HandleGetInfo(e,n){const{fdc3Version:i}=e;return{fdc3Version:i,...r(this,t,"f"),optionalFeatures:{OriginatingAppMetadata:!1,UserChannelMembershipAPIs:!0},appMetadata:{appId:"",instanceId:""}}}async getAllClientInfo(){return(await this.getProvider()).getAllClientInfo()}decorateSnapshot(t){return{...t,interopSnapshotDetails:{contextGroupStates:this.getContextGroupStates()}}}applySnapshot(t,e){const n=t?.interopSnapshotDetails?.contextGroupStates;n&&(e?.closeExistingWindows||this.updateExistingClients(n),this.rehydrateContextGroupStates(n))}updateExistingClients(t){this.interopClients.forEach((e=>{const{clientIdentity:n,contextGroupId:i,contextHandlers:r}=e;if(i){const e=t[i];for(const[,t]of Object.entries(e))r.forEach((e=>{const{handlerId:i,contextType:r}=e;o.isContextTypeCompatible(t.type,r)&&this.invokeContextHandler(n,i,t)}))}}))}getContextGroupStates(){return o.toObject(this.contextGroupsById)}rehydrateContextGroupStates(t){const e=Object.entries(t);for(const[t,n]of e){const e=Object.entries(n);for(const[n,i]of e)this.contextGroupsById.has(t)?this.contextGroupsById.get(t).set(n,i):console.warn(`Attempting to set a context group that isn't in the context group mapping. Skipping context group rehydration for: ${t}`)}}contextHandlerRegistered({contextType:t,handlerId:e},n){const i={contextType:t,handlerId:e},r=this.getClientState(n);if(r?.contextHandlers.set(e,i),r&&r.contextGroupId){const{contextGroupId:i}=r,o=this.contextGroupsById.get(i);if(void 0===t)o.forEach(((t,i)=>{this.invokeContextHandler(n,e,t)}));else if(o.has(t)){const i=o.get(t);i&&this.invokeContextHandler(n,e,i)}}}async intentHandlerRegistered(t,e){const{handlerId:n}=t,i=this.intentClientMap.get(e.name),r=i?.get(n);if(i)if(r){const{pendingIntents:i}=r;r.clientIdentity=e,r.isReady=!0;try{if(i.length>0){const t=i[i.length-1];await this.invokeIntentHandler(e,n,t),r.pendingIntents=[]}}catch(t){console.error(`Error invoking intent handler: ${n} for client ${e.uuid}/${e.name}/${e.endpointId}`)}}else i.set(n,{isReady:!0,pendingIntents:[],clientIdentity:e});else{this.intentClientMap.set(e.name,new Map);const t=this.intentClientMap.get(e.name);t&&t.set(n,{isReady:!0,pendingIntents:[],clientIdentity:e})}}removeContextHandler({handlerId:t},e){const n=this.getClientState(e);n&&n.contextHandlers.delete(t)}handleJoinSessionContextGroup({sessionContextGroupId:t},e){try{if(!t)throw new Error("Failed to join session context group: must specify group id.");const n=this.sessionContextGroupMap.get(t);if(n)n.registerNewClient(e);else{const n=new a.default(this.channel,t);n.registerNewClient(e),this.sessionContextGroupMap.set(t,n)}return{hasConflict:this.contextGroupsById.has(t)}}catch(t){throw new Error(t)}}getClientState(t){return this.interopClients.get(t.endpointId)}static toObject(t){const e=Object.fromEntries(t),n={};return Object.entries(e).forEach((([t,e])=>{const i=Object.fromEntries(e);n[t]=i})),n}static checkContextIntegrity(t){if(!t)return{isValid:!1,reason:"No context supplied"};if("object"!=typeof t)return{isValid:!1,reason:"Context must be an Object"};if(!t.type)return{isValid:!1,reason:"Context must have a type property"};if(t.id&&"object"!=typeof t.id)return{isValid:!1,reason:"Context id must be an Object populated with key-value identifiers (if set)"};if(t.id){const{id:e}=t,n=Object.keys(e);let i=!1;if(!n.length)return{isValid:!1,reason:"Context id must have at least one key-value identifier"};if(n.forEach((t=>{"string"==typeof t&&"string"==typeof e[t]||(i=!0)})),i)return{isValid:!1,reason:"Context id key-value identifiers must be of type string"}}return t.name&&"string"!=typeof t.name?{isValid:!1,reason:"Context name must be of string type (if set)"}:{isValid:!0}}static hasEndpointId(t){return void 0!==t.endpointId}static isContextTypeCompatible(t,e){return void 0===e||t===e}setContextGroupMap(){for(const t of this.getContextGroups())this.contextGroupsById.set(t.id,new Map)}async setCurrentContextGroupInClientOptions(t,e){try{const n=await this.fin.System.getEntityInfo(t.uuid,t.name);let i;"view"===n.entityType?i=await this.fin.View.wrap(t):"window"===n.entityType&&(i=await this.fin.Window.wrap(t)),i&&await i.updateOptions({interop:{currentContextGroup:e}})}catch(t){}}async setupChannelProvider(){try{const t=await this.getProvider();this.channel=t,this.wireChannel(t)}catch(t){throw new Error(`Error setting up Interop Broker Channel Provider: ${t}`)}}wireChannel(t){t.onConnection((async(t,e)=>{if(!await this.isConnectionAuthorized(t,e))throw new Error(`Connection not authorized for ${t.uuid}, ${t.name}`);if(!t.endpointId)throw new Error("Version too old to be compatible with Interop. Please upgrade your runtime to a more recent version.");const n={contextGroupId:void 0,contextHandlers:new Map,clientIdentity:t};e?.currentContextGroup&&this.contextGroupsById.has(e.currentContextGroup)&&(n.contextGroupId=e?.currentContextGroup),this.interopClients.set(t.endpointId,n)})),t.onDisconnection((t=>{this.interopClients.delete(t.endpointId);const e=this.intentClientMap.get(t.name);e&&t.uuid===this.fin.me.uuid&&e.forEach((t=>{t.isReady=!1})),this.sessionContextGroupMap.forEach((e=>{e.onDisconnection(t)})),this.clientDisconnected(t)})),t.beforeAction((async(t,e,n)=>{if(!await this.isActionAuthorized(t,e,n))throw new Error(`Action (${t}) not authorized for ${n.uuid}, ${n.name}`);this.logging?.beforeAction?.enabled&&console.log(t,e,n)})),t.afterAction(((t,e,n)=>{this.logging?.afterAction?.enabled&&console.log(t,e,n)})),t.register("setContext",this.setContext.bind(this)),t.register("fireIntent",this.handleFiredIntent.bind(this)),t.register("getCurrentContext",this.getCurrentContext.bind(this)),t.register("getInfoForIntent",this.handleInfoForIntent.bind(this)),t.register("getInfoForIntentsByContext",this.handleInfoForIntentsByContext.bind(this)),t.register("fireIntentForContext",this.handleFiredIntentForContext.bind(this)),t.register("getContextGroups",this.getContextGroups.bind(this)),t.register("joinContextGroup",this.joinContextGroup.bind(this)),t.register("removeFromContextGroup",this.removeFromContextGroup.bind(this)),t.register("getAllClientsInContextGroup",this.getAllClientsInContextGroup.bind(this)),t.register("getInfoForContextGroup",this.getInfoForContextGroup.bind(this)),t.register("contextHandlerRegistered",this.contextHandlerRegistered.bind(this)),t.register("intentHandlerRegistered",this.intentHandlerRegistered.bind(this)),t.register("removeContextHandler",this.removeContextHandler.bind(this)),t.register("sessionContextGroup:createIfNeeded",this.handleJoinSessionContextGroup.bind(this)),t.register("fdc3Open",this.fdc3HandleOpen.bind(this)),t.register("fdc3v2FindIntentsByContext",this.handleInfoForIntentsByContext.bind(this)),t.register("fdc3FindInstances",this.fdc3HandleFindInstances.bind(this)),t.register("fdc3GetAppMetadata",this.fdc3HandleGetAppMetadata.bind(this)),t.register("fdc3v2GetInfo",(async(t,e)=>this.fdc3HandleGetInfo.bind(this)(t,e))),t.register("createPrivateChannelProvider",(async t=>{const{channelId:e}=t,n=await this.fin.InterApplicationBus.Channel.create(e);u.PrivateChannelProvider.init(n,e)}))}isConnectionAuthorized(t,e){return this.wire.sendAction("interop-broker-is-connection-authorized").catch((t=>{})),Promise.resolve(!0)}isActionAuthorized(t,e,n){return this.wire.sendAction("interop-broker-is-action-authorized").catch((t=>{})),Promise.resolve(!0)}};return Di.InteropBroker=m,t=new WeakMap,e=new WeakMap,n=new WeakMap,Di}var Gi,Vi={},qi={},Zi=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},Yi=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(qi,"__esModule",{value:!0});const Ji=h,Ki=ji;class Xi extends Ji.Base{constructor(t,e,n){super(t),Gi.set(this,void 0),this.id=n,Zi(this,Gi,e,"f")}async setContext(t){return this.wire.sendAction("interop-session-context-group-set-context").catch((t=>{})),(await Yi(this,Gi,"f")).dispatch(`sessionContextGroup:setContext-${this.id}`,{sessionContextGroupId:this.id,context:t})}async getCurrentContext(t){return this.wire.sendAction("interop-session-context-group-get-context").catch((t=>{})),(await Yi(this,Gi,"f")).dispatch(`sessionContextGroup:getContext-${this.id}`,{sessionContextGroupId:this.id,type:t})}async addContextHandler(t,e){if(this.wire.sendAction("interop-session-context-group-add-handler").catch((t=>{})),"function"!=typeof t)throw new Error("Non-function argument passed to the first parameter 'handler'. Be aware that the argument order does not match the FDC3 standard.");const n=await Yi(this,Gi,"f");let i;return i=e?`sessionContextHandler:invoke-${this.id}-${e}-${(0,Ki.generateId)()}`:`sessionContextHandler:invoke-${this.id}`,n.register(i,(0,Ki.wrapContextHandler)(t,i)),await n.dispatch(`sessionContextGroup:handlerAdded-${this.id}`,{handlerId:i,contextType:e}),{unsubscribe:await this.createUnsubscribeCb(i)}}async createUnsubscribeCb(t){const e=await Yi(this,Gi,"f");return async()=>{e.remove(t),await e.dispatch(`sessionContextGroup:handlerRemoved-${this.id}`,{handlerId:t})}}getUserInstance(){return{id:this.id,setContext:(0,Ki.wrapInTryCatch)(this.setContext.bind(this),"Failed to set context: "),getCurrentContext:(0,Ki.wrapInTryCatch)(this.getCurrentContext.bind(this),"Failed to get context: "),addContextHandler:(0,Ki.wrapInTryCatch)(this.addContextHandler.bind(this),"Failed to add context handler: ")}}}qi.default=Xi,Gi=new WeakMap;var Qi={},tr={},er={},nr={};Object.defineProperty(nr,"__esModule",{value:!0}),nr.PrivateChannelClient=void 0;const ir=ji;var rr,or;function sr(){if(rr)return tr;rr=1;var t,e=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},n=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n};Object.defineProperty(tr,"__esModule",{value:!0}),tr.FDC3ModuleBase=void 0;const i=er,r=ji,s=lr(),a=o;return tr.FDC3ModuleBase=class{get client(){return e(this,t,"f").call(this)}get fin(){return this.wire.getFin()}constructor(e,i){this.wire=i,t.set(this,void 0),n(this,t,e,"f")}async broadcast(t){return this.wire.sendAction("fdc3-broadcast").catch((t=>{})),this.client.setContext(t)}async _open(t,e){this.wire.sendAction("fdc3-open").catch((t=>{}));try{return await s.InteropClient.ferryFdc3Call(this.client,"fdc3Open",{app:t,context:e})}catch(t){const e=t.message===r.BROKER_ERRORS.fdc3Open?"ResolverUnavailable":t.message;throw new Error(e)}}async _getChannels(){return(await this.client.getContextGroups()).map((t=>({...t,type:"system",...(0,i.getUnsupportedChannelApis)()})))}async getOrCreateChannel(t){this.wire.sendAction("fdc3-get-or-create-channel").catch((t=>{}));const e=(await this._getChannels()).find((e=>e.id===t));if(e)return{...e,type:"system",...(0,i.getUnsupportedChannelApis)()};try{const e=await this.client.joinSessionContextGroup(t);return(0,i.buildAppChannelObject)(e)}catch(t){throw console.error(t.message),new Error(i.ChannelError.CreationFailed)}}async getSystemChannels(){return this.wire.sendAction("fdc3-get-system-channels").catch((t=>{})),this._getChannels()}async joinChannel(t){this.wire.sendAction("fdc3-join-channel").catch((t=>{}));try{return await this.client.joinContextGroup(t)}catch(t){if(t.message===r.BROKER_ERRORS.joinSessionContextGroupWithJoinContextGroup?console.error("The Channel you have tried to join is an App Channel. Custom Channels can only be defined by the Interop Broker through code or manifest configuration. Please use getOrCreateChannel."):console.error(t.message),t.message.startsWith("Attempting to join a context group that does not exist"))throw new Error(i.ChannelError.NoChannelFound);throw new Error(i.ChannelError.AccessDenied)}}async getCurrentChannel(){this.wire.sendAction("fdc3-get-current-channel").catch((t=>{}));const t=await this.getCurrentContextGroupInfo();return t?this.buildChannelObject(t):null}async leaveCurrentChannel(){return this.wire.sendAction("fdc3-leave-current-channel").catch((t=>{})),this.client.removeFromContextGroup()}async getCurrentContextGroupInfo(){const t=await this.client.getContextGroups(),e=t.map((async t=>this.client.getAllClientsInContextGroup(t.id))),n=(await Promise.all(e)).findIndex((t=>t.some((t=>{const{uuid:e,name:n}=t;return this.wire.me.uuid===e&&this.wire.me.name===n}))));return t[n]}async buildChannelObject(t){return{...t,type:"system",addContextListener:(...[t,e])=>{let n,i;"function"==typeof t?(console.warn("addContextListener(handler) has been deprecated. Please use addContextListener(null, handler)"),n=t):(n=e,"string"==typeof t&&(i=t));const r=(async()=>{let t=!0;const e=await this.client.getCurrentContext(i);return this.client.addContextHandler(((i,r)=>{if(!t||(t=!1,!(0,a.isEqual)(e,i)))return n(i,r)}),i)})();return{...r,unsubscribe:()=>r.then((t=>t.unsubscribe()))}},broadcast:this.broadcast.bind(this),getCurrentContext:async t=>{const e=await this.client.getCurrentContext(t);return void 0===e?null:e}}}},t=new WeakMap,tr}nr.PrivateChannelClient=class{constructor(t,e){this.id=e,this.client=t,this.listeners=new Map}async broadcast(t){return this.client.dispatch("broadcast",{context:t})}async getCurrentContext(t){return this.client.dispatch("getCurrentContext",{contextType:t})}async addContextListener(t,e){if("function"!=typeof e)throw new Error("Non-function argument passed to the second parameter 'handler'. Be aware that the argument order does not match the FDC3 standard.");let n;n=t?`contextHandler:invoke-${this.id}-${t}-${ir.generateId()}`:`contextHandler:invoke-${this.id}-${ir.generateId()}`,this.client.register(n,ir.wrapContextHandler(e,n));const i={unsubscribe:await this.createContextUnsubscribeCb(n)};return this.listeners.set(n,i),await this.client.dispatch("contextHandlerAdded",{handlerId:n,contextType:t}),i}createNonStandardUnsubscribeCb(t){return async()=>{this.client.remove(t),this.listeners.delete(t),await this.client.dispatch("nonStandardHandlerRemoved",{handlerId:t})}}createContextUnsubscribeCb(t){return async()=>{this.client.remove(t),this.listeners.delete(t),await this.client.dispatch("contextHandlerRemoved",{handlerId:t})}}onAddContextListener(t){const e=`onContextHandlerAdded:invoke-${this.id}-${ir.generateId()}`;this.client.register(e,t);const n={unsubscribe:this.createNonStandardUnsubscribeCb(e)};return this.listeners.set(e,n),this.client.dispatch("onAddContextHandlerAdded",{handlerId:e}),n}onDisconnect(t){const e=`onDisconnect:invoke-${this.id}-${ir.generateId()}`;this.client.register(e,t);const n={unsubscribe:this.createNonStandardUnsubscribeCb(e)};return this.listeners.set(e,n),this.client.dispatch("onDisconnectHandlerAdded",{handlerId:e}),n}onUnsubscribe(t){const e=`onUnsubscribe:invoke-${this.id}-${ir.generateId()}`;this.client.register(e,t);const n={unsubscribe:this.createNonStandardUnsubscribeCb(e)};return this.listeners.set(e,n),this.client.dispatch("onUnsubscribeHandlerAdded",{handlerId:e}),n}async cleanUpAllSubs(){Array.from(this.listeners.keys()).forEach((t=>{this.client.remove(t),this.listeners.delete(t)}))}async disconnect(){try{await this.client.dispatch("clientDisconnecting"),await this.cleanUpAllSubs(),await this.client.disconnect()}catch(t){throw new Error(t.message)}}},function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getIntentResolution=t.isChannel=t.isContext=t.connectPrivateChannel=t.buildAppChannelObject=t.buildPrivateChannelObject=t.ChannelError=t.ResultError=t.UnsupportedChannelApiError=t.getUnsupportedChannelApis=void 0;const e=ji,n=nr,i=o;t.getUnsupportedChannelApis=t=>({addContextListener:()=>{throw new r("Channel.addContextListener",t)},broadcast:()=>{throw new r("Channel.broadcast",t)},getCurrentContext:()=>{throw new r("Channel.getCurrentContext",t)}});class r extends Error{constructor(t,e="System"){super(t),this.message=`Calling ${t} on an instance of a ${e} Channel returned by fdc3.get${e}Channels is not supported. If you would like to use a ${e} Channel, please use fdc3.joinChannel, fdc3.addContextListener, and fdc3.broadcast instead.`}}var s,a;t.UnsupportedChannelApiError=r,function(t){t.NoResultReturned="NoResultReturned",t.IntentHandlerRejected="IntentHandlerRejected"}(s=t.ResultError||(t.ResultError={})),(a=t.ChannelError||(t.ChannelError={})).NoChannelFound="NoChannelFound",a.AccessDenied="AccessDenied",a.CreationFailed="CreationFailed",t.buildPrivateChannelObject=t=>{let e=!1;const n=()=>{if(e)throw new Error("Private Channel Client has been disconnected from the Private Channel")};return{id:t.id,type:"private",broadcast:async e=>(n(),t.broadcast(e)),getCurrentContext:async e=>(n(),t.getCurrentContext(e)),addContextListener:async(e,i)=>{n();let r=i,o=e;return"function"==typeof e&&(console.warn("addContextListener(handler) has been deprecated. Please use addContextListener(null, handler)"),r=e,o=null),t.addContextListener(o,r)},onAddContextListener:e=>(n(),t.onAddContextListener(e)),disconnect:async()=>(n(),e=!0,t.disconnect()),onDisconnect:e=>(n(),t.onDisconnect(e)),onUnsubscribe:e=>(n(),t.onUnsubscribe(e))}},t.buildAppChannelObject=t=>({id:t.id,type:"app",broadcast:t.setContext,getCurrentContext:async e=>{const n=await t.getCurrentContext(e);return void 0===n?null:n},addContextListener:(e,n)=>{let r,o;"function"==typeof e?(console.warn("addContextListener(handler) has been deprecated. Please use addContextListener(null, handler)"),r=e):(r=n,"string"==typeof e&&(o=e));const s=(async()=>{let e=!0;const n=await t.getCurrentContext(o);return t.addContextHandler(((t,o)=>{if(!e||(e=!1,!(0,i.isEqual)(n,t)))return r(t,o)}),o)})();return{...s,unsubscribe:()=>s.then((t=>t.unsubscribe()))}}}),t.connectPrivateChannel=async e=>{try{const i=await fin.InterApplicationBus.Channel.connect(e),r=new n.PrivateChannelClient(i,e);return(0,t.buildPrivateChannelObject)(r)}catch(t){throw new Error(`Private Channel with id: ${e} doesn't exist`)}},t.isContext=t=>{if(t&&"object"==typeof t&&"type"in t){const{type:e}=t;return"string"==typeof e}return!1},t.isChannel=t=>{if(t&&"object"==typeof t&&"type"in t&&"id"in t){const{type:e,id:n}=t;return"string"==typeof e&&"string"==typeof n&&("app"===e||"private"===e)}return!1},t.getIntentResolution=async(n,i,r,o)=>{const a=(0,e.generateId)(),c=new Promise(((t,e)=>{fin.InterApplicationBus.subscribe({uuid:"*"},a,(e=>{t(e)})).catch((()=>e(new Error("getResult is not supported in this environment"))))})),d=r?{target:r,intentResolutionResultId:a}:{intentResolutionResultId:a},l=o?{name:o,context:i,metadata:d}:{...i,metadata:d},h=async()=>{let e=await c;if(!e||"object"!=typeof e)throw new Error(s.NoResultReturned);const{error:i}=e;if(i)throw new Error(s.IntentHandlerRejected);if((0,t.isChannel)(e)){const{id:i,type:r}=e;switch(r){case"private":e=await(0,t.connectPrivateChannel)(i);break;case"app":{const r=await n.joinSessionContextGroup(i);e=(0,t.buildAppChannelObject)(r);break}}}else if(!(0,t.isContext)(e))throw new Error(s.NoResultReturned);return e},u=o?await n.fireIntent(l):await n.fireIntentForContext(l);return"object"!=typeof u?{source:{appId:"",instanceId:""},intent:"",version:"2.0",getResult:h}:{...u,getResult:h}}}(er);var ar,cr,dr={};function lr(){if(cr)return Vi;cr=1;var t,e,n=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},i=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.InteropClient=void 0;const r=h,o=qi,s=function(){if(or)return Qi;or=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Fdc3Module=void 0;const t=ji,e=sr();class n extends e.FDC3ModuleBase{async open(t,e){await super._open(t,e)}addContextListener(t,e){let n;return this.wire.sendAction("fdc3-add-context-listener").catch((t=>{})),"function"==typeof t?(console.warn("addContextListener(handler) has been deprecated. Please use addContextListener(null, handler)"),n=this.client.addContextHandler(t)):n=this.client.addContextHandler(e,null===t?void 0:t),{...n,unsubscribe:()=>n.then((t=>t.unsubscribe()))}}addIntentListener(t,e){this.wire.sendAction("fdc3-add-intent-listener").catch((t=>{}));const n=this.client.registerIntentHandler((t=>{const{context:n,metadata:i}=t,{metadata:r}=n,o=i?.intentResolutionResultId||r?.intentResolutionResultId;o&&this.fin.InterApplicationBus.publish(o,null).catch((()=>null)),e(t.context)}),t,{fdc3Version:"1.2"});return{...n,unsubscribe:()=>n.then((t=>t.unsubscribe()))}}async raiseIntent(e,n,i){this.wire.sendAction("fdc3-raise-intent").catch((t=>{}));const r=i?{name:e,context:n,metadata:{target:i}}:{name:e,context:n};try{return await this.client.fireIntent(r)}catch(e){const n=e.message===t.BROKER_ERRORS.fireIntent?"ResolverUnavailable":e.message;throw new Error(n)}}async findIntent(e,n){this.wire.sendAction("fdc3-find-intent").catch((t=>{}));try{return await this.client.getInfoForIntent({name:e,context:n})}catch(e){const n=e.message===t.BROKER_ERRORS.getInfoForIntent?"ResolverUnavailable":e.message;throw new Error(n)}}async findIntentsByContext(e){this.wire.sendAction("fdc3-find-intents-by-context").catch((t=>{}));try{return await this.client.getInfoForIntentsByContext(e)}catch(e){const n=e.message===t.BROKER_ERRORS.getInfoForIntentsByContext?"ResolverUnavailable":e.message;throw new Error(n)}}async raiseIntentForContext(e,n){this.wire.sendAction("fdc3-raise-intent-for-context").catch((t=>{}));try{return await this.client.fireIntentForContext({...e,metadata:{target:n}})}catch(e){const n=e.message===t.BROKER_ERRORS.fireIntentForContext?"ResolverUnavailable":e.message;throw new Error(n)}}async getOrCreateChannel(t){return super.getOrCreateChannel(t)}getInfo(){return this.wire.sendAction("fdc3-get-info").catch((t=>{})),{providerVersion:this.wire.environment.getAdapterVersionSync(),provider:`openfin-${this.wire.me.uuid}`,fdc3Version:"1.2"}}}return Qi.Fdc3Module=n,Qi}(),a=function(){if(ar)return dr;ar=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Fdc3Module2=void 0;const t=sr(),e=ji,n=lr(),i=er,r=nr;class o extends t.FDC3ModuleBase{async open(t,e){return"string"==typeof t&&console.warn("Passing a string as the app parameter is deprecated, please use an AppIdentifier ({ appId: string; instanceId?: string })."),super._open(t,e)}async findInstances(t){this.wire.sendAction("fdc3-find-instances").catch((t=>{}));try{return await n.InteropClient.ferryFdc3Call(this.client,"fdc3FindInstances",t)}catch(t){const n=t.message===e.BROKER_ERRORS.fdc3FindInstances?"ResolverUnavailable":t.message;throw new Error(n)}}async getAppMetadata(t){this.wire.sendAction("fdc3-get-app-metadata").catch((t=>{}));try{return await n.InteropClient.ferryFdc3Call(this.client,"fdc3GetAppMetadata",t)}catch(t){const n=t.message===e.BROKER_ERRORS.fdc3GetAppMetadata?"ResolverUnavailable":t.message;throw new Error(n)}}async addContextListener(t,e){this.wire.sendAction("fdc3-add-context-listener").catch((t=>{}));const n=t=>e=>{const{contextMetadata:n,...i}=e,r=n?[{...i},n]:[e,null];t(...r)};let i=e,r=n(i);return"function"==typeof t?(console.warn("addContextListener(handler) has been deprecated. Please use addContextListener(null, handler)"),i=t,r=n(i),this.client.addContextHandler(r)):this.client.addContextHandler(r,null===t?void 0:t)}async findIntent(t,n,i){this.wire.sendAction("fdc3-find-intent").catch((t=>{}));try{return await this.client.getInfoForIntent({name:t,context:n,metadata:{resultType:i}})}catch(t){const n=t.message===e.BROKER_ERRORS.getInfoForIntent?"ResolverUnavailable":t.message;throw new Error(n)}}async findIntentsByContext(t,i){this.wire.sendAction("fdc3-find-intents-by-context").catch((t=>{}));const r=i?{context:t,metadata:{resultType:i}}:t;try{return await n.InteropClient.ferryFdc3Call(this.client,"fdc3v2FindIntentsByContext",r)}catch(t){const n=t.message===e.BROKER_ERRORS.getInfoForIntentsByContext?"ResolverUnavailable":t.message;throw new Error(n)}}async raiseIntent(t,n,r){this.wire.sendAction("fdc3-raise-intent").catch((t=>{}));try{return"string"==typeof r&&console.warn("Passing a string as the app parameter is deprecated, please use an AppIdentifier ({ appId: string; instanceId?: string })."),(0,i.getIntentResolution)(this.client,n,r,t)}catch(t){const n=t.message===e.BROKER_ERRORS.fireIntent?"ResolverUnavailable":t.message;throw new Error(n)}}async raiseIntentForContext(t,n){this.wire.sendAction("fdc3-raise-intent-for-context").catch((t=>{}));try{return"string"==typeof n&&console.warn("Passing a string as the app parameter is deprecated, please use an AppIdentifier ({ appId: string; instanceId?: string })."),(0,i.getIntentResolution)(this.client,t,n)}catch(t){const n=t.message===e.BROKER_ERRORS.fireIntent?"ResolverUnavailable":t.message;throw new Error(n)}}async addIntentListener(t,e){if(this.wire.sendAction("fdc3-add-intent-listener").catch((t=>{})),"string"!=typeof t)throw new Error("First argument must be an Intent name");return this.client.registerIntentHandler((async t=>{let n,i;const{context:r,metadata:o}=t,{contextMetadata:s,metadata:a,...c}=r,d=o?.intentResolutionResultId||a?.intentResolutionResultId;try{const t=a?{metadata:a,...c}:{...c};n=await e(t,s),i=n}catch(t){n=t,i={error:!0}}if(d&&this.fin.InterApplicationBus.publish(d,i).catch((()=>null)),n instanceof Error)throw new Error(n.message);return n}),t,{fdc3Version:"2.0"})}async getOrCreateChannel(t){return super.getOrCreateChannel(t)}async createPrivateChannel(){const t=(0,e.generateId)();await n.InteropClient.ferryFdc3Call(this.client,"createPrivateChannelProvider",{channelId:t});const o=await this.fin.InterApplicationBus.Channel.connect(t),s=new r.PrivateChannelClient(o,t);return(0,i.buildPrivateChannelObject)(s)}async getUserChannels(){return(await this.client.getContextGroups()).map((t=>({...t,type:"user",...(0,i.getUnsupportedChannelApis)("User")})))}async getSystemChannels(){return console.warn("This API has been deprecated. Please use fdc3.getUserChannels instead."),super.getSystemChannels()}async joinUserChannel(t){return super.joinChannel(t)}async joinChannel(t){return console.warn("This API has been deprecated. Please use fdc3.joinUserChannel instead."),super.joinChannel(t)}async getCurrentChannel(){const t=await super.getCurrentChannel();return t?{...t,type:"user",broadcast:this.broadcast.bind(this)}:null}async getInfo(){return n.InteropClient.ferryFdc3Call(this.client,"fdc3v2GetInfo",{fdc3Version:"2.0"})}}return dr.Fdc3Module2=o,dr}(),d=ji;let l=class extends r.Base{constructor(i,r){super(i),t.set(this,void 0),e.set(this,void 0),n(this,e,new Map,"f"),n(this,t,r,"f")}async setContext(e){return this.wire.sendAction("interop-client-set-context").catch((t=>{})),(await i(this,t,"f")).dispatch("setContext",{context:e})}async addContextHandler(e,n){if(this.wire.sendAction("interop-client-add-context-handler").catch((t=>{})),"function"!=typeof e)throw new Error("Non-function argument passed to the first parameter 'handler'. Be aware that the argument order does not match the FDC3 standard.");const r=await i(this,t,"f");let o;o=n?`invokeContextHandler-${n}-${(0,d.generateId)()}`:"invokeContextHandler";const s=(0,d.wrapContextHandler)(e,o);return r.register(o,s),await r.dispatch("contextHandlerRegistered",{handlerId:o,contextType:n}),{unsubscribe:async()=>{r.remove(o),await r.dispatch("removeContextHandler",{handlerId:o})}}}async getContextGroups(){return this.wire.sendAction("interop-client-get-context-groups").catch((t=>{})),(await i(this,t,"f")).dispatch("getContextGroups")}async joinContextGroup(e,n){this.wire.sendAction("interop-client-join-context-group").catch((t=>{}));const r=await i(this,t,"f");if(!e)throw new Error("No contextGroupId specified for joinContextGroup.");return r.dispatch("joinContextGroup",{contextGroupId:e,target:n})}async removeFromContextGroup(e){return this.wire.sendAction("interop-client-remove-from-context-group").catch((t=>{})),(await i(this,t,"f")).dispatch("removeFromContextGroup",{target:e})}async getAllClientsInContextGroup(e){this.wire.sendAction("interop-client-get-all-clients-in-context-group").catch((t=>{}));const n=await i(this,t,"f");if(!e)throw new Error("No contextGroupId specified for getAllClientsInContextGroup.");return n.dispatch("getAllClientsInContextGroup",{contextGroupId:e})}async getInfoForContextGroup(e){this.wire.sendAction("interop-client-get-info-for-context-group").catch((t=>{}));const n=await i(this,t,"f");if(!e)throw new Error("No contextGroupId specified for getInfoForContextGroup.");return n.dispatch("getInfoForContextGroup",{contextGroupId:e})}async fireIntent(e){return this.wire.sendAction("interop-client-fire-intent").catch((t=>{})),(await i(this,t,"f")).dispatch("fireIntent",e)}async registerIntentHandler(e,n,r){this.wire.sendAction("interop-client-register-intent-handler").catch((t=>{}));const o=await i(this,t,"f"),s=`intent-handler-${n}`,a=(0,d.wrapIntentHandler)(e,s);try{await o.register(s,a),await o.dispatch("intentHandlerRegistered",{handlerId:s,...r})}catch(t){throw new Error("Unable to register intent handler")}return{unsubscribe:async()=>{o.remove(s)}}}async getCurrentContext(e){return this.wire.sendAction("interop-client-get-current-context").catch((t=>{})),(await i(this,t,"f")).dispatch("getCurrentContext",{contextType:e})}async getInfoForIntent(e){return this.wire.sendAction("interop-client-get-info-for-intent").catch((t=>{})),(await i(this,t,"f")).dispatch("getInfoForIntent",e)}async getInfoForIntentsByContext(e){return this.wire.sendAction("interop-client-get-info-for-intents-by-context").catch((t=>{})),(await i(this,t,"f")).dispatch("getInfoForIntentsByContext",e)}async fireIntentForContext(e){return this.wire.sendAction("interop-client-fire-intent-for-context").catch((t=>{})),(await i(this,t,"f")).dispatch("fireIntentForContext",e)}async joinSessionContextGroup(n){try{const r=i(this,e,"f").get(n);if(r)return r.getUserInstance();const s=await i(this,t,"f"),{hasConflict:a}=await s.dispatch("sessionContextGroup:createIfNeeded",{sessionContextGroupId:n});a&&console.warn(`A (non-session) context group with the name "${n}" already exists. If you are trying to join a Context Group, call joinContextGroup instead.`);const c=new o.default(this.wire,i(this,t,"f"),n);return i(this,e,"f").set(n,c),c.getUserInstance()}catch(t){throw console.error(`Error thrown trying to create Session Context Group with id "${n}": ${t}`),t}}async onDisconnection(e){return this.wire.sendAction("interop-client-add-ondisconnection-listener").catch((t=>{})),(await i(this,t,"f")).onDisconnection((t=>{const{uuid:n}=t;e({type:"interop-broker",topic:"disconnected",brokerName:n})}))}getFDC3Sync(t){switch(t){case"1.2":return new s.Fdc3Module((()=>this),this.wire);case"2.0":return new a.Fdc3Module2((()=>this),this.wire);default:throw new Error(`Invalid FDC3 version provided: ${t}. Must be '1.2' or '2.0'`)}}async getFDC3(t){return this.getFDC3Sync(t)}static async ferryFdc3Call(e,n,r){return(await i(e,t,"f")).dispatch(n,r||null)}};return Vi.InteropClient=l,t=new WeakMap,e=new WeakMap,Vi}var hr,ur,pr,fr={};function mr(){if(hr)return fr;hr=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.overrideCheck=fr.checkFDC32Overrides=fr.getDefaultViewFdc3VersionFromAppInfo=void 0;const t=Ni();function e(e){return["fdc3HandleFindInstances","handleInfoForIntent","handleInfoForIntentsByContext","fdc3HandleGetAppMetadata","fdc3HandleGetInfo","fdc3HandleOpen","handleFiredIntent","handleFiredIntentForContext"].filter((n=>e[n]===t.InteropBroker.prototype[n]))}return fr.getDefaultViewFdc3VersionFromAppInfo=function({manifest:t,initialOptions:e}){const n=t?.platform?.defaultViewOptions?.fdc3InteropApi??e.defaultViewOptions?.fdc3InteropApi;return["1.2","2.0"].includes(n??"")?n:void 0},fr.checkFDC32Overrides=e,fr.overrideCheck=function(t,n){if(n&&"2.0"===n){const n=e(t);n.length>0&&console.warn(`WARNING: FDC3 2.0 has been set as a default option for Views in this Platform, but the required InteropBroker APIs for FDC3 2.0 compliance have not all been overridden.\nThe following APIs need to be overridden:\n${n.join("\n")}`)}},fr}function gr(){return pr||(pr=1,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(function(){if(ur)return zi;ur=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.InteropModule=void 0;const t=o,e=Bi,n=h,i=Ni(),r=lr(),s=mr(),a=ai,c=t=>new t,d="You have attempted to use or modify InteropBroker parameters, which is not allowed. You are likely using an older InteropBroker override scheme. Please consult our Interop docs for guidance on migrating to the new override scheme.";class l extends n.Base{async init(n,r=c){this.wire.sendAction("interop-init").catch((()=>{}));const o=await this.wire.environment.getInteropInfo(this.wire.getFin()),l=(0,e.createUnusableObject)(d),h=(0,e.createWarningObject)(d,(0,t.cloneDeep)(o)),u=async()=>{throw new Error(d)},p=i.InteropBroker.createClosedConstructor(this.wire,(()=>this.fin.InterApplicationBus.Channel.create(`interop-broker-${n}`)),o);let f;return f=Array.isArray(r)?new((0,a.overrideFromComposables)(...r)(p))(l,u,h):await r(p,l,u,h),(0,s.overrideCheck)(f,o.fdc3Version),f}connectSync(t,e){return this.wire.sendAction("interop-connect-sync").catch((()=>{})),new r.InteropClient(this.wire,this.wire.environment.whenReady().then((()=>this.fin.InterApplicationBus.Channel.connect(`interop-broker-${t}`,{payload:e}))))}}return zi.InteropModule=l,zi}(),t),n(lr(),t),n(Ni(),t)}(ki)),ki}var wr={},yr={},vr={},_r={};Object.defineProperty(_r,"__esModule",{value:!0}),_r.getSnapshotSourceChannelName=void 0,_r.getSnapshotSourceChannelName=t=>`snapshot-source-provider-${t.uuid}`;var Cr,br,Ir,Er,xr,Sr=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},Ar=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(vr,"__esModule",{value:!0}),vr.SnapshotSource=void 0;const Pr=h,Mr=_r,Lr=new Map;class Rr extends Pr.Base{constructor(t,e){super(t),Cr.set(this,void 0),br.set(this,(()=>(Lr.has(this.identity.uuid)||Lr.set(this.identity.uuid,{eventFired:null,clientPromise:null}),Lr.get(this.identity.uuid)))),Ir.set(this,(()=>(Ar(this,br,"f").call(this).clientPromise||(Ar(this,br,"f").call(this).clientPromise=Ar(this,Er,"f").call(this)),Ar(this,br,"f").call(this).clientPromise))),Er.set(this,(async()=>{const t=(0,Mr.getSnapshotSourceChannelName)(this.identity);try{Ar(this,br,"f").call(this).eventFired||await Ar(this,xr,"f").call(this);const e=await this.fin.InterApplicationBus.Channel.connect(t,{wait:!1});return e.onDisconnection((()=>{Ar(this,br,"f").call(this).clientPromise=null,Ar(this,br,"f").call(this).eventFired=null})),e}catch(t){throw Ar(this,br,"f").call(this).clientPromise=null,new Error("The targeted SnapshotSource is not currently initialized. Await this object's ready() method.")}})),xr.set(this,(async()=>{const t=(0,Mr.getSnapshotSourceChannelName)(this.identity);let e,n;const i=new Promise(((t,i)=>{e=t,n=i}));Ar(this,br,"f").call(this).eventFired=i;const r=async i=>{try{i.channelName===t&&(e(),await this.fin.InterApplicationBus.Channel.removeListener("connected",r))}catch(t){n(t)}};await this.fin.InterApplicationBus.Channel.on("connected",r)})),Sr(this,Cr,e,"f")}get identity(){return Ar(this,Cr,"f")}async ready(){this.wire.sendAction("snapshot-source-ready").catch((t=>{}));try{await Ar(this,Ir,"f").call(this)}catch(t){await Ar(this,br,"f").call(this).eventFired}}async getSnapshot(){this.wire.sendAction("snapshot-source-get-snapshot").catch((t=>{}));const t=await Ar(this,Ir,"f").call(this),e=await t.dispatch("get-snapshot");return(await e).snapshot}async applySnapshot(t){return this.wire.sendAction("snapshot-source-apply-snapshot").catch((t=>{})),(await Ar(this,Ir,"f").call(this)).dispatch("apply-snapshot",{snapshot:t})}}vr.SnapshotSource=Rr,Cr=new WeakMap,br=new WeakMap,Ir=new WeakMap,Er=new WeakMap,xr=new WeakMap,Object.defineProperty(yr,"__esModule",{value:!0}),yr.SnapshotSourceModule=void 0;const Or=h,Tr=vr,kr=_r;class zr extends Or.Base{async init(t){if(this.wire.sendAction("snapshot-source-init").catch((t=>{})),"object"!=typeof t||"function"!=typeof t.getSnapshot||"function"!=typeof t.applySnapshot)throw new Error("you must pass in a valid SnapshotProvider");const e=await this.fin.InterApplicationBus.Channel.create((0,kr.getSnapshotSourceChannelName)(this.fin.me));e.register("get-snapshot",(async()=>({snapshot:await t.getSnapshot()}))),e.register("apply-snapshot",(({snapshot:e})=>t.applySnapshot(e)))}wrapSync(t){return this.wire.sendAction("snapshot-source-wrap-sync").catch((t=>{})),new Tr.SnapshotSource(this.wire,t)}async wrap(t){return this.wire.sendAction("snapshot-source-wrap").catch((t=>{})),this.wrapSync(t)}}yr.SnapshotSourceModule=zr,function(t){var e=c&&c.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n);var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),n=c&&c.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(t,"__esModule",{value:!0}),n(yr,t),n(vr,t)}(wr),Object.defineProperty(d,"__esModule",{value:!0});var Br=d.Fin=void 0;const Fr=r,Dr=l,Ur=Mt(),jr=It(),Wr=zt,$r=Sn,Hr=Mn,Nr=Fn,Gr=Vn,Vr=Ct(),qr=Jn,Zr=Ti,Yr=gr(),Jr=wr;class Kr extends Fr.EventEmitter{constructor(t){super(),this.wire=t,this.System=new Dr.System(t),this.Window=new Ur._WindowModule(t),this.Application=new jr.ApplicationModule(t),this.InterApplicationBus=new Wr.InterApplicationBus(t),this.Clipboard=new $r.Clipboard(t),this.ExternalApplication=new Hr.ExternalApplicationModule(t),this.Frame=new Nr._FrameModule(t),this.GlobalHotkey=new Gr.GlobalHotkey(t),this.Platform=new qr.PlatformModule(t,this.InterApplicationBus.Channel),this.View=new Vr.ViewModule(t),this.Interop=new Yr.InteropModule(t),this.SnapshotSource=new Jr.SnapshotSourceModule(t),t.registerFin(this),this.me=(0,Zr.getMe)(t),t.on("disconnected",(()=>{this.emit("disconnected")}))}}Br=d.Fin=Kr;var Xr={},Qr={};function to(t){return"string"==typeof t.manifestUrl}function eo(t){return io(t)&&"string"==typeof t.address}function no(t){return eo(t)&&"string"==typeof t.token}function io(t){return"string"==typeof t.uuid}function ro(t){return t.runtime&&"string"==typeof t.runtime.version}function oo(t){return io(t)&&ro(t)}Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.isInternalConnectConfig=Qr.isPortDiscoveryConfig=Qr.isNewConnectConfig=Qr.isConfigWithReceiver=Qr.isRemoteConfig=Qr.isExistingConnectConfig=Qr.isExternalConfig=void 0,Qr.isExternalConfig=to,Qr.isExistingConnectConfig=eo,Qr.isRemoteConfig=no,Qr.isConfigWithReceiver=function(t){return"object"==typeof t.receiver&&no({...t,address:""})},Qr.isNewConnectConfig=oo,Qr.isPortDiscoveryConfig=function(t){return to(t)&&ro(t)||oo(t)},Qr.isInternalConnectConfig=function(t){return eo(t)||oo(t)};var so={},ao={};Object.defineProperty(ao,"__esModule",{value:!0}),ao.EmitterMap=void 0;const co=r;function lo(t){return Buffer.from(t).toString("base64")}ao.EmitterMap=class{constructor(){this.storage=new Map}hashKeys(t){return t.map(lo).join("/")}getOrCreate(t){const e=this.hashKeys(t);return this.storage.has(e)||this.storage.set(e,new co.EventEmitter),this.storage.get(e)}has(t){return this.storage.has(this.hashKeys(t))}delete(t){const e=this.hashKeys(t);return this.storage.delete(e)}},Object.defineProperty(so,"__esModule",{value:!0});const ho=ao;class uo extends ho.EmitterMap{constructor(){super(...arguments),this.dispatchEvent=t=>{if(function(t){return"process-desktop-event"===t.action}(t)){const{payload:e}=t,n=function(t){const{topic:e}=t;if("frame"===e||"window"===e||"view"===e){const{uuid:n,name:i}=t;return[e,n,i]}if("application"===e){const{uuid:n}=t;return[e,n]}return[e]}(e);if(this.has(n))return this.getOrCreate(n).emit(e.type,e),!0}return!1}}}so.default=uo;var po,fo,mo=c&&c.__classPrivateFieldSet||function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},go=c&&c.__classPrivateFieldGet||function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)};Object.defineProperty(Xr,"__esModule",{value:!0});var wo=Xr.Transport=void 0;const yo=r,vo=Qr,_o=v,Co=so,bo=Ti,Io=se;class Eo extends yo.EventEmitter{constructor(t,e,n){super(),this.wireListeners=new Map,this.topicRefMap=new Map,this.eventAggregator=new Co.default,this.messageHandlers=[this.eventAggregator.dispatchEvent],po.set(this,void 0),fo.set(this,void 0),this.connectSync=()=>{go(this,po,"f").connectSync()},this.getPort=()=>go(this,po,"f").getPort(),mo(this,po,new t(this.onmessage.bind(this)),"f"),this.environment=e,this.sendRaw=go(this,po,"f").send.bind(go(this,po,"f")),this.registerMessageHandler(this.handleMessage.bind(this)),go(this,po,"f").on("disconnected",(()=>{for(const[,{handleNack:t}]of this.wireListeners)t({reason:"Remote connection has closed"});this.wireListeners.clear(),this.emit("disconnected")}));const{uuid:i,name:r}=n,o=this.environment.getCurrentEntityType();this.me=(0,bo.getBaseMe)(o,i,r)}getFin(){if(!go(this,fo,"f"))throw new Error("No Fin object registered for this transport");return go(this,fo,"f")}registerFin(t){if(go(this,fo,"f"))throw new Error("Fin object has already been registered for this transport");mo(this,fo,t,"f")}shutdown(){return go(this,po,"f").shutdown()}async connect(t){if((0,vo.isConfigWithReceiver)(t))return await go(this,po,"f").connect(t.receiver),this.authorize(t);if((0,vo.isRemoteConfig)(t))return this.connectRemote(t);if((0,vo.isExistingConnectConfig)(t))return this.connectByPort(t);if((0,vo.isNewConnectConfig)(t)){const e=await this.environment.retrievePort(t);return this.connectByPort({...t,address:`ws://localhost:${e}`})}}async connectRemote(t){return await go(this,po,"f").connect(new(this.environment.getWsConstructor())(t.address)),this.authorize(t)}async connectByPort(t){const{address:e,uuid:n}=t,i={...t,type:"file-token"},r=go(this,po,"f");await r.connect(new(this.environment.getWsConstructor())(t.address));const o=await this.sendAction("request-external-authorization",{uuid:n,type:"file-token"},!0);if("external-authorization-response"!==o.action)throw new _o.UnexpectedActionError(o.action);return await this.environment.writeToken(o.payload.file,o.payload.token),this.authorize(i)}async authorize(t){const e=await this.sendAction("request-authorization",t,!0);if("authorization-response"!==e.action)throw new _o.UnexpectedActionError(e.action);if(!0!==e.payload.success)throw new _o.RuntimeError(e.payload)}sendAction(t,e={},n=!1){let i=()=>{};const r=_o.RuntimeError.getCallSite(1),o=this.environment.getNextMessageId(),s=new Promise(((s,a)=>{i=a;const c={action:t,payload:e,messageId:o},d=go(this,po,"f");return this.addWireListener(o,s,(t=>this.nackHandler(t,a,r)),n),d.send(c).catch(a)}));return Object.assign(s,{cancel:i,messageId:o})}nackHandler(t,e,n){e("string"==typeof t?t:new _o.RuntimeError(t,n))}ferryAction(t){return new Promise(((e,n)=>{const i=this.environment.getNextMessageId();t.messageId=i;const r=t=>{e(t.payload)};return go(this,po,"f").send(t).then((()=>this.addWireListener(i,r,(t=>this.nackHandler(t,n)),!1))).catch(n)}))}registerMessageHandler(t){this.messageHandlers.push(t)}addWireListener(t,e,n,i){i?this.uncorrelatedListener=e:this.wireListeners.has(t)?n({reason:"Duplicate handler id",error:(0,Io.errorToPOJO)(new _o.DuplicateCorrelationError(String(t)))}):this.wireListeners.set(t,{resolve:e,handleNack:n})}onmessage(t){for(const e of this.messageHandlers)e.call(null,t)}handleMessage(t){const e=t.correlationId||NaN;if("correlationId"in t){if(!this.wireListeners.has(e))return!1;{const{resolve:n,handleNack:i}=this.wireListeners.get(e);"ack"!==t.action?i({reason:"Did not receive ack action",error:(0,Io.errorToPOJO)(new _o.NoAckError(t.action))}):"payload"in t?t.payload.success?n.call(null,t):i(t.payload):"string"==typeof t.reason?i(t):(console.warn("Received invalid response from core",t),i({reason:"invalid response shape"})),this.wireListeners.delete(e)}}else this.uncorrelatedListener&&this.uncorrelatedListener.call(null,t),this.uncorrelatedListener=()=>{};return!0}}wo=Xr.Transport=Eo,po=new WeakMap,fo=new WeakMap;const xo=(...t)=>({log:(...e)=>console.log(`[${(new Date).toISOString()}]`,...(t=>t.map((t=>`[${t}]`)))(t),...e),getLogger:(...e)=>xo(...t,...e)}),So=xo("[@openfin/core-web/client");function Ao(t,e){if(!function(t){return"string"==typeof t}(t))throw new Error(`Property ${e} has invalid type. Expected string, got ${typeof t}.`)}const Po=So.getLogger("get-web-interop-ports");function Mo(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}function Lo(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n}"function"==typeof SuppressedError&&SuppressedError;const Ro=t=>{var e,n,i;return i=class extends r.EventEmitter{constructor(i){super(),e.set(this,void 0),n.set(this,!1),this.connectSync=()=>{Mo(this,n,"f")||(t.addEventListener("message",(t=>{t.data?.topic?.startsWith("wire-message")&&t.data.message&&Mo(this,e,"f").call(this,{...JSON.parse(t.data.message),ports:t.ports})})),t.start())},this.connect=async()=>{this.connectSync()},this.send=e=>(t.postMessage({topic:"wire-message",message:JSON.stringify(e)}),Promise.resolve()),this.shutdown=async()=>{t.close()},Lo(this,e,i,"f")}getPort(){return t}},e=new WeakMap,n=new WeakMap,i};var Oo={},To={};Object.defineProperty(To,"__esModule",{value:!0}),To.BaseEnvironment=void 0;const ko=mr();To.BaseEnvironment=class{async getInteropInfo(t){const e=await t.Application.getCurrentSync().getInfo().catch((()=>null)),n=e?.initialOptions?.interopBrokerConfiguration??{};return{fdc3Version:e?(0,ko.getDefaultViewFdc3VersionFromAppInfo)(e):void 0,...n,fdc3Info:{providerVersion:await t.System.getVersion(),provider:"OpenFin"}}}},Object.defineProperty(Oo,"__esModule",{value:!0});var zo=Oo.BrowserEnvironment=void 0;const Bo=To;class Fo extends Bo.BaseEnvironment{constructor(){super(...arguments),this.type="other",this.getRandomId=()=>{const t=new Uint32Array(1);return window.crypto.getRandomValues(t)[0].toString(32)}}getAdapterVersionSync(){return""}observeBounds(t,e){throw new Error("Method not implemented.")}layoutAllowedInContext(t){return!1}initLayoutManager(t,e,n){throw new Error("Method not implemented.")}applyLayoutSnapshot(t,e,n){throw new Error("Method not implemented.")}createLayout(t,e){throw new Error("Method not implemented.")}destroyLayout(t,e){throw new Error("Method not implemented.")}resolveLayout(t,e){throw new Error("Method not implemented.")}initPlatform(...t){throw new Error("Method not implemented.")}writeToken(t,e){return Promise.resolve("")}retrievePort(t){throw new Error("Method not implemented.")}getNextMessageId(){return this.getRandomId()}createChildContent(t){throw new Error("Method not implemented.")}getWebWindow(t){throw new Error("Method not implemented.")}getCurrentEntityIdentity(){throw new Error("Method not implemented.")}getCurrentEntityType(){return"external connection"}raiseEvent(t,e){throw new Error("Method not implemented.")}getUrl(){return location.href}getDefaultChannelOptions(){return{create:{},connect:{}}}getRtcPeer(){return new RTCPeerConnection}getWsConstructor(){return WebSocket}whenReady(){return Promise.resolve()}}zo=Oo.BrowserEnvironment=Fo;const Do=t=>"platform"in t&&void 0!==t.platform;var Uo,jo;class Wo extends zo{constructor(t){super(),this.connectConfig=t,Uo.set(this,void 0),jo.set(this,new $((async()=>Promise.resolve().then((function(){return n(825)}))))),Do(t)&&this.validatePlatformOptions(t)}getAdapterVersionSync(){return"0.38.64"}validatePlatformOptions({platform:t}){if(!("layoutSnapshot"in t))throw new Error("Platform options are missing layoutSnapshot. Please provide a layoutSnapshot in the platform options.");if("windows"in t||"windows"in t.layoutSnapshot)throw new Error("It appears you tried to call connect() with a snapshot object from an OpenFin desktop environment. Note that connect() expects to be called with a platform property with this structure: { platform: { layoutSnapshot } }. To get a layoutSnapshot of the expected structure, use fin.Platform.Layout.getCurrentLayoutManagerSync().getLayoutSnapshot() in v34+ in your desktop environment.");const{layouts:e}=t.layoutSnapshot;Object.entries(e).map((([t,e])=>{if("object"!=typeof e||null===e)throw new Error(`Invalid layout detected: layoutSnapshot.layouts.${t} must be an object.`);if(!("content"in e))throw new Error(`Invalid layout detected: layoutSnapshot.layouts.${t} must contain a 'content' property.`)}))}async getInteropInfo(t){return{contextGroups:void 0,logging:{beforeAction:{enabled:!1},afterAction:{enabled:!1}},fdc3Version:void 0,fdc3Info:{providerVersion:"0.38.64",provider:"OpenFin Web"}}}layoutAllowedInContext(t){return!0}async initLayoutManager(t,e,n){if(Mo(this,Uo,"f"))throw new Error("Layout already initialized.");if(!Do(this.connectConfig))throw new Error("Platform options are missing from connection config.");const{WebLayoutEntryPoint:i}=await Mo(this,jo,"f").getValue();return Lo(this,Uo,new i(this.connectConfig),"f"),await Mo(this,Uo,"f").initLayoutManager(t,e,n)}async applyLayoutSnapshot(t,e,n){Mo(this,Uo,"f")?.applyLayoutSnapshot(t,e,n)}async createLayout(t,e){return Mo(this,Uo,"f")?.createLayout(t,e)}async destroyLayout(t,e){return Mo(this,Uo,"f")?.destroyLayout(t,e)}}Uo=new WeakMap,jo=new WeakMap;const $o=()=>{const t=s.v4();return{uuid:t,name:t}};e.__classPrivateFieldGet=Mo,e.__classPrivateFieldSet=Lo,e.commonjsGlobal=c,e.connect=async t=>{try{So.log("Establishing connection",t);const{brokerUrl:e,identity:n,timeout:r,interopConfig:o}=await(async t=>{if("enabled"===t.connectionInheritance){const e=await(async t=>{const e=(()=>{const t=((t,e)=>{const n=new RegExp("^of-frame<(?<meta>.*)>$").exec(t)?.groups?.meta;if(n)try{return JSON.parse(atob(n))}catch(t){throw new Error(`Failed to decode JSON from ${n}.`)}})(window.name);if(t)try{const{name:e,uuid:n,brokerUrl:i,providerId:r,contextGroup:o}=t;return Ao(i,"brokerUrl"),Ao(n,"uuid"),Ao(e,"name"),{identity:{name:e,uuid:n},brokerUrl:i,interopConfig:{providerId:r,currentContextGroup:o}}}catch(t){throw new Error(`Unexpected error occurred when inferring platform information: ${t.stack}`)}})();if(e){const{validateOptions:n=()=>!0}=t,{identity:i,...r}=e;if(!await n(r))throw new Error("Parent options were rejected by validateOptions.");return e}})(t);if(e)return e}if(!t.options){const e="enabled"===t.connectionInheritance?"Broker URL was not specified nor provided by a platform container.":"Connection inheritance is disabled but no options were provided.";throw new Error(e)}return{...t.options,identity:$o()}})(t),{workerPort:s,iframeBrokerPort:c}=await(async(t,e,n)=>{const{origin:i}=new URL(t),r=document.createElement("IFRAME");let o;r.style.display="none";try{return await new Promise(((s,c)=>{const d=t=>{if(t.source===r.contentWindow&&"ack-web-broker-ports-ready"===t.data?.topic){if(t.origin!==i)c(new Error(`Broker redirected to unexpected origin ${t.origin}, expected ${i}.`));else if(t.data.success){const[e,n]=t.ports;s({iframeBrokerPort:e,workerPort:n})}else c(new _(t.data));window.removeEventListener("message",d),clearTimeout(o)}};window.addEventListener("message",d),Po.log(`Connecting to broker ${t}`),r.setAttribute("src",t),r.setAttribute("name",a(e,"of-broker")),document.body.appendChild(r),Po.log("Iframe loaded, awaiting init message from iframe"),n&&(o=setTimeout((()=>{window.removeEventListener("message",d),document.body.removeChild(r),c(new Error("Worker did not initialize in time"))}),n))}))}catch(t){throw new Error(`Failed to initialise Fin Web Client. ${t.message}`,{cause:t})}})(e,n,r);So.log("Successfully established connection to shared worker");const d={entityType:"external connection",...n};s.start(),c.start();const l=((t,e,n)=>{const r=Ro(e),o=new Wo(t),s=new wo(r,o,n);return s.connectSync(),window.Buffer=i.Buffer,new Br(s)})(t,s,d);return o?.providerId&&(l.me.interop=l.Interop.connectSync(o.providerId),o?.currentContextGroup&&l.me.interop.joinContextGroup(o.currentContextGroup).catch((t=>{console.warn(`Error joining specified context group: ${o?.currentContextGroup}, continuing`,t)}))),{...l,me:{...l.me,identity:{uuid:l.me.uuid,name:l.me.name}}}}catch(t){throw new Error(`An error occured during web-interop connection: ${t.message}`)}},e.encodeOptions=a},991:(t,e)=>{e.byteLength=function(t){var e=a(t),n=e[0],i=e[1];return 3*(n+i)/4-i},e.toByteArray=function(t){var e,n,o=a(t),s=o[0],c=o[1],d=new r(function(t,e,n){return 3*(e+n)/4-n}(0,s,c)),l=0,h=c>0?s-4:s;for(n=0;n<h;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],d[l++]=e>>16&255,d[l++]=e>>8&255,d[l++]=255&e;return 2===c&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,d[l++]=255&e),1===c&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,d[l++]=e>>8&255,d[l++]=255&e),d},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,o=[],s=16383,a=0,d=i-r;a<d;a+=s)o.push(c(t,a,a+s>d?d:a+s));return 1===r?(e=t[i-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),o.join("")};for(var n=[],i=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],i[o.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,i){for(var r,o,s=[],a=e;a<i;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},48:(t,e,n)=>{const i=n(991),r=n(318),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,c.prototype),e}function c(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return d(t,e,n)}function d(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!c.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|m(t,e);let i=a(n);const r=i.write(t,e);return r!==n&&(i=i.slice(0,r)),i}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return p(e.buffer,e.byteOffset,e.byteLength)}return u(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return p(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return p(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return c.from(i,e,n);const r=function(t){if(c.isBuffer(t)){const e=0|f(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||J(t.length)?a(0):u(t):"Buffer"===t.type&&Array.isArray(t.data)?u(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return c.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return l(t),a(t<0?0:0|f(t))}function u(t){const e=t.length<0?0:0|f(t.length),n=a(e);for(let i=0;i<e;i+=1)n[i]=255&t[i];return n}function p(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(i,c.prototype),i}function f(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function m(t,e){if(c.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;let r=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(t).length;default:if(r)return i?-1:V(t).length;e=(""+e).toLowerCase(),r=!0}}function g(t,e,n){let i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return L(this,e,n);case"utf8":case"utf-8":return S(this,e,n);case"ascii":return P(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function w(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function y(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=c.from(e,i)),c.isBuffer(e))return 0===e.length?-1:v(t,e,n,i,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,i,r){let o,s=1,a=t.length,c=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function d(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){let i=-1;for(o=n;o<a;o++)if(d(t,o)===d(e,-1===i?0:o-i)){if(-1===i&&(i=o),o-i+1===c)return i*s}else-1!==i&&(o-=o-i),i=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){let n=!0;for(let i=0;i<c;i++)if(d(t,o+i)!==d(e,i)){n=!1;break}if(n)return o}return-1}function _(t,e,n,i){n=Number(n)||0;const r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;const o=e.length;let s;for(i>o/2&&(i=o/2),s=0;s<i;++s){const i=parseInt(e.substr(2*s,2),16);if(J(i))return s;t[n+s]=i}return s}function C(t,e,n,i){return Z(V(e,t.length-n),t,n,i)}function b(t,e,n,i){return Z(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function I(t,e,n,i){return Z(q(e),t,n,i)}function E(t,e,n,i){return Z(function(t,e){let n,i,r;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),i=n>>8,r=n%256,o.push(r),o.push(i);return o}(e,t.length-n),t,n,i)}function x(t,e,n){return 0===e&&n===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,n))}function S(t,e,n){n=Math.min(t.length,n);const i=[];let r=e;for(;r<n;){const e=t[r];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(r+s<=n){let n,i,a,c;switch(s){case 1:e<128&&(o=e);break;case 2:n=t[r+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(o=c));break;case 3:n=t[r+1],i=t[r+2],128==(192&n)&&128==(192&i)&&(c=(15&e)<<12|(63&n)<<6|63&i,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:n=t[r+1],i=t[r+2],a=t[r+3],128==(192&n)&&128==(192&i)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&i)<<6|63&a,c>65535&&c<1114112&&(o=c))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,i.push(o>>>10&1023|55296),o=56320|1023&o),i.push(o),r+=s}return function(t){const e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);let n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=A));return n}(i)}e.kMaxLength=s,c.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(t,e,n){return d(t,e,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(t,e,n){return function(t,e,n){return l(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},c.allocUnsafe=function(t){return h(t)},c.allocUnsafeSlow=function(t){return h(t)},c.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==c.prototype},c.compare=function(t,e){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let r=0,o=Math.min(n,i);r<o;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const i=c.allocUnsafe(e);let r=0;for(n=0;n<t.length;++n){let e=t[n];if(Y(e,Uint8Array))r+e.length>i.length?(c.isBuffer(e)||(e=c.from(e)),e.copy(i,r)):Uint8Array.prototype.set.call(i,e,r);else{if(!c.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(i,r)}r+=e.length}return i},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)w(this,e,e+1);return this},c.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},c.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},c.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?S(this,0,t):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(c.prototype[o]=c.prototype.inspect),c.prototype.compare=function(t,e,n,i,r){if(Y(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;let o=(r>>>=0)-(i>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(o,s),d=this.slice(i,r),l=t.slice(e,n);for(let t=0;t<a;++t)if(d[t]!==l[t]){o=d[t],s=l[t];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},c.prototype.indexOf=function(t,e,n){return y(this,t,e,n,!0)},c.prototype.lastIndexOf=function(t,e,n){return y(this,t,e,n,!1)},c.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}const r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let o=!1;for(;;)switch(i){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return C(this,t,e,n);case"ascii":case"latin1":case"binary":return b(this,t,e,n);case"base64":return I(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function P(t,e,n){let i="";n=Math.min(t.length,n);for(let r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function M(t,e,n){let i="";n=Math.min(t.length,n);for(let r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function L(t,e,n){const i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);let r="";for(let i=e;i<n;++i)r+=K[t[i]];return r}function R(t,e,n){const i=t.slice(e,n);let r="";for(let t=0;t<i.length-1;t+=2)r+=String.fromCharCode(i[t]+256*i[t+1]);return r}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,n,i,r,o){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<o)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function k(t,e,n,i,r){$(e,i,r,t,n,7);let o=Number(e&BigInt(4294967295));t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function z(t,e,n,i,r){$(e,i,r,t,n,7);let o=Number(e&BigInt(4294967295));t[n+7]=o,o>>=8,t[n+6]=o,o>>=8,t[n+5]=o,o>>=8,t[n+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function B(t,e,n,i,r,o){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,i,o){return e=+e,n>>>=0,o||B(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function D(t,e,n,i,o){return e=+e,n>>>=0,o||B(t,0,n,8),r.write(t,e,n,i,52,8),n+8}c.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const i=this.subarray(t,e);return Object.setPrototypeOf(i,c.prototype),i},c.prototype.readUintLE=c.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let i=this[t],r=1,o=0;for(;++o<e&&(r*=256);)i+=this[t+o]*r;return i},c.prototype.readUintBE=c.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let i=this[t+--e],r=1;for(;e>0&&(r*=256);)i+=this[t+--e]*r;return i},c.prototype.readUint8=c.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readBigUInt64LE=X((function(t){H(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||N(t,this.length-8);const i=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,r=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(i)+(BigInt(r)<<BigInt(32))})),c.prototype.readBigUInt64BE=X((function(t){H(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||N(t,this.length-8);const i=e*2**24+65536*this[++t]+256*this[++t]+this[++t],r=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(i)<<BigInt(32))+BigInt(r)})),c.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let i=this[t],r=1,o=0;for(;++o<e&&(r*=256);)i+=this[t+o]*r;return r*=128,i>=r&&(i-=Math.pow(2,8*e)),i},c.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let i=e,r=1,o=this[t+--i];for(;i>0&&(r*=256);)o+=this[t+--i]*r;return r*=128,o>=r&&(o-=Math.pow(2,8*e)),o},c.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readBigInt64LE=X((function(t){H(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||N(t,this.length-8);const i=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),c.prototype.readBigInt64BE=X((function(t){H(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||N(t,this.length-8);const i=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),c.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),r.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),r.read(this,t,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(t,e,n,i){t=+t,e>>>=0,n>>>=0,i||T(this,t,e,n,Math.pow(2,8*n)-1,0);let r=1,o=0;for(this[e]=255&t;++o<n&&(r*=256);)this[e+o]=t/r&255;return e+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(t,e,n,i){t=+t,e>>>=0,n>>>=0,i||T(this,t,e,n,Math.pow(2,8*n)-1,0);let r=n-1,o=1;for(this[e+r]=255&t;--r>=0&&(o*=256);)this[e+r]=t/o&255;return e+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,255,0),this[e]=255&t,e+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigUInt64LE=X((function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=X((function(t,e=0){return z(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*n-1);T(this,t,e,n,i-1,-i)}let r=0,o=1,s=0;for(this[e]=255&t;++r<n&&(o*=256);)t<0&&0===s&&0!==this[e+r-1]&&(s=1),this[e+r]=(t/o|0)-s&255;return e+n},c.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*n-1);T(this,t,e,n,i-1,-i)}let r=n-1,o=1,s=0;for(this[e+r]=255&t;--r>=0&&(o*=256);)t<0&&0===s&&0!==this[e+r+1]&&(s=1),this[e+r]=(t/o|0)-s&255;return e+n},c.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},c.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},c.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},c.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},c.prototype.writeBigInt64LE=X((function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=X((function(t,e=0){return z(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},c.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},c.prototype.writeDoubleLE=function(t,e,n){return D(this,t,e,!0,n)},c.prototype.writeDoubleBE=function(t,e,n){return D(this,t,e,!1,n)},c.prototype.copy=function(t,e,n,i){if(!c.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);const r=i-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),r},c.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){const e=t.charCodeAt(0);("utf8"===i&&e<128||"latin1"===i)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let r;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(r=e;r<n;++r)this[r]=t;else{const o=c.isBuffer(t)?t:c.from(t,i),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(r=0;r<n-e;++r)this[r+e]=o[r%s]}return this};const U={};function j(t,e,n){U[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function W(t){let e="",n=t.length;const i="-"===t[0]?1:0;for(;n>=i+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function $(t,e,n,i,r,o){if(t>n||t<e){const i="bigint"==typeof e?"n":"";let r;throw r=o>3?0===e||e===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(o+1)}${i}`:`>= -(2${i} ** ${8*(o+1)-1}${i}) and < 2 ** ${8*(o+1)-1}${i}`:`>= ${e}${i} and <= ${n}${i}`,new U.ERR_OUT_OF_RANGE("value",r,t)}!function(t,e,n){H(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||N(e,t.length-(n+1))}(i,r,o)}function H(t,e){if("number"!=typeof t)throw new U.ERR_INVALID_ARG_TYPE(e,"number",t)}function N(t,e,n){if(Math.floor(t)!==t)throw H(t,n),new U.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new U.ERR_BUFFER_OUT_OF_BOUNDS;throw new U.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(t,e,n){let i=`The value of "${t}" is out of range.`,r=n;return Number.isInteger(n)&&Math.abs(n)>2**32?r=W(String(n)):"bigint"==typeof n&&(r=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(r=W(r)),r+="n"),i+=` It must be ${e}. Received ${r}`,i}),RangeError);const G=/[^+/0-9A-Za-z-_]/g;function V(t,e){let n;e=e||1/0;const i=t.length;let r=null;const o=[];for(let s=0;s<i;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&o.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(t){return i.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Z(t,e,n,i){let r;for(r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function J(t){return t!=t}const K=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const i=16*n;for(let r=0;r<16;++r)e[i+r]=t[n]+t[r]}return e}();function X(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}},46:t=>{var e,n="object"==typeof Reflect?Reflect:null,i=n&&"function"==typeof n.apply?n.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};e=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function o(){o.init.call(this)}t.exports=o,t.exports.once=function(t,e){return new Promise((function(n,i){function r(n){t.removeListener(e,o),i(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",r),n([].slice.call(arguments))}m(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&m(t,"error",e,{once:!0})}(t,r)}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function c(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function d(t,e,n,i){var r,o,s,d;if(a(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(r=c(t))>0&&s.length>r&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,d=l,console&&console.warn&&console.warn(d)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function u(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):f(r,r.length)}function p(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function m(t,e,n,i){if("function"==typeof t.on)i.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(o){i.once&&t.removeEventListener(e,r),n(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");s=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return c(this)},o.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[t];if(void 0===c)return!1;if("function"==typeof c)i(c,this,e);else{var d=c.length,l=f(c,d);for(n=0;n<d;++n)i(l[n],this,e)}return!0},o.prototype.addListener=function(t,e){return d(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return d(this,t,e,!0)},o.prototype.once=function(t,e){return a(e),this.on(t,h(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return a(e),this.prependListener(t,h(this,t,e)),this},o.prototype.removeListener=function(t,e){var n,i,r,o,s;if(a(e),void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},o.prototype.listeners=function(t){return u(this,t,!0)},o.prototype.rawListeners=function(t){return u(this,t,!1)},o.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},299:(t,e,n)=>{n.r(e),n.d(e,{ApiError:()=>s,BindError:()=>a,BrowserPopout:()=>it,ComponentContainer:()=>nt,ComponentItem:()=>ot,ComponentItemConfig:()=>F,ConfigurationError:()=>r,ContentItem:()=>rt,DragSource:()=>wt,EventEmitter:()=>et,EventHub:()=>_t,ExternalError:()=>i,GoldenLayout:()=>It,Header:()=>ft,HeaderedItemConfig:()=>z,I18nStrings:()=>p,ItemConfig:()=>k,ItemType:()=>C,JsonValue:()=>_,LayoutConfig:()=>j,LayoutManager:()=>Ct,LogicalZIndex:()=>y,LogicalZIndexToDefaultMap:()=>v,PopoutBlockedError:()=>o,PopoutLayoutConfig:()=>W,ResolvedComponentItemConfig:()=>P,ResolvedGroundItemConfig:()=>R,ResolvedHeaderedItemConfig:()=>S,ResolvedItemConfig:()=>x,ResolvedLayoutConfig:()=>O,ResolvedPopoutLayoutConfig:()=>T,ResolvedRootItemConfig:()=>L,ResolvedRowOrColumnItemConfig:()=>M,ResolvedStackItemConfig:()=>A,ResponsiveMode:()=>b,RootItemConfig:()=>U,RowOrColumn:()=>dt,RowOrColumnItemConfig:()=>D,Side:()=>w,SizeUnitEnum:()=>I,Stack:()=>mt,StackItemConfig:()=>B,StyleConstants:()=>m,Tab:()=>ut,VirtualLayout:()=>bt,WidthOrHeightPropertyName:()=>g,formatSize:()=>Q,formatUndefinableSize:()=>tt,i18nStrings:()=>f,parseSize:()=>X});class i extends Error{constructor(t,e){super(e),this.type=t}}class r extends i{constructor(t,e){super("Configuration",t),this.node=e}}class o extends i{constructor(t){super("PopoutBlocked",t)}}class s extends i{constructor(t){super("API",t)}}class a extends i{constructor(t){super("Bind",t)}}class c extends Error{constructor(t,e,n){super(`${t}: ${e}${void 0===n?"":": "+n}`)}}class d extends c{constructor(t,e){super("Assert",t,e)}}class l extends c{constructor(t,e,n){super("UnreachableCase",t,`${e}${void 0===n?"":": "+n}`)}}class h extends c{constructor(t,e){super("UnexpectedNull",t,e)}}class u extends c{constructor(t,e){super("UnexpectedUndefined",t,e)}}var p;!function(t){let e=!1;const n={PopoutCannotBeCreatedWithGroundItemConfig:{id:0,default:"Popout cannot be created with ground ItemConfig"},PleaseRegisterAConstructorFunction:{id:1,default:"Please register a constructor function"},ComponentTypeNotRegisteredAndBindComponentEventHandlerNotAssigned:{id:2,default:"Component type not registered and BindComponentEvent handler not assigned"},ComponentIsAlreadyRegistered:{id:3,default:"Component is already registered"},ComponentIsNotVirtuable:{id:4,default:"Component is not virtuable. Requires rootHtmlElement field/getter"},VirtualComponentDoesNotHaveRootHtmlElement:{id:5,default:'Virtual component does not have getter "rootHtmlElement"'},ItemConfigIsNotTypeComponent:{id:6,default:"ItemConfig is not of type component"},InvalidNumberPartInSizeString:{id:7,default:"Invalid number part in size string"},UnknownUnitInSizeString:{id:8,default:"Unknown unit in size string"},UnsupportedUnitInSizeString:{id:9,default:"Unsupported unit in size string"}};t.idCount=Object.keys(n).length;const i=Object.values(n);t.checkInitialise=function(){if(!e)for(let e=0;e<t.idCount;e++){const t=i[e];if(t.id!==e)throw new d("INSI00110",`${e}: ${t.id}`);f[e]=t.default}e=!0}}(p||(p={}));const f=new Array(p.idCount);var m,g,w,y;!function(t){t.defaultComponentBaseZIndex="auto",t.defaultComponentDragZIndex="32",t.defaultComponentStackMaximisedZIndex="41"}(m||(m={})),function(t){t.width="width",t.height="height"}(g||(g={})),function(t){t.top="top",t.left="left",t.right="right",t.bottom="bottom"}(w||(w={})),function(t){t.base="base",t.drag="drag",t.stackMaximised="stackMaximised"}(y||(y={}));const v={base:m.defaultComponentBaseZIndex,drag:m.defaultComponentDragZIndex,stackMaximised:m.defaultComponentStackMaximisedZIndex};var _,C,b,I,E,x,S,A,P,M,L,R,O,T,k,z,B,F,D,U,j,W;function $(t){return t.toString(10)+"px"}function H(t){const e=t.replace("px","");return parseFloat(e)}function N(t){return t>="0"&&t<="9"}function G(t,e){const n=$(e);t.style.width=n}function V(t,e){const n=$(e);t.style.height=n}function q(t){return{width:t.offsetWidth,height:t.offsetHeight}}function Z(t,e){t.style.display=e?"":"none"}function Y(t,e){if(void 0!==e)for(const n in e)if(e.hasOwnProperty(n)){const i=e[n],r=t[n];t[n]=J(r,i)}return t}function J(t,e){if("object"!=typeof e)return e;if(Array.isArray(e)){const t=e.length,n=new Array(t);for(let i=0;i<t;i++){const t=e[i];n[i]=J({},t)}return n}if(null===e)return null;{const n=e;return void 0===t||("object"!=typeof t||Array.isArray(t))?Y({},n):Y(null===t?{}:t,n)}}function K(){return(1e15*Math.random()).toString(36).replace(".","")}function X(t,e){const{numericPart:n,firstNonNumericCharPart:i}=function(t){const e=(t=t.trimStart()).length;if(0===e)return{numericPart:"",firstNonNumericCharPart:""};{let n=e,i=!1;for(let r=0;r<e;r++){const e=t[r];if(!N(e)){if("."!==e){n=r;break}if(i){n=r;break}i=!0}}return{numericPart:t.substring(0,n),firstNonNumericCharPart:t.substring(n).trim()}}}(t),o=Number.parseInt(n,10);if(isNaN(o))throw new r(`${f[7]}: ${t}`);{const n=I.tryParse(i);if(void 0===n)throw new r(`${f[8]}: ${t}`);if(e.includes(n))return{size:o,sizeUnit:n};throw new r(`${f[9]}: ${t}`)}}function Q(t,e){return t.toString(10)+I.format(e)}function tt(t,e){return void 0===t?void 0:t.toString(10)+I.format(e)}!function(t){function e(t){return!Array.isArray(t)&&null!==t&&"object"==typeof t}t.isJson=function(t){return e(t)},t.isJsonObject=e}(_||(_={})),function(t){t.ground="ground",t.row="row",t.column="column",t.stack="stack",t.component="component"}(C||(C={})),function(t){t.none="none",t.always="always",t.onload="onload"}(b||(b={})),function(t){t.Pixel="px",t.Percent="%",t.Fractional="fr",t.Em="em"}(I||(I={})),function(t){t.tryParse=function(e){switch(e){case t.Pixel:return t.Pixel;case t.Percent:return t.Percent;case t.Fractional:return t.Fractional;case t.Em:return t.Em;default:return}},t.format=function(e){switch(e){case t.Pixel:return t.Pixel;case t.Percent:return t.Percent;case t.Fractional:return t.Fractional;case t.Em:return t.Em;default:throw new l("SUEF44998",e)}}}(I||(I={})),function(t){const e=["settings","hasHeaders","constrainDragToContainer","selectionEnabled","dimensions","borderWidth","minItemHeight","minItemWidth","headerHeight","dragProxyWidth","dragProxyHeight","labels","close","maximise","minimise","popout","content","componentType","componentState","id","width","type","height","isClosable","title","popoutWholeStack","openPopouts","parentId","activeItemIndex","reorderEnabled","borderGrabWidth"],n=[!0,!1,"row","column","stack","component","close","maximise","minimise","open in new window"];function i(t,e){const n={};for(const i in t)if(t.hasOwnProperty(i)){let a;a=e?o(i):s(i);const c=t[i];n[a]=r(c,e)}return n}function r(t,e){return"object"==typeof t?null===t?null:Array.isArray(t)?function(t,e){const n=t.length,i=new Array(n);for(let o=0;o<n;o++){const n=t[o];i[o]=r(n,e)}return i}(t,e):i(t,e):e?function(t){if("string"==typeof t&&1===t.length)return"___"+t;const e=function(t){for(let e=0;e<n.length;e++)if(n[e]===t)return e;return-1}(t);return-1===e?t:e.toString(36)}(t):"string"==typeof(o=t)&&1===o.length?n[parseInt(o,36)]:"string"==typeof o&&"___"===o.substr(0,3)?o[3]:o;var o}function o(t){if("string"==typeof t&&1===t.length)return"___"+t;const n=function(t){for(let n=0;n<e.length;n++)if(e[n]===t)return n;return-1}(t);return-1===n?t:n.toString(36)}function s(t){return 1===t.length?e[parseInt(t,36)]:"___"===t.substr(0,3)?t[3]:t}t.checkInitialise=function(){if(e.length>36)throw new Error("Too many keys in config minifier map")},t.translateObject=i}(E||(E={})),function(t){t.defaults={type:C.ground,content:[],size:1,sizeUnit:I.Fractional,minSize:void 0,minSizeUnit:I.Pixel,id:"",isClosable:!0},t.createCopy=function(t,e){switch(t.type){case C.ground:case C.row:case C.column:return M.createCopy(t,e);case C.stack:return A.createCopy(t,e);case C.component:return P.createCopy(t);default:throw new l("CICC91354",t.type,"Invalid Config Item type specified")}},t.createDefault=function(t){switch(t){case C.ground:throw new d("CICCDR91562");case C.row:case C.column:return M.createDefault(t);case C.stack:return A.createDefault();case C.component:return P.createDefault();default:throw new l("CICCDD91563",t,"Invalid Config Item type specified")}},t.isComponentItem=function(t){return t.type===C.component},t.isStackItem=function(t){return t.type===C.stack},t.isGroundItem=function(t){return t.type===C.ground}}(x||(x={})),function(t){let e;t.defaultMaximised=!1,function(t){t.createCopy=function(t,e){return void 0===t?void 0:{show:null!=e?e:t.show,popout:t.popout,close:t.close,maximise:t.maximise,minimise:t.minimise,tabDropdown:t.tabDropdown}}}(e=t.Header||(t.Header={}))}(S||(S={})),function(t){function e(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++)n[i]=x.createCopy(t[i]);return n}t.defaultActiveItemIndex=0,t.createCopy=function(t,n){return{type:t.type,content:e(void 0!==n?n:t.content),size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:t.activeItemIndex,header:S.Header.createCopy(t.header)}},t.copyContent=e,t.createDefault=function(){return{type:C.stack,content:[],size:x.defaults.size,sizeUnit:x.defaults.sizeUnit,minSize:x.defaults.minSize,minSizeUnit:x.defaults.minSizeUnit,id:x.defaults.id,maximised:S.defaultMaximised,isClosable:x.defaults.isClosable,activeItemIndex:t.defaultActiveItemIndex,header:void 0}}}(A||(A={})),function(t){t.defaultReorderEnabled=!0,t.resolveComponentTypeName=function(t){const e=t.componentType;return"string"==typeof e?e:void 0},t.createCopy=function(t){return{type:t.type,content:[],size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,reorderEnabled:t.reorderEnabled,title:t.title,header:S.Header.createCopy(t.header),componentType:t.componentType,componentState:J(void 0,t.componentState)}},t.createDefault=function(e="",n,i=""){return{type:C.component,content:[],size:x.defaults.size,sizeUnit:x.defaults.sizeUnit,minSize:x.defaults.minSize,minSizeUnit:x.defaults.minSizeUnit,id:x.defaults.id,maximised:S.defaultMaximised,isClosable:x.defaults.isClosable,reorderEnabled:t.defaultReorderEnabled,title:i,header:void 0,componentType:e,componentState:n}},t.copyComponentType=function(t){return J({},t)}}(P||(P={})),function(t){function e(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++)n[i]=x.createCopy(t[i]);return n}t.isChildItemConfig=function(t){switch(t.type){case C.row:case C.column:case C.stack:case C.component:return!0;case C.ground:return!1;default:throw new l("CROCOSPCICIC13687",t.type)}},t.createCopy=function(t,n){return{type:t.type,content:e(void 0!==n?n:t.content),size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,isClosable:t.isClosable}},t.copyContent=e,t.createDefault=function(t){return{type:t,content:[],size:x.defaults.size,sizeUnit:x.defaults.sizeUnit,minSize:x.defaults.minSize,minSizeUnit:x.defaults.minSizeUnit,id:x.defaults.id,isClosable:x.defaults.isClosable}}}(M||(M={})),function(t){t.createCopy=function(t){return x.createCopy(t)},t.isRootItemConfig=function(t){switch(t.type){case C.row:case C.column:case C.stack:case C.component:return!0;case C.ground:return!1;default:throw new l("CROCOSPCICIC13687",t.type)}}}(L||(L={})),function(t){t.create=function(t){const e=void 0===t?[]:[t];return{type:C.ground,content:e,size:100,sizeUnit:I.Percent,minSize:0,minSizeUnit:I.Pixel,id:"",isClosable:!1,title:"",reorderEnabled:!1}}}(R||(R={})),function(t){let e,n,i;function r(t){return"parentId"in t}!function(t){t.defaults={constrainDragToContainer:!0,reorderEnabled:!0,popoutWholeStack:!1,blockedPopoutsThrowError:!0,closePopoutsOnUnload:!0,responsiveMode:b.none,tabOverlapAllowance:0,reorderOnTabMenuClick:!0,tabControlOffset:10,popInOnClose:!1},t.createCopy=function(t){return{constrainDragToContainer:t.constrainDragToContainer,reorderEnabled:t.reorderEnabled,popoutWholeStack:t.popoutWholeStack,blockedPopoutsThrowError:t.blockedPopoutsThrowError,closePopoutsOnUnload:t.closePopoutsOnUnload,responsiveMode:t.responsiveMode,tabOverlapAllowance:t.tabOverlapAllowance,reorderOnTabMenuClick:t.reorderOnTabMenuClick,tabControlOffset:t.tabControlOffset,popInOnClose:t.popInOnClose}}}(e=t.Settings||(t.Settings={})),function(t){t.createCopy=function(t){return{borderWidth:t.borderWidth,borderGrabWidth:t.borderGrabWidth,defaultMinItemHeight:t.defaultMinItemHeight,defaultMinItemHeightUnit:t.defaultMinItemHeightUnit,defaultMinItemWidth:t.defaultMinItemWidth,defaultMinItemWidthUnit:t.defaultMinItemWidthUnit,headerHeight:t.headerHeight,dragProxyWidth:t.dragProxyWidth,dragProxyHeight:t.dragProxyHeight}},t.defaults={borderWidth:5,borderGrabWidth:5,defaultMinItemHeight:0,defaultMinItemHeightUnit:I.Pixel,defaultMinItemWidth:10,defaultMinItemWidthUnit:I.Pixel,headerHeight:20,dragProxyWidth:300,dragProxyHeight:200}}(n=t.Dimensions||(t.Dimensions={})),function(t){t.createCopy=function(t){return{show:t.show,popout:t.popout,dock:t.dock,close:t.close,maximise:t.maximise,minimise:t.minimise,tabDropdown:t.tabDropdown}},t.defaults={show:w.top,popout:"open in new window",dock:"dock",maximise:"maximise",minimise:"minimise",close:"close",tabDropdown:"additional tabs"}}(i=t.Header||(t.Header={})),t.isPopout=r,t.createDefault=function(){return{root:void 0,openPopouts:[],dimensions:t.Dimensions.defaults,settings:t.Settings.defaults,header:t.Header.defaults,resolved:!0}},t.createCopy=function(e){return r(e)?T.createCopy(e):{root:void 0===e.root?void 0:L.createCopy(e.root),openPopouts:t.copyOpenPopouts(e.openPopouts),settings:t.Settings.createCopy(e.settings),dimensions:t.Dimensions.createCopy(e.dimensions),header:t.Header.createCopy(e.header),resolved:e.resolved}},t.copyOpenPopouts=function(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++)n[i]=T.createCopy(t[i]);return n},t.minifyConfig=function(t){return E.translateObject(t,!0)},t.unminifyConfig=function(t){return E.translateObject(t,!1)}}(O||(O={})),function(t){let e;!function(t){t.createCopy=function(t){return{width:t.width,height:t.height,left:t.left,top:t.top}},t.defaults={width:null,height:null,left:null,top:null}}(e=t.Window||(t.Window={})),t.createCopy=function(e){return{root:void 0===e.root?void 0:L.createCopy(e.root),openPopouts:O.copyOpenPopouts(e.openPopouts),settings:O.Settings.createCopy(e.settings),dimensions:O.Dimensions.createCopy(e.dimensions),header:O.Header.createCopy(e.header),parentId:e.parentId,indexInParent:e.indexInParent,window:t.Window.createCopy(e.window),resolved:e.resolved}}}(T||(T={})),function(t){t.resolve=function(t,e){switch(t.type){case C.ground:throw new r("ItemConfig cannot specify type ground",JSON.stringify(t));case C.row:case C.column:return D.resolve(t,e);case C.stack:return B.resolve(t,e);case C.component:return F.resolve(t,e);default:throw new l("UCUICR55499",t.type)}},t.resolveContent=function(e){if(void 0===e)return[];{const n=e.length,i=new Array(n);for(let r=0;r<n;r++)i[r]=t.resolve(e[r],!1);return i}},t.resolveId=function(t){return void 0===t?x.defaults.id:Array.isArray(t)?0===t.length?x.defaults.id:t[0]:t},t.resolveSize=function(t,e,n,i){if(void 0!==t)return X(t,[I.Percent,I.Fractional]);if(void 0!==e||void 0!==n){if(void 0!==e)return{size:e,sizeUnit:I.Percent};if(void 0!==n)return{size:n,sizeUnit:I.Percent};throw new u("CRS33390")}return i?{size:50,sizeUnit:I.Percent}:{size:x.defaults.size,sizeUnit:x.defaults.sizeUnit}},t.resolveMinSize=function(t,e,n){if(void 0!==t)return X(t,[I.Pixel]);{const t=void 0!==e;return t||void 0!==n?t?{size:e,sizeUnit:I.Pixel}:{size:n,sizeUnit:I.Pixel}:{size:x.defaults.minSize,sizeUnit:x.defaults.minSizeUnit}}},t.calculateSizeWidthHeightSpecificationType=function(t){return void 0!==t.size?1:void 0!==t.width||void 0!==t.height?2:0},t.isGround=function(t){return t.type===C.ground},t.isRow=function(t){return t.type===C.row},t.isColumn=function(t){return t.type===C.column},t.isStack=function(t){return t.type===C.stack},t.isComponent=function(t){return t.type===C.component}}(k||(k={})),function(t){let e;!function(t){t.resolve=function(t,e){var n;if(void 0!==t||void 0!==e)return{show:null!==(n=null==t?void 0:t.show)&&void 0!==n?n:void 0===e?void 0:!!e&&O.Header.defaults.show,popout:null==t?void 0:t.popout,maximise:null==t?void 0:t.maximise,close:null==t?void 0:t.close,minimise:null==t?void 0:t.minimise,tabDropdown:null==t?void 0:t.tabDropdown}}}(e=t.Header||(t.Header={})),t.resolveIdAndMaximised=function(t){let e,n,i=t.id,r=!1;if(void 0===i)e=x.defaults.id;else if(Array.isArray(i)){const t=i.findIndex((t=>"__glMaximised"===t));t>0&&(r=!0,i=i.splice(t,1)),e=i.length>0?i[0]:x.defaults.id}else e=i;return n=void 0!==t.maximised?t.maximised:r,{id:e,maximised:n}}}(z||(z={})),function(t){function e(t){if(void 0===t)return[];{const e=t.length,n=new Array(e);for(let i=0;i<e;i++){const e=t[i],r=k.resolve(e,!1);if(!x.isComponentItem(r))throw new d("UCUSICRC91114",JSON.stringify(r));n[i]=r}return n}}function n(t){const e=t.length,n=new Array(e);for(let i=0;i<e;i++){const e=t[i];n[i]=F.fromResolved(e)}return n}t.resolve=function(t,n){var i,r;const{id:o,maximised:s}=z.resolveIdAndMaximised(t),{size:a,sizeUnit:c}=k.resolveSize(t.size,t.width,t.height,n),{size:d,sizeUnit:l}=k.resolveMinSize(t.minSize,t.minWidth,t.minHeight);return{type:C.stack,content:e(t.content),size:a,sizeUnit:c,minSize:d,minSizeUnit:l,id:o,maximised:s,isClosable:null!==(i=t.isClosable)&&void 0!==i?i:x.defaults.isClosable,activeItemIndex:null!==(r=t.activeItemIndex)&&void 0!==r?r:A.defaultActiveItemIndex,header:z.Header.resolve(t.header,t.hasHeaders)}},t.fromResolved=function(t){return{type:C.stack,content:n(t.content),size:Q(t.size,t.sizeUnit),minSize:tt(t.minSize,t.minSizeUnit),id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:t.activeItemIndex,header:S.Header.createCopy(t.header)}}}(B||(B={})),function(t){t.resolve=function(e,n){var i,r,o;let s=e.componentType;if(void 0===s&&(s=e.componentName),void 0===s)throw new Error("ComponentItemConfig.componentType is undefined");{const{id:a,maximised:c}=z.resolveIdAndMaximised(e);let d;d=void 0===e.title||""===e.title?t.componentTypeToTitle(s):e.title;const{size:l,sizeUnit:h}=k.resolveSize(e.size,e.width,e.height,n),{size:u,sizeUnit:p}=k.resolveMinSize(e.minSize,e.minWidth,e.minHeight);return{type:e.type,content:[],size:l,sizeUnit:h,minSize:u,minSizeUnit:p,id:a,maximised:c,isClosable:null!==(i=e.isClosable)&&void 0!==i?i:x.defaults.isClosable,reorderEnabled:null!==(r=e.reorderEnabled)&&void 0!==r?r:P.defaultReorderEnabled,title:d,header:z.Header.resolve(e.header,e.hasHeaders),componentType:s,componentState:null!==(o=e.componentState)&&void 0!==o?o:{}}}},t.fromResolved=function(t){return{type:C.component,size:Q(t.size,t.sizeUnit),minSize:tt(t.minSize,t.minSizeUnit),id:t.id,maximised:t.maximised,isClosable:t.isClosable,reorderEnabled:t.reorderEnabled,title:t.title,header:S.Header.createCopy(t.header),componentType:t.componentType,componentState:J(void 0,t.componentState)}},t.componentTypeToTitle=function(t){switch(typeof t){case"string":return t;case"number":case"boolean":return t.toString();default:return""}}}(F||(F={})),function(t){function e(e){const n=e.length,i=new Array(n);for(let r=0;r<n;r++){const n=e[r],o=n.type;let s;switch(o){case C.row:case C.column:s=t.fromResolved(n);break;case C.stack:s=B.fromResolved(n);break;case C.component:s=F.fromResolved(n);break;default:throw new l("ROCICFRC44797",o)}i[r]=s}return i}t.isChildItemConfig=function(t){switch(t.type){case C.row:case C.column:case C.stack:case C.component:return!0;case C.ground:return!1;default:throw new l("UROCOSPCICIC13687",t.type)}},t.resolve=function(e,n){var i;const{size:r,sizeUnit:o}=k.resolveSize(e.size,e.width,e.height,n),{size:s,sizeUnit:a}=k.resolveMinSize(e.minSize,e.minWidth,e.minHeight);return{type:e.type,content:t.resolveContent(e.content),size:r,sizeUnit:o,minSize:s,minSizeUnit:a,id:k.resolveId(e.id),isClosable:null!==(i=e.isClosable)&&void 0!==i?i:x.defaults.isClosable}},t.fromResolved=function(t){return{type:t.type,content:e(t.content),size:Q(t.size,t.sizeUnit),minSize:tt(t.minSize,t.minSizeUnit),id:t.id,isClosable:t.isClosable}},t.resolveContent=function(e){if(void 0===e)return[];{const n=e.length,i=new Array(n);let o,s=!1,a=!1;for(let o=0;o<n;o++){const n=e[o];if(!t.isChildItemConfig(n))throw new r("ItemConfig is not Row, Column or Stack",n);if(!a){const t=k.calculateSizeWidthHeightSpecificationType(n);switch(t){case 0:break;case 2:s=!0;break;case 1:a=!0;break;default:throw new l("ROCICRC87556",t)}}i[o]=n}o=!a&&!!s;const c=new Array(n);for(let t=0;t<n;t++){const e=i[t],n=k.resolve(e,o);if(!M.isChildItemConfig(n))throw new d("UROCOSPIC99512",JSON.stringify(n));c[t]=n}return c}}}(D||(D={})),function(t){t.isRootItemConfig=function(t){switch(t.type){case C.row:case C.column:case C.stack:case C.component:return!0;case C.ground:return!1;default:throw new l("URICIR23687",t.type)}},t.resolve=function(t){if(void 0!==t){const e=k.resolve(t,!1);if(L.isRootItemConfig(e))return e;throw new r("ItemConfig is not Row, Column or Stack",JSON.stringify(t))}},t.fromResolvedOrUndefined=function(t){if(void 0!==t){const e=t.type;switch(e){case C.row:case C.column:return D.fromResolved(t);case C.stack:return B.fromResolved(t);case C.component:return F.fromResolved(t);default:throw new l("RICFROU89921",e)}}}}(U||(U={})),function(t){let e,n,i;function r(t){return"parentId"in t||"indexInParent"in t||"window"in t}!function(t){t.resolve=function(t){var e,n,i,r,o,s,a,c,d,l;return{constrainDragToContainer:null!==(e=null==t?void 0:t.constrainDragToContainer)&&void 0!==e?e:O.Settings.defaults.constrainDragToContainer,reorderEnabled:null!==(n=null==t?void 0:t.reorderEnabled)&&void 0!==n?n:O.Settings.defaults.reorderEnabled,popoutWholeStack:null!==(i=null==t?void 0:t.popoutWholeStack)&&void 0!==i?i:O.Settings.defaults.popoutWholeStack,blockedPopoutsThrowError:null!==(r=null==t?void 0:t.blockedPopoutsThrowError)&&void 0!==r?r:O.Settings.defaults.blockedPopoutsThrowError,closePopoutsOnUnload:null!==(o=null==t?void 0:t.closePopoutsOnUnload)&&void 0!==o?o:O.Settings.defaults.closePopoutsOnUnload,responsiveMode:null!==(s=null==t?void 0:t.responsiveMode)&&void 0!==s?s:O.Settings.defaults.responsiveMode,tabOverlapAllowance:null!==(a=null==t?void 0:t.tabOverlapAllowance)&&void 0!==a?a:O.Settings.defaults.tabOverlapAllowance,reorderOnTabMenuClick:null!==(c=null==t?void 0:t.reorderOnTabMenuClick)&&void 0!==c?c:O.Settings.defaults.reorderOnTabMenuClick,tabControlOffset:null!==(d=null==t?void 0:t.tabControlOffset)&&void 0!==d?d:O.Settings.defaults.tabControlOffset,popInOnClose:null!==(l=null==t?void 0:t.popInOnClose)&&void 0!==l?l:O.Settings.defaults.popInOnClose}}}(e=t.Settings||(t.Settings={})),function(t){t.resolve=function(e){var n,i,r,o,s;const{size:a,sizeUnit:c}=t.resolveDefaultMinItemHeight(e),{size:d,sizeUnit:l}=t.resolveDefaultMinItemWidth(e);return{borderWidth:null!==(n=null==e?void 0:e.borderWidth)&&void 0!==n?n:O.Dimensions.defaults.borderWidth,borderGrabWidth:null!==(i=null==e?void 0:e.borderGrabWidth)&&void 0!==i?i:O.Dimensions.defaults.borderGrabWidth,defaultMinItemHeight:a,defaultMinItemHeightUnit:c,defaultMinItemWidth:d,defaultMinItemWidthUnit:l,headerHeight:null!==(r=null==e?void 0:e.headerHeight)&&void 0!==r?r:O.Dimensions.defaults.headerHeight,dragProxyWidth:null!==(o=null==e?void 0:e.dragProxyWidth)&&void 0!==o?o:O.Dimensions.defaults.dragProxyWidth,dragProxyHeight:null!==(s=null==e?void 0:e.dragProxyHeight)&&void 0!==s?s:O.Dimensions.defaults.dragProxyHeight}},t.fromResolved=function(t){return{borderWidth:t.borderWidth,borderGrabWidth:t.borderGrabWidth,defaultMinItemHeight:Q(t.defaultMinItemHeight,t.defaultMinItemHeightUnit),defaultMinItemWidth:Q(t.defaultMinItemWidth,t.defaultMinItemWidthUnit),headerHeight:t.headerHeight,dragProxyWidth:t.dragProxyWidth,dragProxyHeight:t.dragProxyHeight}},t.resolveDefaultMinItemHeight=function(t){const e=null==t?void 0:t.defaultMinItemHeight;return void 0===e?{size:O.Dimensions.defaults.defaultMinItemHeight,sizeUnit:O.Dimensions.defaults.defaultMinItemHeightUnit}:X(e,[I.Pixel])},t.resolveDefaultMinItemWidth=function(t){const e=null==t?void 0:t.defaultMinItemWidth;return void 0===e?{size:O.Dimensions.defaults.defaultMinItemWidth,sizeUnit:O.Dimensions.defaults.defaultMinItemWidthUnit}:X(e,[I.Pixel])}}(n=t.Dimensions||(t.Dimensions={})),function(t){t.resolve=function(t,e,n){var i,r,o,s,a,c,d,l,h,u,p,f;let m;return m=void 0!==(null==t?void 0:t.show)?t.show:void 0!==e&&void 0!==e.hasHeaders?!!e.hasHeaders&&O.Header.defaults.show:O.Header.defaults.show,{show:m,popout:null!==(r=null!==(i=null==t?void 0:t.popout)&&void 0!==i?i:null==n?void 0:n.popout)&&void 0!==r?r:!1!==(null==e?void 0:e.showPopoutIcon)&&O.Header.defaults.popout,dock:null!==(s=null!==(o=null==t?void 0:t.popin)&&void 0!==o?o:null==n?void 0:n.popin)&&void 0!==s?s:O.Header.defaults.dock,maximise:null!==(c=null!==(a=null==t?void 0:t.maximise)&&void 0!==a?a:null==n?void 0:n.maximise)&&void 0!==c?c:!1!==(null==e?void 0:e.showMaximiseIcon)&&O.Header.defaults.maximise,close:null!==(l=null!==(d=null==t?void 0:t.close)&&void 0!==d?d:null==n?void 0:n.close)&&void 0!==l?l:!1!==(null==e?void 0:e.showCloseIcon)&&O.Header.defaults.close,minimise:null!==(u=null!==(h=null==t?void 0:t.minimise)&&void 0!==h?h:null==n?void 0:n.minimise)&&void 0!==u?u:O.Header.defaults.minimise,tabDropdown:null!==(f=null!==(p=null==t?void 0:t.tabDropdown)&&void 0!==p?p:null==n?void 0:n.tabDropdown)&&void 0!==f?f:O.Header.defaults.tabDropdown}}}(i=t.Header||(t.Header={})),t.isPopout=r,t.resolve=function(e){if(r(e))return W.resolve(e);{let n;return n=void 0!==e.root?e.root:void 0!==e.content&&e.content.length>0?e.content[0]:void 0,{resolved:!0,root:U.resolve(n),openPopouts:t.resolveOpenPopouts(e.openPopouts),dimensions:t.Dimensions.resolve(e.dimensions),settings:t.Settings.resolve(e.settings),header:t.Header.resolve(e.header,e.settings,e.labels)}}},t.fromResolved=function(e){return{root:U.fromResolvedOrUndefined(e.root),openPopouts:W.fromResolvedArray(e.openPopouts),settings:O.Settings.createCopy(e.settings),dimensions:t.Dimensions.fromResolved(e.dimensions),header:O.Header.createCopy(e.header)}},t.isResolved=function(t){const e=t;return void 0!==e.resolved&&!0===e.resolved},t.resolveOpenPopouts=function(t){if(void 0===t)return[];{const e=t.length,n=new Array(e);for(let i=0;i<e;i++)n[i]=W.resolve(t[i]);return n}}}(j||(j={})),function(t){let e;function n(e){const n=e.length,i=new Array(n);for(let r=0;r<n;r++){const n=e[r];i[r]=t.fromResolved(n)}return i}!function(t){t.resolve=function(t,e){var n,i,r,o,s,a,c,d;let l;const h=T.Window.defaults;return l=void 0!==t?{width:null!==(n=t.width)&&void 0!==n?n:h.width,height:null!==(i=t.height)&&void 0!==i?i:h.height,left:null!==(r=t.left)&&void 0!==r?r:h.left,top:null!==(o=t.top)&&void 0!==o?o:h.top}:{width:null!==(s=null==e?void 0:e.width)&&void 0!==s?s:h.width,height:null!==(a=null==e?void 0:e.height)&&void 0!==a?a:h.height,left:null!==(c=null==e?void 0:e.left)&&void 0!==c?c:h.left,top:null!==(d=null==e?void 0:e.top)&&void 0!==d?d:h.top},l},t.fromResolved=function(t){return{width:null===t.width?void 0:t.width,height:null===t.height?void 0:t.height,left:null===t.left?void 0:t.left,top:null===t.top?void 0:t.top}}}(e=t.Window||(t.Window={})),t.resolve=function(e){var n,i;let r;return r=void 0!==e.root?e.root:void 0!==e.content&&e.content.length>0?e.content[0]:void 0,{root:U.resolve(r),openPopouts:j.resolveOpenPopouts(e.openPopouts),dimensions:j.Dimensions.resolve(e.dimensions),settings:j.Settings.resolve(e.settings),header:j.Header.resolve(e.header,e.settings,e.labels),parentId:null!==(n=e.parentId)&&void 0!==n?n:null,indexInParent:null!==(i=e.indexInParent)&&void 0!==i?i:null,window:t.Window.resolve(e.window,e.dimensions),resolved:!0}},t.fromResolved=function(e){return{root:U.fromResolvedOrUndefined(e.root),openPopouts:n(e.openPopouts),dimensions:j.Dimensions.fromResolved(e.dimensions),settings:O.Settings.createCopy(e.settings),header:O.Header.createCopy(e.header),parentId:e.parentId,indexInParent:e.indexInParent,window:t.Window.fromResolved(e.window)}},t.fromResolvedArray=n}(W||(W={}));class et{constructor(){this._allEventSubscriptions=[],this._subscriptionsMap=new Map,this.unbind=this.removeEventListener,this.trigger=this.emit}tryBubbleEvent(t,e){}emit(t,...e){let n=this._subscriptionsMap.get(t);if(void 0!==n){n=n.slice();for(let t=0;t<n.length;t++)(0,n[t])(...e)}this.emitAllEvent(t,e),this.tryBubbleEvent(t,e)}emitUnknown(t,...e){let n=this._subscriptionsMap.get(t);if(void 0!==n){n=n.slice();for(let t=0;t<n.length;t++)n[t](...e)}this.emitAllEvent(t,e),this.tryBubbleEvent(t,e)}emitBaseBubblingEvent(t){const e=new et.BubblingEvent(t,this);this.emitUnknown(t,e)}emitUnknownBubblingEvent(t){const e=new et.BubblingEvent(t,this);this.emitUnknown(t,e)}removeEventListener(t,e){const n=e;this.removeUnknownEventListener(t,n)}off(t,e){this.removeEventListener(t,e)}addEventListener(t,e){const n=e;this.addUnknownEventListener(t,n)}on(t,e){this.addEventListener(t,e)}addUnknownEventListener(t,e){if(t===et.ALL_EVENT)this._allEventSubscriptions.push(e);else{let n=this._subscriptionsMap.get(t);void 0!==n?n.push(e):(n=[e],this._subscriptionsMap.set(t,n))}}removeUnknownEventListener(t,e){if(t===et.ALL_EVENT)this.removeSubscription(t,this._allEventSubscriptions,e);else{const n=this._subscriptionsMap.get(t);if(void 0===n)throw new Error("No subscribtions to unsubscribe for event "+t);this.removeSubscription(t,n,e)}}removeSubscription(t,e,n){const i=e.indexOf(n);if(i<0)throw new Error("Nothing to unbind for "+t);e.splice(i,1)}emitAllEvent(t,e){const n=this._allEventSubscriptions.length;if(n>0){const i=e.slice();i.unshift(t);const r=this._allEventSubscriptions.slice();for(let t=0;t<n;t++)r[t](...i)}}}!function(t){t.ALL_EVENT="__all",t.headerClickEventName="stackHeaderClick",t.headerTouchStartEventName="stackHeaderTouchStart";class e{constructor(t,e){this._name=t,this._target=e,this._isPropagationStopped=!1}get name(){return this._name}get target(){return this._target}get origin(){return this._target}get isPropagationStopped(){return this._isPropagationStopped}stopPropagation(){this._isPropagationStopped=!0}}t.BubblingEvent=e,t.ClickBubblingEvent=class extends e{constructor(t,e,n){super(t,e),this._mouseEvent=n}get mouseEvent(){return this._mouseEvent}},t.TouchStartBubblingEvent=class extends e{constructor(t,e,n){super(t,e),this._touchEvent=n}get touchEvent(){return this._touchEvent}}}(et||(et={}));class nt extends et{constructor(t,e,n,i,r,o,s,a,c){super(),this._config=t,this._parent=e,this._layoutManager=n,this._element=i,this._updateItemConfigEvent=r,this._showEvent=o,this._hideEvent=s,this._focusEvent=a,this._blurEvent=c,this._stackMaximised=!1,this._width=0,this._height=0,this._visible=!0,this._isShownWithZeroDimensions=!0,this._componentType=t.componentType,this._isClosable=t.isClosable,this._initialState=t.componentState,this._state=this._initialState,this._boundComponent=this.layoutManager.bindComponent(this,t),this.updateElementPositionPropertyFromBoundComponent()}get width(){return this._width}get height(){return this._height}get parent(){return this._parent}get componentName(){return this._componentType}get componentType(){return this._componentType}get virtual(){return this._boundComponent.virtual}get component(){return this._boundComponent.component}get tab(){return this._tab}get title(){return this._parent.title}get layoutManager(){return this._layoutManager}get isHidden(){return!this._visible}get visible(){return this._visible}get state(){return this._state}get initialState(){return this._initialState}get element(){return this._element}destroy(){this.releaseComponent(),this.stateRequestEvent=void 0,this.emit("destroy")}getElement(){return this._element}hide(){this._hideEvent()}show(){this._showEvent()}focus(t=!1){this._focusEvent(t)}blur(t=!1){this._blurEvent(t)}setSize(t,e){let n=this._parent;if(n.isColumn||n.isRow||null===n.parent)throw new d("ICSSPRC","ComponentContainer cannot have RowColumn Parent");{let i;do{i=n,n=n.parent}while(null!==n&&!n.isColumn&&!n.isRow);if(null===n)return!1;{const r=n.isColumn?"height":"width",o=this[r];if(null===o)throw new h("ICSSCS11194");{const s=("height"===r?e:t)/(o*(1/(i.size/100)))*100,a=(i.size-s)/(n.contentItems.length-1);for(let t=0;t<n.contentItems.length;t++){const e=n.contentItems[t];e===i?e.size=s:e.size+=a}return n.updateSize(!1),!0}}}}close(){this._isClosable&&(this.emit("close"),this._parent.close())}replaceComponent(t){if(this.releaseComponent(),!k.isComponent(t))throw new Error("ReplaceComponent not passed a component ItemConfig");{const e=F.resolve(t,!1);if(this._initialState=e.componentState,this._state=this._initialState,this._componentType=e.componentType,this._updateItemConfigEvent(e),this._boundComponent=this.layoutManager.bindComponent(this,e),this.updateElementPositionPropertyFromBoundComponent(),this._boundComponent.virtual){if(void 0!==this.virtualVisibilityChangeRequiredEvent&&this.virtualVisibilityChangeRequiredEvent(this,this._visible),void 0!==this.virtualRectingRequiredEvent){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}this.setBaseLogicalZIndex()}this.emit("stateChanged")}}getState(){return this._state}extendState(t){const e=Y(this._state,t);this.setState(e)}setState(t){this._state=t,this._parent.emitBaseBubblingEvent("stateChanged")}setTitle(t){this._parent.setTitle(t)}setTab(t){this._tab=t,this.emit("tab",t)}setVisibility(t){this._boundComponent.virtual&&void 0!==this.virtualVisibilityChangeRequiredEvent&&this.virtualVisibilityChangeRequiredEvent(this,t),t?this._visible?!this._isShownWithZeroDimensions||0===this._height&&0===this._width||(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow()):(this._visible=!0,0===this._height&&0===this._width?this._isShownWithZeroDimensions=!0:(this._isShownWithZeroDimensions=!1,this.setSizeToNodeSize(this._width,this._height,!0),this.emitShow())):this._visible&&(this._visible=!1,this._isShownWithZeroDimensions=!1,this.emitHide())}setBaseLogicalZIndex(){this.setLogicalZIndex(y.base)}setLogicalZIndex(t){t!==this._logicalZIndex&&(this._logicalZIndex=t,this.notifyVirtualZIndexChangeRequired())}enterDragMode(t,e){this._width=t,this._height=e,G(this._element,t),V(this._element,e),this.setLogicalZIndex(y.drag),this.drag()}exitDragMode(){this.setBaseLogicalZIndex()}enterStackMaximised(){this._stackMaximised=!0,this.setLogicalZIndex(y.stackMaximised)}exitStackMaximised(){this.setBaseLogicalZIndex(),this._stackMaximised=!1}drag(){if(this._boundComponent.virtual&&void 0!==this.virtualRectingRequiredEvent){this._layoutManager.fireBeforeVirtualRectingEvent(1);try{this.virtualRectingRequiredEvent(this,this._width,this._height)}finally{this._layoutManager.fireAfterVirtualRectingEvent()}}}setSizeToNodeSize(t,e,n){(t!==this._width||e!==this._height||n)&&(this._width=t,this._height=e,G(this._element,t),V(this._element,e),this._boundComponent.virtual?this.addVirtualSizedContainerToLayoutManager():(this.emit("resize"),this.checkShownFromZeroDimensions()))}notifyVirtualRectingRequired(){void 0!==this.virtualRectingRequiredEvent&&(this.virtualRectingRequiredEvent(this,this._width,this._height),this.emit("resize"),this.checkShownFromZeroDimensions())}notifyVirtualZIndexChangeRequired(){if(void 0!==this.virtualZIndexChangeRequiredEvent){const t=this._logicalZIndex,e=v[t];this.virtualZIndexChangeRequiredEvent(this,t,e)}}updateElementPositionPropertyFromBoundComponent(){this._boundComponent.virtual?this._element.style.position="static":this._element.style.position=""}addVirtualSizedContainerToLayoutManager(){this._layoutManager.beginVirtualSizedContainerAdding();try{this._layoutManager.addVirtualSizedContainer(this)}finally{this._layoutManager.endVirtualSizedContainerAdding()}}checkShownFromZeroDimensions(){!this._isShownWithZeroDimensions||0===this._height&&0===this._width||(this._isShownWithZeroDimensions=!1,this.emitShow())}emitShow(){this.emit("shown"),this.emit("show")}emitHide(){this.emit("hide")}releaseComponent(){this._stackMaximised&&this.exitStackMaximised(),this.emit("beforeComponentRelease",this._boundComponent.component),this.layoutManager.unbindComponent(this,this._boundComponent.virtual,this._boundComponent.component)}}class it extends et{constructor(t,e,n){super(),this._config=t,this._initialWindowSize=e,this._layoutManager=n,this._isInitialised=!1,this._popoutWindow=null,this.createWindow()}toConfig(){var t,e;if(!1===this._isInitialised)throw new Error("Can't create config, layout not yet initialised");const n=this.getGlInstance().saveLayout();let i,r;null===this._popoutWindow?(i=null,r=null):(i=null!==(t=this._popoutWindow.screenX)&&void 0!==t?t:this._popoutWindow.screenLeft,r=null!==(e=this._popoutWindow.screenY)&&void 0!==e?e:this._popoutWindow.screenTop);const o={width:this.getGlInstance().width,height:this.getGlInstance().height,left:i,top:r};return{root:n.root,openPopouts:n.openPopouts,settings:n.settings,dimensions:n.dimensions,header:n.header,window:o,parentId:this._config.parentId,indexInParent:this._config.indexInParent,resolved:!0}}getGlInstance(){if(null===this._popoutWindow)throw new h("BPGGI24693");return this._popoutWindow.__glInstance}getWindow(){if(null===this._popoutWindow)throw new h("BPGW087215");return this._popoutWindow}close(){if(this.getGlInstance())this.getGlInstance().closeWindow();else try{this.getWindow().close()}catch(t){}}popIn(){let t,e=this._config.indexInParent;if(!this._config.parentId)return;const n=Y({},this.getGlInstance().saveLayout()).root;if(void 0===n)throw new u("BPPIR19998");const i=this._layoutManager.groundItem;if(void 0===i)throw new u("BPPIG34972");t=i.getItemsByPopInParentId(this._config.parentId)[0],t||(t=i.contentItems.length>0?i.contentItems[0]:i,e=0);const r=this._layoutManager.createAndInitContentItem(n,t);t.addChild(r,e),this._layoutManager.layoutConfig.settings.popInOnClose?this._onClose():this.close()}createWindow(){const t=this.createUrl(),e=Math.floor(1e6*Math.random()).toString(36),n=this.serializeWindowFeatures({width:this._initialWindowSize.width,height:this._initialWindowSize.height,innerWidth:this._initialWindowSize.width,innerHeight:this._initialWindowSize.height,menubar:"no",toolbar:"no",location:"no",personalbar:"no",resizable:"yes",scrollbars:"no",status:"no"});if(this._popoutWindow=globalThis.open(t,e,n),this._popoutWindow)this._popoutWindow.addEventListener("load",(()=>this.positionWindow()),{passive:!0}),this._popoutWindow.addEventListener("beforeunload",(()=>{this._layoutManager.layoutConfig.settings.popInOnClose?this.popIn():this._onClose()}),{passive:!0}),this._checkReadyInterval=setInterval((()=>this.checkReady()),10);else if(!0===this._layoutManager.layoutConfig.settings.blockedPopoutsThrowError)throw new o("Popout blocked")}checkReady(){if(null===this._popoutWindow)throw new h("BPCR01844");this._popoutWindow.__glInstance&&this._popoutWindow.__glInstance.isInitialised&&(this.onInitialised(),void 0!==this._checkReadyInterval&&(clearInterval(this._checkReadyInterval),this._checkReadyInterval=void 0))}serializeWindowFeatures(t){const e=[];for(const n in t)e.push(n+"="+t[n].toString());return e.join(",")}createUrl(){const t="gl-window-config-"+K(),e=O.minifyConfig(this._config);try{localStorage.setItem(t,JSON.stringify(e))}catch(t){throw new Error("Error while writing to localStorage "+function(t){return t instanceof Error?t.message:"string"==typeof t?t:"Unknown Error"}(t))}const n=new URL(location.href);return n.searchParams.set("gl-window",t),n.toString()}positionWindow(){if(null===this._popoutWindow)throw new Error("BrowserPopout.positionWindow: null popoutWindow");this._popoutWindow.moveTo(this._initialWindowSize.left,this._initialWindowSize.top),this._popoutWindow.focus()}onInitialised(){this._isInitialised=!0,this.getGlInstance().on("popIn",(()=>this.popIn())),this.emit("initialised")}_onClose(){setTimeout((()=>this.emit("closed")),50)}}class rt extends et{constructor(t,e,n,i){super(),this.layoutManager=t,this._parent=n,this._element=i,this._popInParentIds=[],this._type=e.type,this._id=e.id,this._isInitialised=!1,this.isGround=!1,this.isRow=!1,this.isColumn=!1,this.isStack=!1,this.isComponent=!1,this.size=e.size,this.sizeUnit=e.sizeUnit,this.minSize=e.minSize,this.minSizeUnit=e.minSizeUnit,this._isClosable=e.isClosable,this._pendingEventPropagations={},this._throttledEvents=["stateChanged"],this._contentItems=this.createContentItems(e.content)}get type(){return this._type}get id(){return this._id}set id(t){this._id=t}get popInParentIds(){return this._popInParentIds}get parent(){return this._parent}get contentItems(){return this._contentItems}get isClosable(){return this._isClosable}get element(){return this._element}get isInitialised(){return this._isInitialised}static isStack(t){return t.isStack}static isComponentItem(t){return t.isComponent}static isComponentParentableItem(t){return t.isStack||t.isGround}removeChild(t,e=!1){const n=this._contentItems.indexOf(t);if(-1===n)throw new Error("Can't remove child item. Unknown content item");if(e||this._contentItems[n].destroy(),this._contentItems.splice(n,1),this._contentItems.length>0)this.updateSize(!1);else if(!this.isGround&&!0===this._isClosable){if(null===this._parent)throw new h("CIUC00874");this._parent.removeChild(this)}}addChild(t,e,n){return null!=e||(e=this._contentItems.length),this._contentItems.splice(e,0,t),t.setParent(this),!0===this._isInitialised&&!1===t._isInitialised&&t.init(),e}replaceChild(t,e,n=!1){const i=this._contentItems.indexOf(t),r=t._element.parentNode;if(-1===i)throw new d("CIRCI23232","Can't replace child. oldChild is not child of this");if(null===r)throw new h("CIRCP23232");if(r.replaceChild(e._element,t._element),!0===n&&(t._parent=null,t.destroy()),this._contentItems[i]=e,e.setParent(this),e.size=t.size,e.sizeUnit=t.sizeUnit,e.minSize=t.minSize,e.minSizeUnit=t.minSizeUnit,null===e._parent)throw new h("CIRCNC45699");!0===e._parent._isInitialised&&!1===e._isInitialised&&e.init(),this.updateSize(!1)}remove(){if(null===this._parent)throw new h("CIR11110");this._parent.removeChild(this)}popout(){const t=K(),e=this.layoutManager.createPopoutFromContentItem(this,void 0,t,void 0);return this.emitBaseBubblingEvent("stateChanged"),e}calculateConfigContent(){const t=this._contentItems,e=t.length,n=new Array(e);for(let i=0;i<e;i++){const e=t[i];n[i]=e.toConfig()}return n}highlightDropZone(t,e,n){const i=this.layoutManager.dropTargetIndicator;if(null===i)throw new h("ACIHDZ5593");i.highlightArea(n,1)}onDrop(t,e){this.addChild(t)}show(){this.layoutManager.beginSizeInvalidation();try{Z(this._element,!0);for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].show()}finally{this.layoutManager.endSizeInvalidation()}}destroy(){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].destroy();this._contentItems=[],this.emitBaseBubblingEvent("beforeItemDestroyed"),this._element.remove(),this.emitBaseBubblingEvent("itemDestroyed")}getElementArea(t){const e=(t=null!=t?t:this._element).getBoundingClientRect(),n=e.top+document.body.scrollTop,i=e.left+document.body.scrollLeft,r=e.width,o=e.height;return{x1:i,y1:n,x2:i+r,y2:n+o,surface:r*o,contentItem:this}}init(){this._isInitialised=!0,this.emitBaseBubblingEvent("itemCreated"),this.emitUnknownBubblingEvent(this.type+"Created")}setParent(t){this._parent=t}addPopInParentId(t){this.popInParentIds.includes(t)||this.popInParentIds.push(t)}initContentItems(){for(let t=0;t<this._contentItems.length;t++)this._contentItems[t].init()}hide(){this.layoutManager.beginSizeInvalidation();try{Z(this._element,!1)}finally{this.layoutManager.endSizeInvalidation()}}updateContentItemsSize(t){for(let e=0;e<this._contentItems.length;e++)this._contentItems[e].updateSize(t)}createContentItems(t){const e=t.length,n=new Array(e);for(let e=0;e<t.length;e++)n[e]=this.layoutManager.createContentItem(t[e],this);return n}propagateEvent(t,e){if(1===e.length){const n=e[0];n instanceof et.BubblingEvent&&!1===n.isPropagationStopped&&!0===this._isInitialised&&(!1===this.isGround&&this._parent?this._parent.emitUnknown(t,n):this.scheduleEventPropagationToLayoutManager(t,n))}}tryBubbleEvent(t,e){if(1===e.length){const n=e[0];n instanceof et.BubblingEvent&&!1===n.isPropagationStopped&&!0===this._isInitialised&&(!1===this.isGround&&this._parent?this._parent.emitUnknown(t,n):this.scheduleEventPropagationToLayoutManager(t,n))}}scheduleEventPropagationToLayoutManager(t,e){-1===this._throttledEvents.indexOf(t)?this.layoutManager.emitUnknown(t,e):!0!==this._pendingEventPropagations[t]&&(this._pendingEventPropagations[t]=!0,globalThis.requestAnimationFrame((()=>this.propagateEventToLayoutManager(t,e))))}propagateEventToLayoutManager(t,e){this._pendingEventPropagations[t]=!1,this.layoutManager.emitUnknown(t,e)}}class ot extends rt{constructor(t,e,n){super(t,e,n,document.createElement("div")),this._parentItem=n,this._focused=!1,this.isComponent=!0,this._reorderEnabled=e.reorderEnabled,this.applyUpdatableConfig(e),this._initialWantMaximise=e.maximised;const i=document.createElement("div");i.classList.add("lm_content"),this.element.appendChild(i),this._container=new nt(e,this,t,i,(t=>this.handleUpdateItemConfigEvent(t)),(()=>this.show()),(()=>this.hide()),(t=>this.focus(t)),(t=>this.blur(t)))}get componentName(){return this._container.componentType}get componentType(){return this._container.componentType}get reorderEnabled(){return this._reorderEnabled}get initialWantMaximise(){return this._initialWantMaximise}get component(){return this._container.component}get container(){return this._container}get parentItem(){return this._parentItem}get headerConfig(){return this._headerConfig}get title(){return this._title}get tab(){return this._tab}get focused(){return this._focused}destroy(){this._container.destroy(),super.destroy()}applyUpdatableConfig(t){this.setTitle(t.title),this._headerConfig=t.header}toConfig(){const t=this._container.stateRequestEvent,e=void 0===t?this._container.state:t();return{type:C.component,content:[],size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,maximised:!1,isClosable:this.isClosable,reorderEnabled:this._reorderEnabled,title:this._title,header:S.Header.createCopy(this._headerConfig),componentType:P.copyComponentType(this.componentType),componentState:e}}close(){if(null===this.parent)throw new h("CIC68883");this.parent.removeChild(this,!1)}enterDragMode(t,e){G(this.element,t),V(this.element,e),this._container.enterDragMode(t,e)}exitDragMode(){this._container.exitDragMode()}enterStackMaximised(){this._container.enterStackMaximised()}exitStackMaximised(){this._container.exitStackMaximised()}drag(){this._container.drag()}updateSize(t){this.updateNodeSize(t)}init(){this.updateNodeSize(!1),super.init(),this._container.emit("open"),this.initContentItems()}setTitle(t){this._title=t,this.emit("titleChanged",t),this.emit("stateChanged")}setTab(t){this._tab=t,this.emit("tab",t),this._container.setTab(t)}hide(){super.hide(),this._container.setVisibility(!1)}show(){super.show(),this._container.setVisibility(!0)}focus(t=!1){this.parentItem.setActiveComponentItem(this,!0,t)}setFocused(t){this._focused=!0,this.tab.setFocused(),t||this.emitBaseBubblingEvent("focus")}blur(t=!1){this._focused&&this.layoutManager.setFocusedComponentItem(void 0,t)}setBlurred(t){this._focused=!1,this.tab.setBlurred(),t||this.emitBaseBubblingEvent("blur")}setParent(t){this._parentItem=t,super.setParent(t)}handleUpdateItemConfigEvent(t){this.applyUpdatableConfig(t)}updateNodeSize(t){if("none"!==this.element.style.display){const{width:e,height:n}=q(this.element);this._container.setSizeToNodeSize(e,n,t)}}}class st extends rt{constructor(){super(...arguments),this._focused=!1}get focused(){return this._focused}setFocusedValue(t){this._focused=t}}class at extends et{constructor(t,e){super(),this._eElement=t,this._pointerTracking=!1,this._pointerDownEventListener=t=>this.onPointerDown(t),this._pointerMoveEventListener=t=>this.onPointerMove(t),this._pointerUpEventListener=t=>this.onPointerUp(t),this._timeout=void 0,this._allowableTargets=[t,...e],this._oDocument=document,this._eBody=document.body,this._nDelay=1800,this._nDistance=10,this._nX=0,this._nY=0,this._nOriginalX=0,this._nOriginalY=0,this._dragging=!1,this._eElement.addEventListener("pointerdown",this._pointerDownEventListener,{passive:!0})}destroy(){this.checkRemovePointerTrackingEventListeners(),this._eElement.removeEventListener("pointerdown",this._pointerDownEventListener)}cancelDrag(){this.processDragStop(void 0)}onPointerDown(t){if(this._allowableTargets.includes(t.target)&&t.isPrimary){const e=this.getPointerCoordinates(t);this.processPointerDown(e)}}processPointerDown(t){this._nOriginalX=t.x,this._nOriginalY=t.y,this._oDocument.addEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.addEventListener("pointerup",this._pointerUpEventListener,{passive:!0}),this._pointerTracking=!0,this._timeout=setTimeout((()=>{try{this.startDrag()}catch(t){throw console.error(t),t}}),this._nDelay)}onPointerMove(t){this._pointerTracking&&(this.processDragMove(t),t.preventDefault())}processDragMove(t){this._nX=t.pageX-this._nOriginalX,this._nY=t.pageY-this._nOriginalY,!1===this._dragging&&(Math.abs(this._nX)>this._nDistance||Math.abs(this._nY)>this._nDistance)&&this.startDrag(),this._dragging&&this.emit("drag",this._nX,this._nY,t)}onPointerUp(t){this.processDragStop(t)}processDragStop(t){var e;void 0!==this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0),this.checkRemovePointerTrackingEventListeners(),!0===this._dragging&&(this._eBody.classList.remove("lm_dragging"),this._eElement.classList.remove("lm_dragging"),null===(e=this._oDocument.querySelector("iframe"))||void 0===e||e.style.setProperty("pointer-events",""),this._dragging=!1,this.emit("dragStop",t))}checkRemovePointerTrackingEventListeners(){this._pointerTracking&&(this._oDocument.removeEventListener("pointermove",this._pointerMoveEventListener),this._oDocument.removeEventListener("pointerup",this._pointerUpEventListener),this._pointerTracking=!1)}startDrag(){var t;void 0!==this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0),this._dragging=!0,this._eBody.classList.add("lm_dragging"),this._eElement.classList.add("lm_dragging"),null===(t=this._oDocument.querySelector("iframe"))||void 0===t||t.style.setProperty("pointer-events","none"),this.emit("dragStart",this._nOriginalX,this._nOriginalY)}getPointerCoordinates(t){return{x:t.pageX,y:t.pageY}}}class ct{constructor(t,e,n){this._isVertical=t,this._size=e,this._grabSize=n<this._size?this._size:n,this._element=document.createElement("div"),this._element.classList.add("lm_splitter");const i=document.createElement("div");i.classList.add("lm_drag_handle");const r=this._grabSize-this._size,o=r/2;this._isVertical?(i.style.top=$(-o),i.style.height=$(this._size+r),this._element.classList.add("lm_vertical"),this._element.style.height=$(this._size)):(i.style.left=$(-o),i.style.width=$(this._size+r),this._element.classList.add("lm_horizontal"),this._element.style.width=$(this._size)),this._element.appendChild(i),this._dragListener=new at(this._element,[i])}get element(){return this._element}destroy(){this._element.remove()}on(t,e){this._dragListener.on(t,e)}}class dt extends rt{constructor(t,e,n,i){switch(super(e,n,i,dt.createElement(document,t)),this._rowOrColumnParent=i,this._splitter=[],this.isRow=!t,this.isColumn=t,this._childElementContainer=this.element,this._splitterSize=e.layoutConfig.dimensions.borderWidth,this._splitterGrabSize=e.layoutConfig.dimensions.borderGrabWidth,this._isColumn=t,this._dimension=t?"height":"width",this._splitterPosition=null,this._splitterMinPosition=null,this._splitterMaxPosition=null,n.type){case C.row:case C.column:this._configType=n.type;break;default:throw new d("ROCCCT00925")}}newComponent(t,e,n,i){const r={type:"component",componentType:t,componentState:e,title:n};return this.newItem(r,i)}addComponent(t,e,n,i){const r={type:"component",componentType:t,componentState:e,title:n};return this.addItem(r,i)}newItem(t,e){e=this.addItem(t,e);const n=this.contentItems[e];return rt.isStack(n)&&k.isComponent(t)?n.contentItems[0]:n}addItem(t,e){this.layoutManager.checkMinimiseMaximisedStack();const n=k.resolve(t,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,e,!1)}addChild(t,e,n){if(void 0===e&&(e=this.contentItems.length),this.contentItems.length>0){const n=this.createSplitter(Math.max(0,e-1)).element;e>0?(this.contentItems[e-1].element.insertAdjacentElement("afterend",n),n.insertAdjacentElement("afterend",t.element)):(this.contentItems[0].element.insertAdjacentElement("beforebegin",n),n.insertAdjacentElement("beforebegin",t.element))}else this._childElementContainer.appendChild(t.element);super.addChild(t,e);const i=1/this.contentItems.length*100;if(!0===n)return this.emitBaseBubblingEvent("stateChanged"),e;for(let e=0;e<this.contentItems.length;e++){const n=this.contentItems[e];if(n===t)t.size=i;else{const t=n.size*=(100-i)/100;n.size=t}}return this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),e}removeChild(t,e){const n=this.contentItems.indexOf(t),i=Math.max(n-1,0);if(-1===n)throw new Error("Can't remove child. ContentItem is not child of this Row or Column");if(this._splitter[i]&&(this._splitter[i].destroy(),this._splitter.splice(i,1)),super.removeChild(t,e),1===this.contentItems.length&&!0===this.isClosable){const t=this.contentItems[0];this.contentItems.length=0,this._rowOrColumnParent.replaceChild(this,t,!0)}else this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}replaceChild(t,e){const n=t.size;super.replaceChild(t,e),e.size=n,this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged")}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(!0!==this.isInitialised){this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init();for(let t=0;t<this.contentItems.length-1;t++)this.contentItems[t].element.insertAdjacentElement("afterend",this.createSplitter(t).element);this.initContentItems()}}toConfig(){return{type:this.type,content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable}}setParent(t){this._rowOrColumnParent=t,super.setParent(t)}updateNodeSize(){this.contentItems.length>0&&(this.calculateRelativeSizes(),this.setAbsoluteSizes()),this.emitBaseBubblingEvent("stateChanged"),this.emit("resize")}setAbsoluteSizes(){const t=this.calculateAbsoluteSizes();for(let e=0;e<this.contentItems.length;e++)t.additionalPixel-e>0&&t.itemSizes[e]++,this._isColumn?(G(this.contentItems[e].element,t.crossAxisSize),V(this.contentItems[e].element,t.itemSizes[e])):(G(this.contentItems[e].element,t.itemSizes[e]),V(this.contentItems[e].element,t.crossAxisSize))}calculateAbsoluteSizes(){const t=(this.contentItems.length-1)*this._splitterSize,{width:e,height:n}=q(this.element);let i,r;this._isColumn?(i=n-t,r=e):(i=e-t,r=n);let o=0;const s=[];for(let t=0;t<this.contentItems.length;t++){const e=this.contentItems[t];let n;if(e.sizeUnit!==I.Percent)throw new d("ROCCAS6692");n=Math.floor(i*(e.size/100)),o+=n,s.push(n)}return{itemSizes:s,additionalPixel:Math.floor(i-o),totalSize:i,crossAxisSize:r}}calculateRelativeSizes(){let t=0;const e=[];let n=0;for(let i=0;i<this.contentItems.length;i++){const r=this.contentItems[i];switch(r.sizeUnit){case I.Percent:t+=r.size;break;case I.Fractional:e.push(r),n+=r.size;break;default:throw new d("ROCCRS49110",JSON.stringify(r))}}if(100!==Math.round(t))if(Math.round(t)<100&&e.length>0){const i=100-t;for(let t=0;t<e.length;t++){const r=e[t];r.size=i*(r.size/n),r.sizeUnit=I.Percent}this.respectMinItemSize()}else{if(Math.round(t)>100&&e.length>0){for(let t=0;t<e.length;t++){const i=e[t];i.size=i.size/n*50,i.sizeUnit=I.Percent}t+=50}for(let e=0;e<this.contentItems.length;e++){const n=this.contentItems[e];n.size=n.size/t*100}this.respectMinItemSize()}else this.respectMinItemSize()}respectMinItemSize(){const t=this.calculateContentItemMinSize(this);if(!(t<=0||this.contentItems.length<=1)){let e=0,n=0;const i=[],r=[],o=this.calculateAbsoluteSizes();for(let s=0;s<o.itemSizes.length;s++){const a=o.itemSizes[s];let c;a<t?(n+=t-a,c={size:t}):(e+=a-t,c={size:a},i.push(c)),r.push(c)}if(0===n||n>e)return;{const s=n/e;let a=n;for(let e=0;e<i.length;e++){const n=i[e],r=Math.round((n.size-t)*s);a-=r,n.size-=r}0!==a&&(r[r.length-1].size-=a);for(let t=0;t<this.contentItems.length;t++)this.contentItems[t].size=r[t].size/o.totalSize*100}}}createSplitter(t){const e=new ct(this._isColumn,this._splitterSize,this._splitterGrabSize);return e.on("drag",((t,n)=>this.onSplitterDrag(e,t,n))),e.on("dragStop",(()=>this.onSplitterDragStop(e))),e.on("dragStart",(()=>this.onSplitterDragStart(e))),this._splitter.splice(t,0,e),e}getSplitItems(t){const e=this._splitter.indexOf(t);return{before:this.contentItems[e],after:this.contentItems[e+1]}}calculateContentItemMinSize(t){const e=t.minSize;if(void 0!==e){if(t.minSizeUnit===I.Pixel)return e;throw new d("ROCGMD98831",JSON.stringify(t))}{const t=this.layoutManager.layoutConfig.dimensions;return this._isColumn?t.defaultMinItemHeight:t.defaultMinItemWidth}}calculateContentItemsTotalMinSize(t){let e=0;for(const n of t)e+=this.calculateContentItemMinSize(n);return e}onSplitterDragStart(t){const e=this.getSplitItems(t),n=H(e.before.element.style[this._dimension]),i=H(e.after.element.style[this._dimension]),r=this.calculateContentItemsTotalMinSize(e.before.contentItems),o=this.calculateContentItemsTotalMinSize(e.after.contentItems);this._splitterPosition=0,this._splitterMinPosition=-1*(n-r),this._splitterMaxPosition=i-o}onSplitterDrag(t,e,n){let i=this._isColumn?n:e;if(null===this._splitterMinPosition||null===this._splitterMaxPosition)throw new h("ROCOSD59226");i=Math.max(i,this._splitterMinPosition),i=Math.min(i,this._splitterMaxPosition),this._splitterPosition=i;const r=$(i);this._isColumn?t.element.style.top=r:t.element.style.left=r}onSplitterDragStop(t){if(null===this._splitterPosition)throw new h("ROCOSDS66932");{const e=this.getSplitItems(t),n=H(e.before.element.style[this._dimension]),i=H(e.after.element.style[this._dimension]),r=(this._splitterPosition+n)/(n+i),o=e.before.size+e.after.size;e.before.size=r*o,e.after.size=(1-r)*o,t.element.style.top=$(0),t.element.style.left=$(0),globalThis.requestAnimationFrame((()=>this.updateSize(!1)))}}}!function(t){t.getElementDimensionSize=function(t,e){return"width"===e?function(t){return t.offsetWidth}(t):function(t){return t.offsetHeight}(t)},t.setElementDimensionSize=function(t,e,n){return"width"===e?G(t,n):V(t,n)},t.createElement=function(t,e){const n=t.createElement("div");return n.classList.add("lm_item"),e?n.classList.add("lm_column"):n.classList.add("lm_row"),n}}(dt||(dt={}));class lt extends st{constructor(t,e,n){super(t,R.create(e),null,lt.createElement(document)),this.isGround=!0,this._childElementContainer=this.element,this._containerElement=n;let i=null;for(;;){const t=i?i.previousSibling:this._containerElement.lastChild;if(!(t instanceof Element&&t.classList.contains("lm_content")))break;i=t}this._containerElement.insertBefore(this.element,i)}init(){if(!0!==this.isInitialised){this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init(),this.initContentItems()}}loadRoot(t){if(this.clearRoot(),void 0!==t){const e=this.layoutManager.createAndInitContentItem(t,this);this.addChild(e,0)}}clearRoot(){const t=this.contentItems;switch(t.length){case 0:return;case 1:return void t[0].remove();default:throw new d("GILR07721")}}addItem(t,e){this.layoutManager.checkMinimiseMaximisedStack();const n=k.resolve(t,!1);let i;if(i=this.contentItems.length>0?this.contentItems[0]:this,i.isComponent)throw new Error("Cannot add item as child to ComponentItem");{const t=this.layoutManager.createAndInitContentItem(n,i);return e=i.addChild(t,e),i===this?-1:e}}loadComponentAsRoot(t){this.clearRoot();const e=k.resolve(t,!1);if(e.maximised)throw new Error("Root Component cannot be maximised");{const t=new ot(this.layoutManager,e,this);t.init(),this.addChild(t,0)}}addChild(t,e){if(this.contentItems.length>0)throw new Error("Ground node can only have a single child");return this._childElementContainer.appendChild(t.element),e=super.addChild(t,e),this.updateSize(!1),this.emitBaseBubblingEvent("stateChanged"),e}calculateConfigContent(){const t=this.contentItems,e=t.length,n=new Array(e);for(let i=0;i<e;i++){const e=t[i].toConfig();if(!L.isRootItemConfig(e))throw new d("RCCC66832");n[i]=e}return n}setSize(t,e){void 0===t||void 0===e?this.updateSize(!1):(G(this.element,t),V(this.element,e),this.contentItems.length>0&&(G(this.contentItems[0].element,t),V(this.contentItems[0].element,e)),this.updateContentItemsSize(!1))}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}createSideAreas(){const t=lt.Area.oppositeSides,e=new Array(Object.keys(t).length);let n=0;for(const i in t){const r=i,o=this.getElementArea();if(null===o)throw new h("RCSA77553");o.side=r,"2"===t[r][1]?o[r]=o[t[r]]-50:o[r]=o[t[r]]+50,o.surface=(o.x2-o.x1)*(o.y2-o.y1),e[n++]=o}return e}highlightDropZone(t,e,n){this.layoutManager.tabDropPlaceholder.remove(),super.highlightDropZone(t,e,n)}onDrop(t,e){if(t.isComponent){const e=A.createDefault(),n=t;e.header=S.Header.createCopy(n.headerConfig);const i=this.layoutManager.createAndInitContentItem(e,this);i.addChild(t),t=i}if(0===this.contentItems.length)this.addChild(t);else{if(t.type===C.row||t.type===C.column){const e=A.createDefault(),n=this.layoutManager.createContentItem(e,this);n.addChild(t),t=n}const n="x"==e.side[0]?C.row:C.column,i="2"==e.side[1],r=this.contentItems[0];if(r instanceof dt&&r.type===n){const e=r.contentItems[i?0:r.contentItems.length-1];r.addChild(t,i?0:void 0,!0),e.size*=.5,t.size=e.size,t.sizeUnit=I.Percent,r.updateSize(!1)}else{const e=x.createDefault(n),o=this.layoutManager.createContentItem(e,this);this.replaceChild(r,o),o.addChild(t,i?0:void 0,!0),o.addChild(r,i?void 0:0,!0),r.size=50,t.size=50,t.sizeUnit=I.Percent,o.updateSize(!1)}}}dock(){throw new d("GID87731")}validateDocking(){throw new d("GIVD87732")}getAllContentItems(){const t=[this];return this.deepGetAllContentItems(this.contentItems,t),t}getConfigMaximisedItems(){const t=[];return this.deepFilterContentItems(this.contentItems,t,(t=>!(!rt.isStack(t)||!t.initialWantMaximise)||!(!rt.isComponentItem(t)||!t.initialWantMaximise))),t}getItemsByPopInParentId(t){const e=[];return this.deepFilterContentItems(this.contentItems,e,(e=>e.popInParentIds.includes(t))),e}toConfig(){throw new Error("Cannot generate GroundItem config")}setActiveComponentItem(t,e,n){}updateNodeSize(){const{width:t,height:e}=q(this._containerElement);G(this.element,t),V(this.element,e),this.contentItems.length>0&&(G(this.contentItems[0].element,t),V(this.contentItems[0].element,e))}deepGetAllContentItems(t,e){for(let n=0;n<t.length;n++){const i=t[n];e.push(i),this.deepGetAllContentItems(i.contentItems,e)}}deepFilterContentItems(t,e,n){for(let i=0;i<t.length;i++){const r=t[i];n(r)&&e.push(r),this.deepFilterContentItems(r.contentItems,e,n)}}}!function(t){let e;!function(t){t.oppositeSides={y2:"y1",x2:"x1",y1:"y2",x1:"x2"}}(e=t.Area||(t.Area={})),t.createElement=function(t){const e=t.createElement("div");return e.classList.add("lm_goldenlayout"),e.classList.add("lm_item"),e.classList.add("lm_root"),e}}(lt||(lt={}));class ht{constructor(t,e,n,i){this._header=t,this._pushEvent=i,this._clickEventListener=t=>this.onClick(t),this._touchStartEventListener=t=>this.onTouchStart(t),this._element=document.createElement("div"),this._element.classList.add(n),this._element.title=e,this._header.on("destroy",(()=>this.destroy())),this._element.addEventListener("click",this._clickEventListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartEventListener,{passive:!0}),this._header.controlsContainerElement.appendChild(this._element)}get element(){return this._element}destroy(){var t;this._element.removeEventListener("click",this._clickEventListener),this._element.removeEventListener("touchstart",this._touchStartEventListener),null===(t=this._element.parentNode)||void 0===t||t.removeChild(this._element)}onClick(t){this._pushEvent(t)}onTouchStart(t){this._pushEvent(t)}}class ut{constructor(t,e,n,i,r){var o;this._layoutManager=t,this._componentItem=e,this._closeEvent=n,this._focusEvent=i,this._dragStartEvent=r,this._isActive=!1,this._tabClickListener=t=>this.onTabClickDown(t),this._tabTouchStartListener=t=>this.onTabTouchStart(t),this._closeClickListener=()=>this.onCloseClick(),this._closeTouchStartListener=()=>this.onCloseTouchStart(),this._dragStartListener=(t,e)=>this.onDragStart(t,e),this._contentItemDestroyListener=()=>this.onContentItemDestroy(),this._tabTitleChangedListener=t=>this.setTitle(t),this._element=document.createElement("div"),this._element.classList.add("lm_tab"),this._titleElement=document.createElement("span"),this._titleElement.classList.add("lm_title"),this._closeElement=document.createElement("div"),this._closeElement.classList.add("lm_close_tab"),this._element.appendChild(this._titleElement),this._element.appendChild(this._closeElement),e.isClosable?this._closeElement.style.display="":this._closeElement.style.display="none",this.setTitle(e.title),this._componentItem.on("titleChanged",this._tabTitleChangedListener),(null!==(o=e.reorderEnabled)&&void 0!==o?o:this._layoutManager.layoutConfig.settings.reorderEnabled)&&this.enableReorder(),this._element.addEventListener("click",this._tabClickListener,{passive:!0}),this._element.addEventListener("touchstart",this._tabTouchStartListener,{passive:!0}),this._componentItem.isClosable?(this._closeElement.addEventListener("click",this._closeClickListener,{passive:!0}),this._closeElement.addEventListener("touchstart",this._closeTouchStartListener,{passive:!0})):(this._closeElement.remove(),this._closeElement=void 0),this._componentItem.setTab(this),this._layoutManager.emit("tabCreated",this)}get isActive(){return this._isActive}get componentItem(){return this._componentItem}get contentItem(){return this._componentItem}get element(){return this._element}get titleElement(){return this._titleElement}get closeElement(){return this._closeElement}get reorderEnabled(){return void 0!==this._dragListener}set reorderEnabled(t){t!==this.reorderEnabled&&(t?this.enableReorder():this.disableReorder())}setTitle(t){this._titleElement.innerText=t,this._element.title=t}setActive(t){t!==this._isActive&&(this._isActive=t,t?this._element.classList.add("lm_active"):this._element.classList.remove("lm_active"))}destroy(){var t,e;this._closeEvent=void 0,this._focusEvent=void 0,this._dragStartEvent=void 0,this._element.removeEventListener("click",this._tabClickListener),this._element.removeEventListener("touchstart",this._tabTouchStartListener),null===(t=this._closeElement)||void 0===t||t.removeEventListener("click",this._closeClickListener),null===(e=this._closeElement)||void 0===e||e.removeEventListener("touchstart",this._closeTouchStartListener),this._componentItem.off("titleChanged",this._tabTitleChangedListener),this.reorderEnabled&&this.disableReorder(),this._element.remove()}setBlurred(){this._element.classList.remove("lm_focused"),this._titleElement.classList.remove("lm_focused")}setFocused(){this._element.classList.add("lm_focused"),this._titleElement.classList.add("lm_focused")}onDragStart(t,e){if(void 0===this._dragListener)throw new u("TODSDLU10093");if(void 0===this._dragStartEvent)throw new u("TODS23309");this._dragStartEvent(t,e,this._dragListener,this.componentItem)}onContentItemDestroy(){void 0!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=void 0)}onTabClickDown(t){const e=t.target;e!==this._element&&e!==this._titleElement||(0===t.button?this.notifyFocus():1===t.button&&this._componentItem.isClosable&&this.notifyClose())}onTabTouchStart(t){t.target===this._element&&this.notifyFocus()}onCloseClick(){this.notifyClose()}onCloseTouchStart(){this.notifyClose()}notifyClose(){if(void 0===this._closeEvent)throw new u("TNC15007");this._closeEvent(this._componentItem)}notifyFocus(){if(void 0===this._focusEvent)throw new u("TNA15007");this._focusEvent(this._componentItem)}enableReorder(){this._dragListener=new at(this._element,[this._titleElement]),this._dragListener.on("dragStart",this._dragStartListener),this._componentItem.on("destroy",this._contentItemDestroyListener)}disableReorder(){if(void 0===this._dragListener)throw new u("TDR87745");this._componentItem.off("destroy",this._contentItemDestroyListener),this._dragListener.off("dragStart",this._dragStartListener),this._dragListener=void 0}}class pt{constructor(t,e,n,i,r){this._layoutManager=t,this._componentRemoveEvent=e,this._componentFocusEvent=n,this._componentDragStartEvent=i,this._dropdownActiveChangedEvent=r,this._tabs=[],this._lastVisibleTabIndex=-1,this._dropdownActive=!1,this._element=document.createElement("section"),this._element.classList.add("lm_tabs"),this._dropdownElement=document.createElement("section"),this._dropdownElement.classList.add("lm_tabdropdown_list"),this._dropdownElement.style.display="none"}get tabs(){return this._tabs}get tabCount(){return this._tabs.length}get lastVisibleTabIndex(){return this._lastVisibleTabIndex}get element(){return this._element}get dropdownElement(){return this._dropdownElement}get dropdownActive(){return this._dropdownActive}destroy(){for(let t=0;t<this._tabs.length;t++)this._tabs[t].destroy()}createTab(t,e){for(let e=0;e<this._tabs.length;e++)if(this._tabs[e].componentItem===t)return;const n=new ut(this._layoutManager,t,(t=>this.handleTabCloseEvent(t)),(t=>this.handleTabFocusEvent(t)),((t,e,n,i)=>this.handleTabDragStartEvent(t,e,n,i)));void 0===e&&(e=this._tabs.length),this._tabs.splice(e,0,n),e<this._element.childNodes.length?this._element.insertBefore(n.element,this._element.childNodes[e]):this._element.appendChild(n.element)}removeTab(t){for(let e=0;e<this._tabs.length;e++)if(this._tabs[e].componentItem===t)return this._tabs[e].destroy(),void this._tabs.splice(e,1);throw new Error("contentItem is not controlled by this header")}processActiveComponentChanged(t){let e=-1;for(let n=0;n<this._tabs.length;n++){const i=this._tabs[n].componentItem===t;this._tabs[n].setActive(i),i&&(e=n)}if(e<0)throw new d("HSACI56632");if(this._layoutManager.layoutConfig.settings.reorderOnTabMenuClick&&-1!==this._lastVisibleTabIndex&&e>this._lastVisibleTabIndex){const t=this._tabs[e];for(let t=e;t>0;t--)this._tabs[t]=this._tabs[t-1];this._tabs[0]=t}}updateTabSizes(t,e){let n=!1;this.tryUpdateTabSizes(n,t,e)||(n=!0,this.tryUpdateTabSizes(n,t,e)),n!==this._dropdownActive&&(this._dropdownActive=n,this._dropdownActiveChangedEvent())}tryUpdateTabSizes(t,e,n){if(this._tabs.length>0){if(void 0===n)throw new Error("non-empty tabs must have active component item");let i=0,r=!1;const o=this._layoutManager.layoutConfig.settings.tabOverlapAllowance,s=this._tabs.indexOf(n.tab),a=this._tabs[s];this._lastVisibleTabIndex=-1;for(let n=0;n<this._tabs.length;n++){const c=this._tabs[n].element;c.parentElement!==this._element&&this._element.appendChild(c);const d=H(getComputedStyle(a.element).marginRight);i+=c.offsetWidth+d;let l=0;if(s<=n)l=i;else{const t=H(getComputedStyle(a.element).marginRight);l=i+a.element.offsetWidth+t}if(l>e){if(r)n===s&&(c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._element&&this._element.appendChild(c));else{let t;if(t=s>0&&s<=n?(l-e)/(n-1):(l-e)/n,t<o){for(let e=0;e<=n;e++){const i=e!==s&&0!==e?"-"+$(t):"";this._tabs[e].element.style.zIndex=$(n-e),this._tabs[e].element.style.marginLeft=i}this._lastVisibleTabIndex=n,c.parentElement!==this._element&&this._element.appendChild(c)}else r=!0}if(r&&n!==s){if(!t)return!1;c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._dropdownElement&&this._dropdownElement.appendChild(c)}}else this._lastVisibleTabIndex=n,c.style.zIndex="auto",c.style.marginLeft="",c.parentElement!==this._element&&this._element.appendChild(c)}}return!0}showAdditionalTabsDropdown(){this._dropdownElement.style.display=""}hideAdditionalTabsDropdown(){this._dropdownElement.style.display="none"}handleTabCloseEvent(t){this._componentRemoveEvent(t)}handleTabFocusEvent(t){this._componentFocusEvent(t)}handleTabDragStartEvent(t,e,n,i){this._componentDragStartEvent(t,e,n,i)}}class ft extends et{constructor(t,e,n,i,r,o,s,a,c,d,l,h,u){super(),this._layoutManager=t,this._parent=e,this._configClosable=i,this._getActiveComponentItemEvent=r,this._popoutEvent=s,this._maximiseToggleEvent=a,this._clickEvent=c,this._touchStartEvent=d,this._componentRemoveEvent=l,this._componentFocusEvent=h,this._componentDragStartEvent=u,this._clickListener=t=>this.onClick(t),this._touchStartListener=t=>this.onTouchStart(t),this._rowColumnClosable=!0,this._closeButton=null,this._popoutButton=null,this._tabsContainer=new pt(this._layoutManager,(t=>this.handleTabInitiatedComponentRemoveEvent(t)),(t=>this.handleTabInitiatedComponentFocusEvent(t)),((t,e,n,i)=>this.handleTabInitiatedDragStartEvent(t,e,n,i)),(()=>this.processTabDropdownActiveChanged())),this._show=n.show,this._popoutEnabled=n.popoutEnabled,this._popoutLabel=n.popoutLabel,this._maximiseEnabled=n.maximiseEnabled,this._maximiseLabel=n.maximiseLabel,this._minimiseEnabled=n.minimiseEnabled,this._minimiseLabel=n.minimiseLabel,this._closeEnabled=n.closeEnabled,this._closeLabel=n.closeLabel,this._tabDropdownEnabled=n.tabDropdownEnabled,this._tabDropdownLabel=n.tabDropdownLabel,this.setSide(n.side),this._canRemoveComponent=this._configClosable,this._element=document.createElement("section"),this._element.classList.add("lm_header"),this._controlsContainerElement=document.createElement("section"),this._controlsContainerElement.classList.add("lm_controls"),this._element.appendChild(this._tabsContainer.element),this._element.appendChild(this._controlsContainerElement),this._element.appendChild(this._tabsContainer.dropdownElement),this._element.addEventListener("click",this._clickListener,{passive:!0}),this._element.addEventListener("touchstart",this._touchStartListener,{passive:!0}),this._documentMouseUpListener=()=>this._tabsContainer.hideAdditionalTabsDropdown(),globalThis.document.addEventListener("mouseup",this._documentMouseUpListener,{passive:!0}),this._tabControlOffset=this._layoutManager.layoutConfig.settings.tabControlOffset,this._tabDropdownEnabled&&(this._tabDropdownButton=new ht(this,this._tabDropdownLabel,"lm_tabdropdown",(()=>this._tabsContainer.showAdditionalTabsDropdown()))),this._popoutEnabled&&(this._popoutButton=new ht(this,this._popoutLabel,"lm_popout",(()=>this.handleButtonPopoutEvent()))),this._maximiseEnabled&&(this._maximiseButton=new ht(this,this._maximiseLabel,"lm_maximise",(t=>this.handleButtonMaximiseToggleEvent(t)))),this._configClosable&&(this._closeButton=new ht(this,this._closeLabel,"lm_close",(()=>o()))),this.processTabDropdownActiveChanged()}get show(){return this._show}get side(){return this._side}get leftRightSided(){return this._leftRightSided}get layoutManager(){return this._layoutManager}get parent(){return this._parent}get tabs(){return this._tabsContainer.tabs}get lastVisibleTabIndex(){return this._tabsContainer.lastVisibleTabIndex}get element(){return this._element}get tabsContainerElement(){return this._tabsContainer.element}get controlsContainerElement(){return this._controlsContainerElement}destroy(){this.emit("destroy"),this._popoutEvent=void 0,this._maximiseToggleEvent=void 0,this._clickEvent=void 0,this._touchStartEvent=void 0,this._componentRemoveEvent=void 0,this._componentFocusEvent=void 0,this._componentDragStartEvent=void 0,this._tabsContainer.destroy(),globalThis.document.removeEventListener("mouseup",this._documentMouseUpListener),this._element.remove()}createTab(t,e){this._tabsContainer.createTab(t,e)}removeTab(t){this._tabsContainer.removeTab(t)}processActiveComponentChanged(t){this._tabsContainer.processActiveComponentChanged(t),this.updateTabSizes()}setSide(t){this._side=t,this._leftRightSided=[w.right,w.left].includes(this._side)}setRowColumnClosable(t){this._rowColumnClosable=t,this.updateClosability()}updateClosability(){let t;if(this._configClosable)if(this._rowColumnClosable){t=!0;const e=this.tabs.length;for(let n=0;n<e;n++)if(!this._tabsContainer.tabs[n].componentItem.isClosable){t=!1;break}}else t=!1;else t=!1;null!==this._closeButton&&Z(this._closeButton.element,t),null!==this._popoutButton&&Z(this._popoutButton.element,t),this._canRemoveComponent=t||this._tabsContainer.tabCount>1}applyFocusedValue(t){t?this._element.classList.add("lm_focused"):this._element.classList.remove("lm_focused")}processMaximised(){if(void 0===this._maximiseButton)throw new u("HPMAX16997");this._maximiseButton.element.setAttribute("title",this._minimiseLabel)}processMinimised(){if(void 0===this._maximiseButton)throw new u("HPMIN16997");this._maximiseButton.element.setAttribute("title",this._maximiseLabel)}updateTabSizes(){if(this._tabsContainer.tabCount>0){const t=this._show?this._layoutManager.layoutConfig.dimensions.headerHeight:0;let e;this._leftRightSided?(this._element.style.height="",this._element.style.width=$(t)):(this._element.style.width="",this._element.style.height=$(t)),e=this._leftRightSided?this._element.offsetHeight-this._controlsContainerElement.offsetHeight-this._tabControlOffset:this._element.offsetWidth-this._controlsContainerElement.offsetWidth-this._tabControlOffset,this._tabsContainer.updateTabSizes(e,this._getActiveComponentItemEvent())}}handleTabInitiatedComponentRemoveEvent(t){if(this._canRemoveComponent){if(void 0===this._componentRemoveEvent)throw new u("HHTCE22294");this._componentRemoveEvent(t)}}handleTabInitiatedComponentFocusEvent(t){if(void 0===this._componentFocusEvent)throw new u("HHTAE22294");this._componentFocusEvent(t)}handleTabInitiatedDragStartEvent(t,e,n,i){if(this._canRemoveComponent){if(void 0===this._componentDragStartEvent)throw new u("HHTDSE22294");this._componentDragStartEvent(t,e,n,i)}else n.cancelDrag()}processTabDropdownActiveChanged(){void 0!==this._tabDropdownButton&&Z(this._tabDropdownButton.element,this._tabsContainer.dropdownActive)}handleButtonPopoutEvent(){if(this._layoutManager.layoutConfig.settings.popoutWholeStack){if(void 0===this._popoutEvent)throw new u("HHBPOE17834");this._popoutEvent()}else{const t=this._getActiveComponentItemEvent();t&&t.popout()}}handleButtonMaximiseToggleEvent(t){if(void 0===this._maximiseToggleEvent)throw new u("HHBMTE16834");this._maximiseToggleEvent()}onClick(t){t.target===this._element&&this.notifyClick(t)}onTouchStart(t){t.target===this._element&&this.notifyTouchStart(t)}notifyClick(t){if(void 0===this._clickEvent)throw new u("HNHC46834");this._clickEvent(t)}notifyTouchStart(t){if(void 0===this._touchStartEvent)throw new u("HNHTS46834");this._touchStartEvent(t)}}class mt extends st{constructor(t,e,n){var i,r,o,s,a,c,d,l,h,u,p,f,m,g,y,v,_,C,b;super(t,e,n,mt.createElement(document)),this._headerSideChanged=!1,this._resizeListener=()=>this.handleResize(),this._maximisedListener=()=>this.handleMaximised(),this._minimisedListener=()=>this.handleMinimised(),this._headerConfig=e.header;const I=t.layoutConfig.header,E=e.content;let x;x=1!==E.length?void 0:E[0].header,this._initialWantMaximise=e.maximised,this._initialActiveItemIndex=null!==(i=e.activeItemIndex)&&void 0!==i?i:0;const S=null!==(s=null!==(o=null===(r=this._headerConfig)||void 0===r?void 0:r.show)&&void 0!==o?o:null==x?void 0:x.show)&&void 0!==s?s:I.show,A=null!==(d=null!==(c=null===(a=this._headerConfig)||void 0===a?void 0:a.popout)&&void 0!==c?c:null==x?void 0:x.popout)&&void 0!==d?d:I.popout,P=null!==(u=null!==(h=null===(l=this._headerConfig)||void 0===l?void 0:l.maximise)&&void 0!==h?h:null==x?void 0:x.maximise)&&void 0!==u?u:I.maximise,M=null!==(m=null!==(f=null===(p=this._headerConfig)||void 0===p?void 0:p.close)&&void 0!==f?f:null==x?void 0:x.close)&&void 0!==m?m:I.close,L=null!==(v=null!==(y=null===(g=this._headerConfig)||void 0===g?void 0:g.minimise)&&void 0!==y?y:null==x?void 0:x.minimise)&&void 0!==v?v:I.minimise,R=null!==(b=null!==(C=null===(_=this._headerConfig)||void 0===_?void 0:_.tabDropdown)&&void 0!==C?C:null==x?void 0:x.tabDropdown)&&void 0!==b?b:I.tabDropdown;this._maximisedEnabled=!1!==P;const O={show:!1!==S,side:!1===S?w.top:S,popoutEnabled:!1!==A,popoutLabel:!1===A?"":A,maximiseEnabled:this._maximisedEnabled,maximiseLabel:!1===P?"":P,closeEnabled:!1!==M,closeLabel:!1===M?"":M,minimiseEnabled:!0,minimiseLabel:L,tabDropdownEnabled:!1!==R,tabDropdownLabel:!1===R?"":R};this._header=new ft(t,this,O,e.isClosable&&!1!==M,(()=>this.getActiveComponentItem()),(()=>this.remove()),(()=>this.handlePopoutEvent()),(()=>this.toggleMaximise()),(t=>this.handleHeaderClickEvent(t)),(t=>this.handleHeaderTouchStartEvent(t)),(t=>this.handleHeaderComponentRemoveEvent(t)),(t=>this.handleHeaderComponentFocusEvent(t)),((t,e,n,i)=>this.handleHeaderComponentStartDragEvent(t,e,n,i))),this.isStack=!0,this._childElementContainer=document.createElement("section"),this._childElementContainer.classList.add("lm_items"),this.on("resize",this._resizeListener),this._maximisedEnabled&&(this.on("maximised",this._maximisedListener),this.on("minimised",this._minimisedListener)),this.element.appendChild(this._header.element),this.element.appendChild(this._childElementContainer),this.setupHeaderPosition(),this._header.updateClosability()}get childElementContainer(){return this._childElementContainer}get header(){return this._header}get headerShow(){return this._header.show}get headerSide(){return this._header.side}get headerLeftRightSided(){return this._header.leftRightSided}get contentAreaDimensions(){return this._contentAreaDimensions}get initialWantMaximise(){return this._initialWantMaximise}get isMaximised(){return this===this.layoutManager.maximisedStack}get stackParent(){if(!this.parent)throw new Error("Stack should always have a parent");return this.parent}updateSize(t){this.layoutManager.beginVirtualSizedContainerAdding();try{this.updateNodeSize(),this.updateContentItemsSize(t)}finally{this.layoutManager.endVirtualSizedContainerAdding()}}init(){if(!0===this.isInitialised)return;this.updateNodeSize();for(let t=0;t<this.contentItems.length;t++)this._childElementContainer.appendChild(this.contentItems[t].element);super.init();const t=this.contentItems,e=t.length;if(e>0){if(this._initialActiveItemIndex<0||this._initialActiveItemIndex>=e)throw new Error(`ActiveItemIndex out of range: ${this._initialActiveItemIndex} id: ${this.id}`);for(let n=0;n<e;n++){const e=t[n];if(!(e instanceof ot))throw new Error(`Stack Content Item is not of type ComponentItem: ${n} id: ${this.id}`);this._header.createTab(e,n),e.hide(),e.container.setBaseLogicalZIndex()}this.setActiveComponentItem(t[this._initialActiveItemIndex],!1),this._header.updateTabSizes()}this._header.updateClosability(),this.initContentItems()}setActiveContentItem(t){if(!rt.isComponentItem(t))throw new Error("Stack.setActiveContentItem: item is not a ComponentItem");this.setActiveComponentItem(t,!1)}setActiveComponentItem(t,e,n=!1){if(this._activeComponentItem!==t){if(-1===this.contentItems.indexOf(t))throw new Error("componentItem is not a child of this stack");this.layoutManager.beginSizeInvalidation();try{void 0!==this._activeComponentItem&&this._activeComponentItem.hide(),this._activeComponentItem=t,this._header.processActiveComponentChanged(t),t.show()}finally{this.layoutManager.endSizeInvalidation()}this.emit("activeContentItemChanged",t),this.layoutManager.emit("activeContentItemChanged",t),this.emitStateChangedEvent()}(this.focused||e)&&this.layoutManager.setFocusedComponentItem(t,n)}getActiveContentItem(){var t;return null!==(t=this.getActiveComponentItem())&&void 0!==t?t:null}getActiveComponentItem(){return this._activeComponentItem}focusActiveContentItem(){var t;null===(t=this._activeComponentItem)||void 0===t||t.focus()}setFocusedValue(t){this._header.applyFocusedValue(t),super.setFocusedValue(t)}setRowColumnClosable(t){this._header.setRowColumnClosable(t)}newComponent(t,e,n,i){const r={type:"component",componentType:t,componentState:e,title:n};return this.newItem(r,i)}addComponent(t,e,n,i){const r={type:"component",componentType:t,componentState:e,title:n};return this.addItem(r,i)}newItem(t,e){return e=this.addItem(t,e),this.contentItems[e]}addItem(t,e){this.layoutManager.checkMinimiseMaximisedStack();const n=k.resolve(t,!1),i=this.layoutManager.createAndInitContentItem(n,this);return this.addChild(i,e)}addChild(t,e,n=!1){if(void 0!==e&&e>this.contentItems.length)throw e-=1,new d("SAC99728");if(t instanceof ot)return e=super.addChild(t,e),this._childElementContainer.appendChild(t.element),this._header.createTab(t,e),this.setActiveComponentItem(t,n),this._header.updateTabSizes(),this.updateSize(!1),t.container.setBaseLogicalZIndex(),this._header.updateClosability(),this.emitStateChangedEvent(),e;throw new d("SACC88532")}removeChild(t,e){const n=t,i=this.contentItems.indexOf(n),r=1===this.contentItems.length;if(this._activeComponentItem===n&&(n.focused&&n.blur(),!r)){const t=0===i?1:i-1;this.setActiveComponentItem(this.contentItems[t],!1)}this._header.removeTab(n),super.removeChild(n,e),r||this._header.updateClosability(),this.emitStateChangedEvent()}toggleMaximise(){this.isMaximised?this.minimise():this.maximise()}maximise(){if(!this.isMaximised){this.layoutManager.setMaximisedStack(this);const t=this.contentItems,e=t.length;for(let n=0;n<e;n++){const e=t[n];if(!(e instanceof ot))throw new d("SMAXI87773");e.enterStackMaximised()}this.emitStateChangedEvent()}}minimise(){if(this.isMaximised){this.layoutManager.setMaximisedStack(void 0);const t=this.contentItems,e=t.length;for(let n=0;n<e;n++){const e=t[n];if(!(e instanceof ot))throw new d("SMINI87773");e.exitStackMaximised()}this.emitStateChangedEvent()}}destroy(){var t;(null===(t=this._activeComponentItem)||void 0===t?void 0:t.focused)&&this._activeComponentItem.blur(),super.destroy(),this.off("resize",this._resizeListener),this._maximisedEnabled&&(this.off("maximised",this._maximisedListener),this.off("minimised",this._minimisedListener)),this._header.destroy()}toConfig(){let t;if(this._activeComponentItem&&(t=this.contentItems.indexOf(this._activeComponentItem),t<0))throw new Error("active component item not found in stack");if(this.contentItems.length>0&&void 0===t)throw new Error("expected non-empty stack to have an active component item");return{type:"stack",content:this.calculateConfigContent(),size:this.size,sizeUnit:this.sizeUnit,minSize:this.minSize,minSizeUnit:this.minSizeUnit,id:this.id,isClosable:this.isClosable,maximised:this.isMaximised,header:this.createHeaderConfig(),activeItemIndex:t}}onDrop(t,e){if("header"===this._dropSegment){if(this.resetHeaderDropZone(),void 0===this._dropIndex)throw new u("SODDI68990");return void this.addChild(t,this._dropIndex)}if("body"===this._dropSegment)return void this.addChild(t,0,!0);const n="top"===this._dropSegment||"bottom"===this._dropSegment,i="left"===this._dropSegment||"right"===this._dropSegment,r="top"===this._dropSegment||"left"===this._dropSegment,o=n&&this.stackParent.isColumn||i&&this.stackParent.isRow;if(t.isComponent){const e=A.createDefault();e.header=this.createHeaderConfig();const n=this.layoutManager.createAndInitContentItem(e,this);n.addChild(t),t=n}if(t.type===C.row||t.type===C.column){const e=A.createDefault();e.header=this.createHeaderConfig();const n=this.layoutManager.createContentItem(e,this);n.addChild(t),t=n}if(o){const e=this.stackParent.contentItems.indexOf(this);this.stackParent.addChild(t,r?e:e+1,!0),this.size*=.5,t.size=this.size,t.sizeUnit=this.sizeUnit,this.stackParent.updateSize(!1)}else{const e=n?C.column:C.row,i=x.createDefault(e),o=this.layoutManager.createContentItem(i,this);this.stackParent.replaceChild(this,o),o.addChild(t,r?0:void 0,!0),o.addChild(this,r?void 0:0,!0),this.size=50,t.size=50,t.sizeUnit=I.Percent,o.updateSize(!1)}}highlightDropZone(t,e){for(const n in this._contentAreaDimensions){const i=n,r=this._contentAreaDimensions[i].hoverArea;if(r.x1<t&&r.x2>t&&r.y1<e&&r.y2>e)return void("header"===i?(this._dropSegment="header",this.highlightHeaderDropZone(this._header.leftRightSided?e:t)):(this.resetHeaderDropZone(),this.highlightBodyDropZone(i)))}}getArea(){if("none"===this.element.style.display)return null;const t=super.getElementArea(this._header.element),e=super.getElementArea(this._childElementContainer);if(null===t||null===e)throw new h("SGAHC13086");const n=e.x2-e.x1,i=e.y2-e.y1;return this._contentAreaDimensions={header:{hoverArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2},highlightArea:{x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}}},0===this.contentItems.length?(this._contentAreaDimensions.body={hoverArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2}},super.getElementArea(this.element)):(this._contentAreaDimensions.left={hoverArea:{x1:e.x1,y1:e.y1,x2:e.x1+.25*n,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x1+.5*n,y2:e.y2}},this._contentAreaDimensions.top={hoverArea:{x1:e.x1+.25*n,y1:e.y1,x2:e.x1+.75*n,y2:e.y1+.5*i},highlightArea:{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y1+.5*i}},this._contentAreaDimensions.right={hoverArea:{x1:e.x1+.75*n,y1:e.y1,x2:e.x2,y2:e.y2},highlightArea:{x1:e.x1+.5*n,y1:e.y1,x2:e.x2,y2:e.y2}},this._contentAreaDimensions.bottom={hoverArea:{x1:e.x1+.25*n,y1:e.y1+.5*i,x2:e.x1+.75*n,y2:e.y2},highlightArea:{x1:e.x1,y1:e.y1+.5*i,x2:e.x2,y2:e.y2}},super.getElementArea(this.element))}positionHeader(t){this._header.side!==t&&(this._header.setSide(t),this._headerSideChanged=!0,this.setupHeaderPosition())}updateNodeSize(){if("none"!==this.element.style.display){const t=q(this.element);this._header.show&&(t[this._header.leftRightSided?g.width:g.height]-=this.layoutManager.layoutConfig.dimensions.headerHeight),this._childElementContainer.style.width=$(t.width),this._childElementContainer.style.height=$(t.height);for(let e=0;e<this.contentItems.length;e++)this.contentItems[e].element.style.width=$(t.width),this.contentItems[e].element.style.height=$(t.height);this.emit("resize"),this.emitStateChangedEvent()}}highlightHeaderDropZone(t){const e=this._header.lastVisibleTabIndex+1,n=this._header.tabsContainerElement.childNodes,i=new Array(e);let r=0,o=0;for(;o<e;){const t=n[r++];t!==this.layoutManager.tabDropPlaceholder&&(i[o++]=t)}const s=this.layoutManager.dropTargetIndicator;if(null===s)throw new h("SHHDZDTI97110");let a;if(0===e){const t=this._header.element.getBoundingClientRect(),e=t.top+document.body.scrollTop,n=t.left+document.body.scrollLeft;a={x1:n,x2:n+100,y1:e+t.height-20,y2:e+t.height},this._dropIndex=0}else{let n,r,o,s,c=0,d=!1;do{s=i[c];const e=s.getBoundingClientRect(),a=e.top+document.body.scrollTop,l=e.left+document.body.scrollLeft;this._header.leftRightSided?(r=a,n=l,o=e.height):(r=l,n=a,o=e.width),t>=r&&t<r+o?d=!0:c++}while(c<e&&!d);if(!1===d&&t<r)return;t<r+o/2?(this._dropIndex=c,s.insertAdjacentElement("beforebegin",this.layoutManager.tabDropPlaceholder)):(this._dropIndex=Math.min(c+1,e),s.insertAdjacentElement("afterend",this.layoutManager.tabDropPlaceholder));const l=this.layoutManager.tabDropPlaceholder.getBoundingClientRect(),h=l.top+document.body.scrollTop,u=l.left+document.body.scrollLeft,p=l.width;if(this._header.leftRightSided){const t=h;a={x1:n,x2:n+s.clientHeight,y1:t,y2:t+p}}else a={x1:u,x2:u+p,y1:n,y2:n+s.clientHeight}}s.highlightArea(a,0)}resetHeaderDropZone(){this.layoutManager.tabDropPlaceholder.remove()}setupHeaderPosition(){Z(this._header.element,this._header.show),this.element.classList.remove("lm_left","lm_right","lm_bottom"),this._header.leftRightSided&&this.element.classList.add("lm_"+this._header.side),this.updateSize(!1)}highlightBodyDropZone(t){if(void 0===this._contentAreaDimensions)throw new u("SHBDZC82265");{const e=this._contentAreaDimensions[t].highlightArea,n=this.layoutManager.dropTargetIndicator;if(null===n)throw new h("SHBDZD96110");n.highlightArea(e,1),this._dropSegment=t}}handleResize(){this._header.updateTabSizes()}handleMaximised(){this._header.processMaximised()}handleMinimised(){this._header.processMinimised()}handlePopoutEvent(){this.popout()}handleHeaderClickEvent(t){const e=et.headerClickEventName,n=new et.ClickBubblingEvent(e,this,t);this.emit(e,n)}handleHeaderTouchStartEvent(t){const e=et.headerTouchStartEventName,n=new et.TouchStartBubblingEvent(e,this,t);this.emit(e,n)}handleHeaderComponentRemoveEvent(t){this.removeChild(t,!1)}handleHeaderComponentFocusEvent(t){this.setActiveComponentItem(t,!0)}handleHeaderComponentStartDragEvent(t,e,n,i){!0===this.isMaximised&&this.toggleMaximise(),this.layoutManager.startComponentDrag(t,e,n,i,this)}createHeaderConfig(){if(this._headerSideChanged){const t=!!this._header.show&&this._header.side;let e=S.Header.createCopy(this._headerConfig,t);return void 0===e&&(e={show:t,popout:void 0,maximise:void 0,close:void 0,minimise:void 0,tabDropdown:void 0}),e}return S.Header.createCopy(this._headerConfig)}emitStateChangedEvent(){this.emitBaseBubblingEvent("stateChanged")}}!function(t){t.createElement=function(t){const e=t.createElement("div");return e.classList.add("lm_item"),e.classList.add("lm_stack"),e}}(mt||(mt={}));class gt extends et{constructor(t,e,n,i,r,o){if(super(),this._dragListener=n,this._layoutManager=i,this._componentItem=r,this._originalParent=o,this._area=null,this._lastValidArea=null,this._dragListener.on("drag",((t,e,n)=>this.onDrag(t,e,n))),this._dragListener.on("dragStop",(()=>this.onDrop())),this.createDragProxyElements(t,e),null===this._componentItem.parent)throw new h("DPC10097");this._componentItemFocused=this._componentItem.focused,this._componentItemFocused&&this._componentItem.blur(),this._componentItem.parent.removeChild(this._componentItem,!0),this.setDimensions(),document.body.appendChild(this._element),this.determineMinMaxXY(),this._layoutManager.calculateItemAreas(),this.setDropPosition(t,e)}get element(){return this._element}createDragProxyElements(t,e){this._element=document.createElement("div"),this._element.classList.add("lm_dragProxy");const n=document.createElement("div");n.classList.add("lm_header");const i=document.createElement("div");i.classList.add("lm_tabs");const r=document.createElement("div");r.classList.add("lm_tab");const o=document.createElement("span");o.classList.add("lm_title"),r.appendChild(o),i.appendChild(r),n.appendChild(i),this._proxyContainerElement=document.createElement("div"),this._proxyContainerElement.classList.add("lm_content"),this._element.appendChild(n),this._element.appendChild(this._proxyContainerElement),this._originalParent instanceof mt&&this._originalParent.headerShow&&(this._sided=this._originalParent.headerLeftRightSided,this._element.classList.add("lm_"+this._originalParent.headerSide),[w.right,w.bottom].indexOf(this._originalParent.headerSide)>=0&&this._proxyContainerElement.insertAdjacentElement("afterend",n)),this._element.style.left=$(t),this._element.style.top=$(e),r.setAttribute("title",this._componentItem.title),o.insertAdjacentText("afterbegin",this._componentItem.title),this._proxyContainerElement.appendChild(this._componentItem.element)}determineMinMaxXY(){const t=this._layoutManager.groundItem;if(void 0===t)throw new u("DPDMMXY73109");{const e=t.element.getBoundingClientRect();this._minX=e.left+document.body.scrollLeft,this._minY=e.top+document.body.scrollTop,this._maxX=this._minX+e.width,this._maxY=this._minY+e.height}}onDrag(t,e,n){const i=n.pageX,r=n.pageY;this.setDropPosition(i,r),this._componentItem.drag()}setDropPosition(t,e){this._layoutManager.layoutConfig.settings.constrainDragToContainer&&(t<=this._minX?t=Math.ceil(this._minX):t>=this._maxX&&(t=Math.floor(this._maxX)),e<=this._minY?e=Math.ceil(this._minY):e>=this._maxY&&(e=Math.floor(this._maxY))),this._element.style.left=$(t),this._element.style.top=$(e),this._area=this._layoutManager.getArea(t,e),null!==this._area&&(this._lastValidArea=this._area,this._area.contentItem.highlightDropZone(t,e,this._area))}onDrop(){const t=this._layoutManager.dropTargetIndicator;if(null===t)throw new h("DPOD30011");let e;t.hide(),this._componentItem.exitDragMode(),null!==this._area?(e=this._componentItem,this._area.contentItem.onDrop(e,this._area)):null!==this._lastValidArea?(e=this._componentItem,this._lastValidArea.contentItem.onDrop(e,this._lastValidArea)):this._originalParent?(e=this._componentItem,this._originalParent.addChild(e)):this._componentItem.destroy(),this._element.remove(),this._layoutManager.emit("itemDropped",this._componentItem),this._componentItemFocused&&void 0!==e&&e.focus()}setDimensions(){const t=this._layoutManager.layoutConfig.dimensions;if(void 0===t)throw new Error("DragProxy.setDimensions: dimensions undefined");let e=t.dragProxyWidth,n=t.dragProxyHeight;if(void 0===e||void 0===n)throw new Error("DragProxy.setDimensions: width and/or height undefined");const i=!1===this._layoutManager.layoutConfig.header.show?0:t.headerHeight;this._element.style.width=$(e),this._element.style.height=$(n),e-=this._sided?i:0,n-=this._sided?0:i,this._proxyContainerElement.style.width=$(e),this._proxyContainerElement.style.height=$(n),this._componentItem.enterDragMode(e,n),this._componentItem.show()}}class wt{constructor(t,e,n,i,r,o,s){this._layoutManager=t,this._element=e,this._extraAllowableChildTargets=n,this._componentTypeOrFtn=i,this._componentState=r,this._title=o,this._id=s,this._dragListener=null,this._dummyGroundContainer=document.createElement("div");const a=M.createDefault("row");this._dummyGroundContentItem=new lt(this._layoutManager,a,this._dummyGroundContainer),this.createDragListener()}destroy(){this.removeDragListener()}createDragListener(){this.removeDragListener(),this._dragListener=new at(this._element,this._extraAllowableChildTargets),this._dragListener.on("dragStart",((t,e)=>this.onDragStart(t,e))),this._dragListener.on("dragStop",(()=>this.onDragStop()))}onDragStart(t,e){var n;const i="component";let r;if("function"==typeof this._componentTypeOrFtn){const t=this._componentTypeOrFtn();r=wt.isDragSourceComponentItemConfig(t)?{type:i,componentState:t.state,componentType:t.type,title:null!==(n=t.title)&&void 0!==n?n:this._title}:t}else r={type:i,componentState:this._componentState,componentType:this._componentTypeOrFtn,title:this._title,id:this._id};const o=F.resolve(r,!1),s=new ot(this._layoutManager,o,this._dummyGroundContentItem);if(this._dummyGroundContentItem.contentItems.push(s),null===this._dragListener)throw new h("DSODSD66746");{const n=new gt(t,e,this._dragListener,this._layoutManager,s,this._dummyGroundContentItem),i=this._layoutManager.transitionIndicator;if(null===i)throw new h("DSODST66746");i.transitionElements(this._element,n.element)}}onDragStop(){this.createDragListener()}removeDragListener(){null!==this._dragListener&&(this._dragListener.destroy(),this._dragListener=null)}}!function(t){t.isDragSourceComponentItemConfig=function(t){return!("componentType"in t)}}(wt||(wt={}));class yt{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_dropTargetIndicator");const t=document.createElement("div");t.classList.add("lm_inner"),this._element.appendChild(t),document.body.appendChild(this._element)}destroy(){this._element.remove()}highlightArea(t,e){this._element.style.left=$(t.x1+e),this._element.style.top=$(t.y1+e),this._element.style.width=$(t.x2-t.x1-e),this._element.style.height=$(t.y2-t.y1-e),this._element.style.display="block"}hide(){Z(this._element,!1)}}class vt{constructor(){this._element=document.createElement("div"),this._element.classList.add("lm_transition_indicator"),document.body.appendChild(this._element),this._toElement=null,this._fromDimensions=null,this._totalAnimationDuration=200,this._animationStartTime=null}destroy(){this._element.remove()}transitionElements(t,e){}nextAnimationFrame(){}measure(t){const e=t.getBoundingClientRect();return{left:e.left,top:e.top,width:t.offsetWidth,height:t.offsetHeight}}}class _t extends et{constructor(t){super(),this._layoutManager=t,this._childEventListener=t=>this.onEventFromChild(t),globalThis.addEventListener(_t.ChildEventName,this._childEventListener,{passive:!0})}emit(t,...e){"userBroadcast"===t?this.emitUserBroadcast(...e):super.emit(t,...e)}emitUserBroadcast(...t){this.handleUserBroadcastEvent("userBroadcast",t)}destroy(){globalThis.removeEventListener(_t.ChildEventName,this._childEventListener)}handleUserBroadcastEvent(t,e){this._layoutManager.isSubWindow?this.propagateToParent(t,e):this.propagateToThisAndSubtree(t,e)}onEventFromChild(t){const e=t.detail;this.handleUserBroadcastEvent(e.eventName,e.args)}propagateToParent(t,e){const n={bubbles:!0,cancelable:!0,detail:{layoutManager:this._layoutManager,eventName:t,args:e}},i=new CustomEvent(_t.ChildEventName,n),r=globalThis.opener;if(null===r)throw new h("EHPTP15778");r.dispatchEvent(i)}propagateToThisAndSubtree(t,e){this.emitUnknown(t,...e);for(let n=0;n<this._layoutManager.openPopouts.length;n++){const i=this._layoutManager.openPopouts[n].getGlInstance();i&&i.eventHub.propagateToThisAndSubtree(t,e)}}}!function(t){t.ChildEventName="gl_child_event"}(_t||(_t={}));class Ct extends et{constructor(t){super(),this.resizeWithContainerAutomatically=!1,this.resizeDebounceInterval=100,this.resizeDebounceExtendedWhenPossible=!0,this._isInitialised=!1,this._groundItem=void 0,this._openPopouts=[],this._dropTargetIndicator=null,this._transitionIndicator=null,this._itemAreas=[],this._maximisePlaceholder=Ct.createMaximisePlaceElement(document),this._tabDropPlaceholder=Ct.createTabDropPlaceholderElement(document),this._dragSources=[],this._updatingColumnsResponsive=!1,this._firstLoad=!0,this._eventHub=new _t(this),this._width=null,this._height=null,this._virtualSizedContainers=[],this._virtualSizedContainerAddingBeginCount=0,this._sizeInvalidationBeginCount=0,this._resizeObserver=new ResizeObserver((()=>this.handleContainerResize())),this._windowBeforeUnloadListener=()=>this.onBeforeUnload(),this._windowBeforeUnloadListening=!1,this._maximisedStackBeforeDestroyedListener=t=>this.cleanupBeforeMaximisedStackDestroyed(t),this.isSubWindow=t.isSubWindow,this._constructorOrSubWindowLayoutConfig=t.constructorOrSubWindowLayoutConfig,p.checkInitialise(),E.checkInitialise(),void 0!==t.containerElement&&(this._containerElement=t.containerElement)}get container(){return this._containerElement}get isInitialised(){return this._isInitialised}get groundItem(){return this._groundItem}get root(){return this._groundItem}get openPopouts(){return this._openPopouts}get dropTargetIndicator(){return this._dropTargetIndicator}get transitionIndicator(){return this._transitionIndicator}get width(){return this._width}get height(){return this._height}get eventHub(){return this._eventHub}get rootItem(){if(void 0===this._groundItem)throw new Error("Cannot access rootItem before init");return 0===this._groundItem.contentItems.length?void 0:this._groundItem.contentItems[0]}get focusedComponentItem(){return this._focusedComponentItem}get tabDropPlaceholder(){return this._tabDropPlaceholder}get maximisedStack(){return this._maximisedStack}get deprecatedConstructor(){return!this.isSubWindow&&void 0!==this._constructorOrSubWindowLayoutConfig}destroy(){if(this._isInitialised){this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1),!0===this.layoutConfig.settings.closePopoutsOnUnload&&this.closeAllOpenPopouts(),this._resizeObserver.disconnect(),this.checkClearResizeTimeout(),void 0!==this._groundItem&&this._groundItem.destroy(),this._tabDropPlaceholder.remove(),null!==this._dropTargetIndicator&&this._dropTargetIndicator.destroy(),null!==this._transitionIndicator&&this._transitionIndicator.destroy(),this._eventHub.destroy();for(const t of this._dragSources)t.destroy();this._dragSources=[],this._isInitialised=!1}}minifyConfig(t){return O.minifyConfig(t)}unminifyConfig(t){return O.unminifyConfig(t)}init(){let t;if(this.setContainer(),this._dropTargetIndicator=new yt,this._transitionIndicator=new vt,this.updateSizeFromContainer(),this.isSubWindow){if(void 0===this._constructorOrSubWindowLayoutConfig)throw new u("LMIU07155");{const e=this._constructorOrSubWindowLayoutConfig.root;if(void 0===e)throw new d("LMIC07156");if(!k.isComponent(e))throw new d("LMIC07157");t=e;const n=j.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},n),{root:void 0})}}else void 0===this._constructorOrSubWindowLayoutConfig?this.layoutConfig=O.createDefault():this.layoutConfig=j.resolve(this._constructorOrSubWindowLayoutConfig);const e=this.layoutConfig;this._groundItem=new lt(this,e.root,this._containerElement),this._groundItem.init(),this.checkLoadedLayoutMaximiseItem(),this._resizeObserver.observe(this._containerElement),this._isInitialised=!0,this.adjustColumnsResponsive(),this.emit("initialised"),void 0!==t&&this.loadComponentAsRoot(t)}loadLayout(t){if(!this.isInitialised)throw new Error("GoldenLayout: Need to call init() if LayoutConfig with defined root passed to constructor");if(void 0===this._groundItem)throw new u("LMLL11119");this.createSubWindows(),this.layoutConfig=j.resolve(t),this._groundItem.loadRoot(this.layoutConfig.root),this.checkLoadedLayoutMaximiseItem(),this.adjustColumnsResponsive()}saveLayout(){if(!1===this._isInitialised)throw new Error("Can't create config, layout not yet initialised");if(void 0===this._groundItem)throw new u("LMTC18244");{const t=this._groundItem.calculateConfigContent();let e;e=1!==t.length?void 0:t[0],this.reconcilePopoutWindows();const n=[];for(let t=0;t<this._openPopouts.length;t++)n.push(this._openPopouts[t].toConfig());return{root:e,openPopouts:n,settings:O.Settings.createCopy(this.layoutConfig.settings),dimensions:O.Dimensions.createCopy(this.layoutConfig.dimensions),header:O.Header.createCopy(this.layoutConfig.header),resolved:!0}}}clear(){if(void 0===this._groundItem)throw new u("LMCL11129");this._groundItem.clearRoot()}toConfig(){return this.saveLayout()}newComponent(t,e,n){const i=this.newComponentAtLocation(t,e,n);if(void 0===i)throw new d("LMNC65588");return i}newComponentAtLocation(t,e,n,i){if(void 0===this._groundItem)throw new Error("Cannot add component before init");{const r=this.addComponentAtLocation(t,e,n,i);if(void 0===r)return;{const t=r.parentItem.contentItems[r.index];if(rt.isComponentItem(t))return t;throw new d("LMNC992877533")}}}addComponent(t,e,n){const i=this.addComponentAtLocation(t,e,n);if(void 0===i)throw new d("LMAC99943");return i}addComponentAtLocation(t,e,n,i){const r={type:"component",componentType:t,componentState:e,title:n};return this.addItemAtLocation(r,i)}newItem(t){const e=this.newItemAtLocation(t);if(void 0===e)throw new d("LMNC65588");return e}newItemAtLocation(t,e){if(void 0===this._groundItem)throw new Error("Cannot add component before init");{const n=this.addItemAtLocation(t,e);if(void 0===n)return;return n.parentItem.contentItems[n.index]}}addItem(t){const e=this.addItemAtLocation(t);if(void 0===e)throw new d("LMAI99943");return e}addItemAtLocation(t,e){if(void 0===this._groundItem)throw new Error("Cannot add component before init");{void 0===e&&(e=Ct.defaultLocationSelectors);const n=this.findFirstLocation(e);if(void 0===n)return;{let e,i=n.parentItem;switch(i.type){case C.ground:e=i.addItem(t,n.index),e>=0?i=this._groundItem.contentItems[0]:e=0;break;case C.row:case C.column:e=i.addItem(t,n.index);break;case C.stack:if(k.isComponent(t)){e=i.addItem(t,n.index);break}throw Error(f[6]);case C.component:throw new d("LMAIALC87444602");default:throw new l("LMAIALU98881733",i.type)}if(k.isComponent(t)){const t=i.contentItems[e];rt.isStack(t)&&(i=t,e=0)}return n.parentItem=i,n.index=e,n}}}loadComponentAsRoot(t){if(void 0===this._groundItem)throw new Error("Cannot add item before init");this._groundItem.loadComponentAsRoot(t)}updateSize(t,e){this.setSize(t,e)}setSize(t,e){if(this._width=t,this._height=e,!0===this._isInitialised){if(void 0===this._groundItem)throw new u("LMUS18881");if(this._groundItem.setSize(this._width,this._height),this._maximisedStack){const{width:t,height:e}=q(this._containerElement);G(this._maximisedStack.element,t),V(this._maximisedStack.element,e),this._maximisedStack.updateSize(!1)}this.adjustColumnsResponsive()}}beginSizeInvalidation(){this._sizeInvalidationBeginCount++}endSizeInvalidation(){0==--this._sizeInvalidationBeginCount&&this.updateSizeFromContainer()}updateSizeFromContainer(){const{width:t,height:e}=q(this._containerElement);this.setSize(t,e)}updateRootSize(t=!1){if(void 0===this._groundItem)throw new u("LMURS28881");this._groundItem.updateSize(t)}createAndInitContentItem(t,e){const n=this.createContentItem(t,e);return n.init(),n}createContentItem(t,e){if("string"!=typeof t.type)throw new r("Missing parameter 'type'",JSON.stringify(t));return!x.isComponentItem(t)||e instanceof mt||!e||!0===this.isSubWindow&&e instanceof lt||(t={type:C.stack,content:[t],size:t.size,sizeUnit:t.sizeUnit,minSize:t.minSize,minSizeUnit:t.minSizeUnit,id:t.id,maximised:t.maximised,isClosable:t.isClosable,activeItemIndex:0,header:void 0}),this.createContentItemFromConfig(t,e)}findFirstComponentItemById(t){if(void 0===this._groundItem)throw new u("LMFFCIBI82446");return this.findFirstContentItemTypeByIdRecursive(C.component,t,this._groundItem)}createPopout(t,e,n,i){return t instanceof rt?this.createPopoutFromContentItem(t,e,n,i):this.createPopoutFromItemConfig(t,e,n,i)}createPopoutFromContentItem(t,e,n,i){let r=t.parent,o=t;for(;null!==r&&1===r.contentItems.length&&!r.isGround;)o=r,r=r.parent;if(null===r)throw new h("LMCPFCI00834");{if(void 0===i&&(i=r.contentItems.indexOf(o)),null!==n&&r.addPopInParentId(n),void 0===e){const n=globalThis.screenX||globalThis.screenLeft,i=globalThis.screenY||globalThis.screenTop,r=t.element.offsetLeft,o=t.element.offsetTop,{width:s,height:a}=q(t.element);e={left:n+r,top:i+o,width:s,height:a}}const s=t.toConfig();if(t.remove(),L.isRootItemConfig(s))return this.createPopoutFromItemConfig(s,e,n,i);throw new Error(`${f[0]}`)}}beginVirtualSizedContainerAdding(){0==++this._virtualSizedContainerAddingBeginCount&&(this._virtualSizedContainers.length=0)}addVirtualSizedContainer(t){this._virtualSizedContainers.push(t)}endVirtualSizedContainerAdding(){if(0==--this._virtualSizedContainerAddingBeginCount){const t=this._virtualSizedContainers.length;if(t>0){this.fireBeforeVirtualRectingEvent(t);for(let e=0;e<t;e++)this._virtualSizedContainers[e].notifyVirtualRectingRequired();this.fireAfterVirtualRectingEvent(),this._virtualSizedContainers.length=0}}}fireBeforeVirtualRectingEvent(t){void 0!==this.beforeVirtualRectingEvent&&this.beforeVirtualRectingEvent(t)}fireAfterVirtualRectingEvent(){void 0!==this.afterVirtualRectingEvent&&this.afterVirtualRectingEvent()}createPopoutFromItemConfig(t,e,n,i){const r=this.toConfig(),o={root:t,openPopouts:[],settings:r.settings,dimensions:r.dimensions,header:r.header,window:e,parentId:n,indexInParent:i,resolved:!0};return this.createPopoutFromPopoutLayoutConfig(o)}createPopoutFromPopoutLayoutConfig(t){var e,n,i,r;const o=t.window,s={left:null!==(e=o.left)&&void 0!==e?e:globalThis.screenX||globalThis.screenLeft+20,top:null!==(n=o.top)&&void 0!==n?n:globalThis.screenY||globalThis.screenTop+20,width:null!==(i=o.width)&&void 0!==i?i:500,height:null!==(r=o.height)&&void 0!==r?r:309},a=new it(t,s,this);return a.on("initialised",(()=>this.emit("windowOpened",a))),a.on("closed",(()=>this.reconcilePopoutWindows())),this._openPopouts.push(a),this.layoutConfig.settings.closePopoutsOnUnload&&!this._windowBeforeUnloadListening&&(globalThis.addEventListener("beforeunload",this._windowBeforeUnloadListener,{passive:!0}),this._windowBeforeUnloadListening=!0),a}closeAllOpenPopouts(){for(let t=0;t<this._openPopouts.length;t++)this._openPopouts[t].close();this._openPopouts.length=0,this._windowBeforeUnloadListening&&(globalThis.removeEventListener("beforeunload",this._windowBeforeUnloadListener),this._windowBeforeUnloadListening=!1)}newDragSource(t,e,n,i,r){const o=new wt(this,t,[],e,n,i,r);return this._dragSources.push(o),o}removeDragSource(t){!function(t,e){const n=e.indexOf(t);if(-1===n)throw new Error("Can't remove item from array. Item is not in the array");e.splice(n,1)}(t,this._dragSources),t.destroy()}startComponentDrag(t,e,n,i,r){new gt(t,e,n,this,i,r)}focusComponent(t,e=!1){t.focus(e)}clearComponentFocus(t=!1){this.setFocusedComponentItem(void 0,t)}setFocusedComponentItem(t,e=!1){if(t!==this._focusedComponentItem){let n;if(void 0===t||(n=t.parentItem),void 0!==this._focusedComponentItem){const t=this._focusedComponentItem;this._focusedComponentItem=void 0,t.setBlurred(e);const i=t.parentItem;n===i?n=void 0:i.setFocusedValue(!1)}void 0!==t&&(this._focusedComponentItem=t,t.setFocused(e),void 0!==n&&n.setFocusedValue(!0))}}createContentItemFromConfig(t,e){switch(t.type){case C.ground:throw new d("LMCCIFC68871");case C.row:return new dt(!1,this,t,e);case C.column:return new dt(!0,this,t,e);case C.stack:return new mt(this,t,e);case C.component:return new ot(this,t,e);default:throw new l("CCC913564",t.type,"Invalid Config Item type specified")}}setMaximisedStack(t){void 0===t?void 0!==this._maximisedStack&&this.processMinimiseMaximisedStack():t!==this._maximisedStack&&(void 0!==this._maximisedStack&&this.processMinimiseMaximisedStack(),this.processMaximiseStack(t))}checkMinimiseMaximisedStack(){void 0!==this._maximisedStack&&this._maximisedStack.minimise()}cleanupBeforeMaximisedStackDestroyed(t){null!==this._maximisedStack&&this._maximisedStack===t.target&&(this._maximisedStack.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),this._maximisedStack=void 0)}closeWindow(){globalThis.setTimeout((()=>globalThis.close()),1)}getArea(t,e){let n=null,i=1/0;for(let r=0;r<this._itemAreas.length;r++){const o=this._itemAreas[r];t>=o.x1&&t<o.x2&&e>=o.y1&&e<o.y2&&i>o.surface&&(i=o.surface,n=o)}return n}calculateItemAreas(){const t=this.getAllContentItems(),e=this._groundItem;if(void 0===e)throw new u("LMCIAR44365");if(1!==t.length){e.contentItems[0].isStack?this._itemAreas=[]:this._itemAreas=e.createSideAreas();for(let e=0;e<t.length;e++){const n=t[e];if(rt.isStack(n)){const t=n.getArea();if(null===t)continue;{this._itemAreas.push(t);const e=n.contentAreaDimensions;if(void 0===e)throw new u("LMCIASC45599");{const t=e.header.highlightArea,i=(t.x2-t.x1)*(t.y2-t.y1),r={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,contentItem:n,surface:i};this._itemAreas.push(r)}}}}}else{const t=e.getElementArea();if(null===t)throw new h("LMCIARA44365");this._itemAreas=[t]}}checkLoadedLayoutMaximiseItem(){if(void 0===this._groundItem)throw new u("LMCLLMI43432");{const t=this._groundItem.getConfigMaximisedItems();if(t.length>0){let e=t[0];if(rt.isComponentItem(e)){const t=e.parent;if(null===t)throw new h("LMXLLMI69999");e=t}if(!rt.isStack(e))throw new d("LMCLLMI19993");e.maximise()}}}processMaximiseStack(t){if(this._maximisedStack=t,t.on("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),t.element.classList.add("lm_maximised"),t.element.insertAdjacentElement("afterend",this._maximisePlaceholder),void 0===this._groundItem)throw new u("LMMXI19993");{this._groundItem.element.prepend(t.element);const{width:e,height:n}=q(this._containerElement);G(t.element,e),V(t.element,n),t.updateSize(!0),t.focusActiveContentItem(),this._maximisedStack.emit("maximised"),this.emit("stateChanged")}}processMinimiseMaximisedStack(){if(void 0===this._maximisedStack)throw new d("LMMMS74422");{const t=this._maximisedStack;if(null===t.parent)throw new h("LMMI13668");t.element.classList.remove("lm_maximised"),this._maximisePlaceholder.insertAdjacentElement("afterend",t.element),this._maximisePlaceholder.remove(),this.updateRootSize(!0),this._maximisedStack=void 0,t.off("beforeItemDestroyed",this._maximisedStackBeforeDestroyedListener),t.emit("minimised"),this.emit("stateChanged")}}reconcilePopoutWindows(){const t=[];for(let e=0;e<this._openPopouts.length;e++)!1===this._openPopouts[e].getWindow().closed?t.push(this._openPopouts[e]):this.emit("windowClosed",this._openPopouts[e]);this._openPopouts.length!==t.length&&(this._openPopouts=t,this.emit("stateChanged"))}getAllContentItems(){if(void 0===this._groundItem)throw new u("LMGACI13130");return this._groundItem.getAllContentItems()}createSubWindows(){for(let t=0;t<this.layoutConfig.openPopouts.length;t++){const e=this.layoutConfig.openPopouts[t];this.createPopoutFromPopoutLayoutConfig(e)}}handleContainerResize(){this.resizeWithContainerAutomatically&&this.processResizeWithDebounce()}processResizeWithDebounce(){this.resizeDebounceExtendedWhenPossible&&this.checkClearResizeTimeout(),void 0===this._resizeTimeoutId&&(this._resizeTimeoutId=setTimeout((()=>{this._resizeTimeoutId=void 0,this.beginSizeInvalidation(),this.endSizeInvalidation()}),this.resizeDebounceInterval))}checkClearResizeTimeout(){void 0!==this._resizeTimeoutId&&(clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=void 0)}setContainer(){var t;const e=document.body,n=null!==(t=this._containerElement)&&void 0!==t?t:e;if(n===e){this.resizeWithContainerAutomatically=!0;const t=document.documentElement;t.style.height="100%",t.style.margin="0",t.style.padding="0",t.style.overflow="clip",e.style.height="100%",e.style.margin="0",e.style.padding="0",e.style.overflow="clip"}this._containerElement=n}onBeforeUnload(){this.destroy()}adjustColumnsResponsive(){if(void 0===this._groundItem)throw new u("LMACR20883");if(this._firstLoad=!1,this.useResponsiveLayout()&&!this._updatingColumnsResponsive&&this._groundItem.contentItems.length>0&&this._groundItem.contentItems[0].isRow){if(void 0===this._groundItem||null===this._width)throw new u("LMACR77412");{const t=this._groundItem.contentItems[0].contentItems.length;if(t<=1)return;{const e=this.layoutConfig.dimensions.defaultMinItemWidth;if(t*e<=this._width)return;{this._updatingColumnsResponsive=!0;const n=t-Math.max(Math.floor(this._width/e),1),i=this._groundItem.contentItems[0],r=this.getAllStacks();if(0===r.length)throw new d("LMACRS77413");{const t=r[0];for(let e=0;e<n;e++){const e=i.contentItems[i.contentItems.length-1];this.addChildContentItemsToContainer(t,e)}this._updatingColumnsResponsive=!1}}}}}}useResponsiveLayout(){const t=this.layoutConfig.settings,e=t.responsiveMode===b.always,n=t.responsiveMode===b.onload&&this._firstLoad;return e||n}addChildContentItemsToContainer(t,e){const n=e.contentItems;if(e instanceof mt)for(let i=0;i<n.length;i++){const r=n[i];e.removeChild(r,!0),t.addChild(r)}else for(let e=0;e<n.length;e++){const i=n[e];this.addChildContentItemsToContainer(t,i)}}getAllStacks(){if(void 0===this._groundItem)throw new u("LMFASC52778");{const t=[];return this.findAllStacksRecursive(t,this._groundItem),t}}findFirstContentItemType(t){if(void 0===this._groundItem)throw new u("LMFFCIT82446");return this.findFirstContentItemTypeRecursive(t,this._groundItem)}findFirstContentItemTypeRecursive(t,e){const n=e.contentItems,i=n.length;if(0!==i){for(let e=0;e<i;e++){const i=n[e];if(i.type===t)return i}for(let e=0;e<i;e++){const i=n[e],r=this.findFirstContentItemTypeRecursive(t,i);if(void 0!==r)return r}}}findFirstContentItemTypeByIdRecursive(t,e,n){const i=n.contentItems,r=i.length;if(0!==r){for(let n=0;n<r;n++){const r=i[n];if(r.type===t&&r.id===e)return r}for(let n=0;n<r;n++){const r=i[n],o=this.findFirstContentItemTypeByIdRecursive(t,e,r);if(void 0!==o)return o}}}findAllStacksRecursive(t,e){const n=e.contentItems;for(let e=0;e<n.length;e++){const i=n[e];i instanceof mt?t.push(i):i.isComponent||this.findAllStacksRecursive(t,i)}}findFirstLocation(t){const e=t.length;for(let n=0;n<e;n++){const e=t[n],i=this.findLocation(e);if(void 0!==i)return i}}findLocation(t){const e=t.index;switch(t.typeId){case 0:if(void 0===this._focusedComponentItem)return;{const t=this._focusedComponentItem.parentItem,n=t.contentItems,i=n.length;if(void 0===e)return{parentItem:t,index:i};{const r=n.indexOf(this._focusedComponentItem)+e;return r<0||r>i?void 0:{parentItem:t,index:r}}}case 1:if(void 0===this._focusedComponentItem)return;{const t=this._focusedComponentItem.parentItem;return this.tryCreateLocationFromParentItem(t,e)}case 2:{const t=this.findFirstContentItemType(C.stack);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 3:{let t=this.findFirstContentItemType(C.row);return void 0!==t?this.tryCreateLocationFromParentItem(t,e):(t=this.findFirstContentItemType(C.column),void 0!==t?this.tryCreateLocationFromParentItem(t,e):void 0)}case 4:{const t=this.findFirstContentItemType(C.row);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 5:{const t=this.findFirstContentItemType(C.column);return void 0===t?void 0:this.tryCreateLocationFromParentItem(t,e)}case 6:if(void 0===this._groundItem)throw new u("LMFLRIF18244");return void 0!==this.rootItem?void 0:void 0===e||0===e?{parentItem:this._groundItem,index:0}:void 0;case 7:if(void 0===this._groundItem)throw new u("LMFLF18244");{const t=this._groundItem.contentItems;if(0===t.length)return void 0===e||0===e?{parentItem:this._groundItem,index:0}:void 0;{const n=t[0];return this.tryCreateLocationFromParentItem(n,e)}}}}tryCreateLocationFromParentItem(t,e){const n=t.contentItems.length;return void 0===e?{parentItem:t,index:n}:e<0||e>n?void 0:{parentItem:t,index:e}}}!function(t){t.createMaximisePlaceElement=function(t){const e=t.createElement("div");return e.classList.add("lm_maximise_place"),e},t.createTabDropPlaceholderElement=function(t){const e=t.createElement("div");return e.classList.add("lm_drop_tab_placeholder"),e},t.defaultLocationSelectors=[{typeId:1,index:void 0},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}],t.afterFocusedItemIfPossibleLocationSelectors=[{typeId:0,index:1},{typeId:2,index:void 0},{typeId:3,index:void 0},{typeId:7,index:void 0}]}(Ct||(Ct={}));class bt extends Ct{constructor(t,e,n,i){if(super(bt.createLayoutManagerConstructorParameters(t,e)),this._bindComponentEventHanlderPassedInConstructor=!1,this._creationTimeoutPassed=!1,void 0!==e&&"function"==typeof e&&(this.bindComponentEvent=e,this._bindComponentEventHanlderPassedInConstructor=!0,void 0!==n&&(this.unbindComponentEvent=n)),!this._bindComponentEventHanlderPassedInConstructor&&this.isSubWindow){if(void 0===this._constructorOrSubWindowLayoutConfig)throw new u("VLC98823");{const t=j.resolve(this._constructorOrSubWindowLayoutConfig);this.layoutConfig=Object.assign(Object.assign({},t),{root:void 0})}}!0!==i&&(this.deprecatedConstructor||this.init())}destroy(){this.bindComponentEvent=void 0,this.unbindComponentEvent=void 0,super.destroy()}init(){if(this._bindComponentEventHanlderPassedInConstructor||"loading"!==document.readyState&&null!==document.body){if(!this._bindComponentEventHanlderPassedInConstructor&&!0===this.isSubWindow&&!this._creationTimeoutPassed)return setTimeout((()=>this.init()),7),void(this._creationTimeoutPassed=!0);!0===this.isSubWindow&&(this._bindComponentEventHanlderPassedInConstructor||this.clearHtmlAndAdjustStylesForSubWindow(),window.__glInstance=this),super.init()}else document.addEventListener("DOMContentLoaded",(()=>this.init()),{passive:!0})}clearHtmlAndAdjustStylesForSubWindow(){const t=document.head,e=new Array(4);e[0]=document.querySelectorAll("body link"),e[1]=document.querySelectorAll("body style"),e[2]=document.querySelectorAll("template"),e[3]=document.querySelectorAll(".gl_keep");for(let n=0;n<e.length;n++){const i=e[n];for(let e=0;e<i.length;e++){const n=i[e];t.appendChild(n)}}const n=document.body;n.innerHTML="",n.style.visibility="visible",this.checkAddDefaultPopinButton(),document.body.offsetHeight}checkAddDefaultPopinButton(){if(this.layoutConfig.settings.popInOnClose)return!1;{const t=document.createElement("div");t.classList.add("lm_popin"),t.setAttribute("title",this.layoutConfig.header.dock);const e=document.createElement("div");e.classList.add("lm_icon");const n=document.createElement("div");return n.classList.add("lm_bg"),t.appendChild(e),t.appendChild(n),t.addEventListener("click",(()=>this.emit("popIn"))),document.body.appendChild(t),!0}}bindComponent(t,e){if(void 0!==this.bindComponentEvent)return this.bindComponentEvent(t,e);if(void 0!==this.getComponentEvent)return{virtual:!1,component:this.getComponentEvent(t,e)};{const t=`${f[2]}: ${JSON.stringify(e)}`;throw new a(t)}}unbindComponent(t,e,n){if(void 0!==this.unbindComponentEvent)this.unbindComponentEvent(t);else if(!e&&void 0!==this.releaseComponentEvent){if(void 0===n)throw new u("VCUCRCU333998");this.releaseComponentEvent(t,n)}}}!function(t){let e=!1;t.createLayoutManagerConstructorParameters=function(t,n){const i=e?null:new URL(document.location.href).searchParams.get("gl-window");e=!0;const r=null!==i;let o,s;if(null!==i){const e=localStorage.getItem(i);if(null===e)throw new Error("Null gl-window Config");localStorage.removeItem(i);const n=JSON.parse(e),r=O.unminifyConfig(n);s=j.fromResolved(r),t instanceof HTMLElement&&(o=t)}else void 0===t?s=void 0:t instanceof HTMLElement?(s=void 0,o=t):s=t,void 0===o&&n instanceof HTMLElement&&(o=n);return{constructorOrSubWindowLayoutConfig:s,isSubWindow:r,containerElement:o}}}(bt||(bt={}));class It extends bt{constructor(t,e,n){super(t,e,n,!0),this._componentTypesMap=new Map,this._registeredComponentMap=new Map,this._virtuableComponentMap=new Map,this._containerVirtualRectingRequiredEventListener=(t,e,n)=>this.handleContainerVirtualRectingRequiredEvent(t,e,n),this._containerVirtualVisibilityChangeRequiredEventListener=(t,e)=>this.handleContainerVirtualVisibilityChangeRequiredEvent(t,e),this._containerVirtualZIndexChangeRequiredEventListener=(t,e,n)=>this.handleContainerVirtualZIndexChangeRequiredEvent(t,e,n),this.deprecatedConstructor||this.init()}registerComponent(t,e,n=!1){if("function"!=typeof e)throw new s("registerComponent() componentConstructorOrFactoryFtn parameter is not a function");if(e.hasOwnProperty("prototype")){const i=e;this.registerComponentConstructor(t,i,n)}else{const i=e;this.registerComponentFactoryFunction(t,i,n)}}registerComponentConstructor(t,e,n=!1){if("function"!=typeof e)throw new Error(f[1]);if(void 0!==this._componentTypesMap.get(t))throw new a(`${f[3]}: ${t}`);this._componentTypesMap.set(t,{constructor:e,factoryFunction:void 0,virtual:n})}registerComponentFactoryFunction(t,e,n=!1){if("function"!=typeof e)throw new a("Please register a constructor function");if(void 0!==this._componentTypesMap.get(t))throw new a(`${f[3]}: ${t}`);this._componentTypesMap.set(t,{constructor:void 0,factoryFunction:e,virtual:n})}registerComponentFunction(t){this.registerGetComponentConstructorCallback(t)}registerGetComponentConstructorCallback(t){if("function"!=typeof t)throw new Error("Please register a callback function");void 0!==this._getComponentConstructorFtn&&console.warn("Multiple component functions are being registered.  Only the final registered function will be used."),this._getComponentConstructorFtn=t}getRegisteredComponentTypeNames(){const t=this._componentTypesMap.keys();return Array.from(t)}getComponentInstantiator(t){let e;const n=P.resolveComponentTypeName(t);return void 0!==n&&(e=this._componentTypesMap.get(n)),void 0===e&&void 0!==this._getComponentConstructorFtn&&(e={constructor:this._getComponentConstructorFtn(t),factoryFunction:void 0,virtual:!1}),e}bindComponent(t,e){let n;const i=P.resolveComponentTypeName(e);let r;if(void 0!==i&&(n=this._componentTypesMap.get(i)),void 0===n&&void 0!==this._getComponentConstructorFtn&&(n={constructor:this._getComponentConstructorFtn(e),factoryFunction:void 0,virtual:!1}),void 0!==n){const o=n.virtual;let s,c;s=void 0===e.componentState?void 0:J({},e.componentState);const l=n.constructor;if(void 0!==l)c=new l(t,s,o);else{const e=n.factoryFunction;if(void 0===e)throw new d("LMBCFFU10008");c=e(t,s,o)}if(o){if(void 0===c)throw new u("GLBCVCU988774");{const e=c,n=e.rootHtmlElement;if(void 0===n)throw new a(`${f[5]}: ${i}`);!function(t){const e="absolute";t.style.position!==e&&(t.style.position=e)}(n),this.container.appendChild(n),this._virtuableComponentMap.set(t,e),t.virtualRectingRequiredEvent=this._containerVirtualRectingRequiredEventListener,t.virtualVisibilityChangeRequiredEvent=this._containerVirtualVisibilityChangeRequiredEventListener,t.virtualZIndexChangeRequiredEvent=this._containerVirtualZIndexChangeRequiredEventListener}}this._registeredComponentMap.set(t,c),r={virtual:n.virtual,component:c}}else r=super.bindComponent(t,e);return r}unbindComponent(t,e,n){if(void 0===this._registeredComponentMap.get(t))super.unbindComponent(t,e,n);else{const e=this._virtuableComponentMap.get(t);if(void 0!==e){const n=e.rootHtmlElement;if(void 0===n)throw new d("GLUC77743",t.title);this.container.removeChild(n),this._virtuableComponentMap.delete(t)}}}fireBeforeVirtualRectingEvent(t){this._goldenLayoutBoundingClientRect=this.container.getBoundingClientRect(),super.fireBeforeVirtualRectingEvent(t)}handleContainerVirtualRectingRequiredEvent(t,e,n){const i=this._virtuableComponentMap.get(t);if(void 0===i)throw new u("GLHCSCE55933");{const r=i.rootHtmlElement;if(void 0===r)throw new a(f[4]+" "+t.title);{const i=t.element.getBoundingClientRect(),o=i.left-this._goldenLayoutBoundingClientRect.left;r.style.left=$(o);const s=i.top-this._goldenLayoutBoundingClientRect.top;r.style.top=$(s),G(r,e),V(r,n)}}}handleContainerVirtualVisibilityChangeRequiredEvent(t,e){const n=this._virtuableComponentMap.get(t);if(void 0===n)throw new u("GLHCVVCRE55934");{const i=n.rootHtmlElement;if(void 0===i)throw new a(f[4]+" "+t.title);Z(i,e)}}handleContainerVirtualZIndexChangeRequiredEvent(t,e,n){const i=this._virtuableComponentMap.get(t);if(void 0===i)throw new u("GLHCVZICRE55935");{const e=i.rootHtmlElement;if(void 0===e)throw new a(f[4]+" "+t.title);e.style.zIndex=n}}}},318:(t,e)=>{e.read=function(t,e,n,i,r){var o,s,a=8*r-i-1,c=(1<<a)-1,d=c>>1,l=-7,h=n?r-1:0,u=n?-1:1,p=t[e+h];for(h+=u,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=u,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=i;l>0;s=256*s+t[e+h],h+=u,l-=8);if(0===o)o=1-d;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),o-=d}return(p?-1:1)*s*Math.pow(2,o-i)},e.write=function(t,e,n,i,r,o){var s,a,c,d=8*o-r-1,l=(1<<d)-1,h=l>>1,u=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:o-1,f=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?u/c:u*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,r),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[n+p]=255&a,p+=f,a/=256,r-=8);for(s=s<<r|a,d+=r;d>0;t[n+p]=255&s,p+=f,s/=256,d-=8);t[n+p-f]|=128*m}},250:function(t,e,n){var i;t=n.nmd(t),function(){var r,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",c=32,d=128,l=1/0,h=9007199254740991,u=NaN,p=4294967295,f=[["ary",d],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",c],["partialRight",64],["rearg",256]],m="[object Arguments]",g="[object Array]",w="[object Boolean]",y="[object Date]",v="[object Error]",_="[object Function]",C="[object GeneratorFunction]",b="[object Map]",I="[object Number]",E="[object Object]",x="[object Promise]",S="[object RegExp]",A="[object Set]",P="[object String]",M="[object Symbol]",L="[object WeakMap]",R="[object ArrayBuffer]",O="[object DataView]",T="[object Float32Array]",k="[object Float64Array]",z="[object Int8Array]",B="[object Int16Array]",F="[object Int32Array]",D="[object Uint8Array]",U="[object Uint8ClampedArray]",j="[object Uint16Array]",W="[object Uint32Array]",$=/\b__p \+= '';/g,H=/\b(__p \+=) '' \+/g,N=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,q=RegExp(G.source),Z=RegExp(V.source),Y=/<%-([\s\S]+?)%>/g,J=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),it=/^\s+/,rt=/\s/,ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,ct=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,dt=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ht=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ut=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,ft=/^0b[01]+$/i,mt=/^\[object .+?Constructor\]$/,gt=/^0o[0-7]+$/i,wt=/^(?:0|[1-9]\d*)$/,yt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,vt=/($^)/,_t=/['\n\r\u2028\u2029\\]/g,Ct="\\ud800-\\udfff",bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",It="\\u2700-\\u27bf",Et="a-z\\xdf-\\xf6\\xf8-\\xff",xt="A-Z\\xc0-\\xd6\\xd8-\\xde",St="\\ufe0e\\ufe0f",At="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pt="["+Ct+"]",Mt="["+At+"]",Lt="["+bt+"]",Rt="\\d+",Ot="["+It+"]",Tt="["+Et+"]",kt="[^"+Ct+At+Rt+It+Et+xt+"]",zt="\\ud83c[\\udffb-\\udfff]",Bt="[^"+Ct+"]",Ft="(?:\\ud83c[\\udde6-\\uddff]){2}",Dt="[\\ud800-\\udbff][\\udc00-\\udfff]",Ut="["+xt+"]",jt="\\u200d",Wt="(?:"+Tt+"|"+kt+")",$t="(?:"+Ut+"|"+kt+")",Ht="(?:['’](?:d|ll|m|re|s|t|ve))?",Nt="(?:['’](?:D|LL|M|RE|S|T|VE))?",Gt="(?:"+Lt+"|"+zt+")?",Vt="["+St+"]?",qt=Vt+Gt+"(?:"+jt+"(?:"+[Bt,Ft,Dt].join("|")+")"+Vt+Gt+")*",Zt="(?:"+[Ot,Ft,Dt].join("|")+")"+qt,Yt="(?:"+[Bt+Lt+"?",Lt,Ft,Dt,Pt].join("|")+")",Jt=RegExp("['’]","g"),Kt=RegExp(Lt,"g"),Xt=RegExp(zt+"(?="+zt+")|"+Yt+qt,"g"),Qt=RegExp([Ut+"?"+Tt+"+"+Ht+"(?="+[Mt,Ut,"$"].join("|")+")",$t+"+"+Nt+"(?="+[Mt,Ut+Wt,"$"].join("|")+")",Ut+"?"+Wt+"+"+Ht,Ut+"+"+Nt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rt,Zt].join("|"),"g"),te=RegExp("["+jt+Ct+bt+St+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ne=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ie=-1,re={};re[T]=re[k]=re[z]=re[B]=re[F]=re[D]=re[U]=re[j]=re[W]=!0,re[m]=re[g]=re[R]=re[w]=re[O]=re[y]=re[v]=re[_]=re[b]=re[I]=re[E]=re[S]=re[A]=re[P]=re[L]=!1;var oe={};oe[m]=oe[g]=oe[R]=oe[O]=oe[w]=oe[y]=oe[T]=oe[k]=oe[z]=oe[B]=oe[F]=oe[b]=oe[I]=oe[E]=oe[S]=oe[A]=oe[P]=oe[M]=oe[D]=oe[U]=oe[j]=oe[W]=!0,oe[v]=oe[_]=oe[L]=!1;var se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ae=parseFloat,ce=parseInt,de="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,le="object"==typeof self&&self&&self.Object===Object&&self,he=de||le||Function("return this")(),ue=e&&!e.nodeType&&e,pe=ue&&t&&!t.nodeType&&t,fe=pe&&pe.exports===ue,me=fe&&de.process,ge=function(){try{return pe&&pe.require&&pe.require("util").types||me&&me.binding&&me.binding("util")}catch(t){}}(),we=ge&&ge.isArrayBuffer,ye=ge&&ge.isDate,ve=ge&&ge.isMap,_e=ge&&ge.isRegExp,Ce=ge&&ge.isSet,be=ge&&ge.isTypedArray;function Ie(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ee(t,e,n,i){for(var r=-1,o=null==t?0:t.length;++r<o;){var s=t[r];e(i,s,n(s),t)}return i}function xe(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}function Se(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Ae(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function Pe(t,e){for(var n=-1,i=null==t?0:t.length,r=0,o=[];++n<i;){var s=t[n];e(s,n,t)&&(o[r++]=s)}return o}function Me(t,e){return!(null==t||!t.length)&&Ue(t,e,0)>-1}function Le(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}function Re(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}function Oe(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}function Te(t,e,n,i){var r=-1,o=null==t?0:t.length;for(i&&o&&(n=t[++r]);++r<o;)n=e(n,t[r],r,t);return n}function ke(t,e,n,i){var r=null==t?0:t.length;for(i&&r&&(n=t[--r]);r--;)n=e(n,t[r],r,t);return n}function ze(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var Be=He("length");function Fe(t,e,n){var i;return n(t,(function(t,n,r){if(e(t,n,r))return i=n,!1})),i}function De(t,e,n,i){for(var r=t.length,o=n+(i?1:-1);i?o--:++o<r;)if(e(t[o],o,t))return o;return-1}function Ue(t,e,n){return e==e?function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}(t,e,n):De(t,We,n)}function je(t,e,n,i){for(var r=n-1,o=t.length;++r<o;)if(i(t[r],e))return r;return-1}function We(t){return t!=t}function $e(t,e){var n=null==t?0:t.length;return n?Ve(t,e)/n:u}function He(t){return function(e){return null==e?r:e[t]}}function Ne(t){return function(e){return null==t?r:t[e]}}function Ge(t,e,n,i,r){return r(t,(function(t,r,o){n=i?(i=!1,t):e(n,t,r,o)})),n}function Ve(t,e){for(var n,i=-1,o=t.length;++i<o;){var s=e(t[i]);s!==r&&(n=n===r?s:n+s)}return n}function qe(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}function Ze(t){return t?t.slice(0,un(t)+1).replace(it,""):t}function Ye(t){return function(e){return t(e)}}function Je(t,e){return Re(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Xe(t,e){for(var n=-1,i=t.length;++n<i&&Ue(e,t[n],0)>-1;);return n}function Qe(t,e){for(var n=t.length;n--&&Ue(e,t[n],0)>-1;);return n}var tn=Ne({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),en=Ne({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(t){return"\\"+se[t]}function rn(t){return te.test(t)}function on(t){var e=-1,n=Array(t.size);return t.forEach((function(t,i){n[++e]=[i,t]})),n}function sn(t,e){return function(n){return t(e(n))}}function an(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n];s!==e&&s!==a||(t[n]=a,o[r++]=n)}return o}function cn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function dn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function ln(t){return rn(t)?function(t){for(var e=Xt.lastIndex=0;Xt.test(t);)++e;return e}(t):Be(t)}function hn(t){return rn(t)?function(t){return t.match(Xt)||[]}(t):function(t){return t.split("")}(t)}function un(t){for(var e=t.length;e--&&rt.test(t.charAt(e)););return e}var pn=Ne({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),fn=function t(e){var n,i=(e=null==e?he:fn.defaults(he.Object(),e,fn.pick(he,ne))).Array,rt=e.Date,Ct=e.Error,bt=e.Function,It=e.Math,Et=e.Object,xt=e.RegExp,St=e.String,At=e.TypeError,Pt=i.prototype,Mt=bt.prototype,Lt=Et.prototype,Rt=e["__core-js_shared__"],Ot=Mt.toString,Tt=Lt.hasOwnProperty,kt=0,zt=(n=/[^.]+$/.exec(Rt&&Rt.keys&&Rt.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Bt=Lt.toString,Ft=Ot.call(Et),Dt=he._,Ut=xt("^"+Ot.call(Tt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),jt=fe?e.Buffer:r,Wt=e.Symbol,$t=e.Uint8Array,Ht=jt?jt.allocUnsafe:r,Nt=sn(Et.getPrototypeOf,Et),Gt=Et.create,Vt=Lt.propertyIsEnumerable,qt=Pt.splice,Zt=Wt?Wt.isConcatSpreadable:r,Yt=Wt?Wt.iterator:r,Xt=Wt?Wt.toStringTag:r,te=function(){try{var t=co(Et,"defineProperty");return t({},"",{}),t}catch(t){}}(),se=e.clearTimeout!==he.clearTimeout&&e.clearTimeout,de=rt&&rt.now!==he.Date.now&&rt.now,le=e.setTimeout!==he.setTimeout&&e.setTimeout,ue=It.ceil,pe=It.floor,me=Et.getOwnPropertySymbols,ge=jt?jt.isBuffer:r,Be=e.isFinite,Ne=Pt.join,mn=sn(Et.keys,Et),gn=It.max,wn=It.min,yn=rt.now,vn=e.parseInt,_n=It.random,Cn=Pt.reverse,bn=co(e,"DataView"),In=co(e,"Map"),En=co(e,"Promise"),xn=co(e,"Set"),Sn=co(e,"WeakMap"),An=co(Et,"create"),Pn=Sn&&new Sn,Mn={},Ln=Fo(bn),Rn=Fo(In),On=Fo(En),Tn=Fo(xn),kn=Fo(Sn),zn=Wt?Wt.prototype:r,Bn=zn?zn.valueOf:r,Fn=zn?zn.toString:r;function Dn(t){if(ta(t)&&!Hs(t)&&!(t instanceof $n)){if(t instanceof Wn)return t;if(Tt.call(t,"__wrapped__"))return Do(t)}return new Wn(t)}var Un=function(){function t(){}return function(e){if(!Qs(e))return{};if(Gt)return Gt(e);t.prototype=e;var n=new t;return t.prototype=r,n}}();function jn(){}function Wn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=r}function $n(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function Hn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Nn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function Vn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Gn;++e<n;)this.add(t[e])}function qn(t){var e=this.__data__=new Nn(t);this.size=e.size}function Zn(t,e){var n=Hs(t),i=!n&&$s(t),r=!n&&!i&&qs(t),o=!n&&!i&&!r&&ca(t),s=n||i||r||o,a=s?qe(t.length,St):[],c=a.length;for(var d in t)!e&&!Tt.call(t,d)||s&&("length"==d||r&&("offset"==d||"parent"==d)||o&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||go(d,c))||a.push(d);return a}function Yn(t){var e=t.length;return e?t[Gi(0,e-1)]:r}function Jn(t,e){return Oo(Sr(t),oi(e,0,t.length))}function Kn(t){return Oo(Sr(t))}function Xn(t,e,n){(n!==r&&!Us(t[e],n)||n===r&&!(e in t))&&ii(t,e,n)}function Qn(t,e,n){var i=t[e];Tt.call(t,e)&&Us(i,n)&&(n!==r||e in t)||ii(t,e,n)}function ti(t,e){for(var n=t.length;n--;)if(Us(t[n][0],e))return n;return-1}function ei(t,e,n,i){return li(t,(function(t,r,o){e(i,t,n(t),o)})),i}function ni(t,e){return t&&Ar(e,La(e),t)}function ii(t,e,n){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ri(t,e){for(var n=-1,o=e.length,s=i(o),a=null==t;++n<o;)s[n]=a?r:xa(t,e[n]);return s}function oi(t,e,n){return t==t&&(n!==r&&(t=t<=n?t:n),e!==r&&(t=t>=e?t:e)),t}function si(t,e,n,i,o,s){var a,c=1&e,d=2&e,l=4&e;if(n&&(a=o?n(t,i,o,s):n(t)),a!==r)return a;if(!Qs(t))return t;var h=Hs(t);if(h){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Tt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!c)return Sr(t,a)}else{var u=uo(t),p=u==_||u==C;if(qs(t))return _r(t,c);if(u==E||u==m||p&&!o){if(a=d||p?{}:fo(t),!c)return d?function(t,e){return Ar(t,ho(t),e)}(t,function(t,e){return t&&Ar(e,Ra(e),t)}(a,t)):function(t,e){return Ar(t,lo(t),e)}(t,ni(a,t))}else{if(!oe[u])return o?t:{};a=function(t,e,n){var i,r=t.constructor;switch(e){case R:return Cr(t);case w:case y:return new r(+t);case O:return function(t,e){var n=e?Cr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case T:case k:case z:case B:case F:case D:case U:case j:case W:return br(t,n);case b:return new r;case I:case P:return new r(t);case S:return function(t){var e=new t.constructor(t.source,ut.exec(t));return e.lastIndex=t.lastIndex,e}(t);case A:return new r;case M:return i=t,Bn?Et(Bn.call(i)):{}}}(t,u,c)}}s||(s=new qn);var f=s.get(t);if(f)return f;s.set(t,a),oa(t)?t.forEach((function(i){a.add(si(i,e,n,i,t,s))})):ea(t)&&t.forEach((function(i,r){a.set(r,si(i,e,n,r,t,s))}));var g=h?r:(l?d?eo:to:d?Ra:La)(t);return xe(g||t,(function(i,r){g&&(i=t[r=i]),Qn(a,r,si(i,e,n,r,t,s))})),a}function ai(t,e,n){var i=n.length;if(null==t)return!i;for(t=Et(t);i--;){var o=n[i],s=e[o],a=t[o];if(a===r&&!(o in t)||!s(a))return!1}return!0}function ci(t,e,n){if("function"!=typeof t)throw new At(o);return Po((function(){t.apply(r,n)}),e)}function di(t,e,n,i){var r=-1,o=Me,s=!0,a=t.length,c=[],d=e.length;if(!a)return c;n&&(e=Re(e,Ye(n))),i?(o=Le,s=!1):e.length>=200&&(o=Ke,s=!1,e=new Vn(e));t:for(;++r<a;){var l=t[r],h=null==n?l:n(l);if(l=i||0!==l?l:0,s&&h==h){for(var u=d;u--;)if(e[u]===h)continue t;c.push(l)}else o(e,h,i)||c.push(l)}return c}Dn.templateSettings={escape:Y,evaluate:J,interpolate:K,variable:"",imports:{_:Dn}},Dn.prototype=jn.prototype,Dn.prototype.constructor=Dn,Wn.prototype=Un(jn.prototype),Wn.prototype.constructor=Wn,$n.prototype=Un(jn.prototype),$n.prototype.constructor=$n,Hn.prototype.clear=function(){this.__data__=An?An(null):{},this.size=0},Hn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Hn.prototype.get=function(t){var e=this.__data__;if(An){var n=e[t];return n===s?r:n}return Tt.call(e,t)?e[t]:r},Hn.prototype.has=function(t){var e=this.__data__;return An?e[t]!==r:Tt.call(e,t)},Hn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=An&&e===r?s:e,this},Nn.prototype.clear=function(){this.__data__=[],this.size=0},Nn.prototype.delete=function(t){var e=this.__data__,n=ti(e,t);return!(n<0||(n==e.length-1?e.pop():qt.call(e,n,1),--this.size,0))},Nn.prototype.get=function(t){var e=this.__data__,n=ti(e,t);return n<0?r:e[n][1]},Nn.prototype.has=function(t){return ti(this.__data__,t)>-1},Nn.prototype.set=function(t,e){var n=this.__data__,i=ti(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this},Gn.prototype.clear=function(){this.size=0,this.__data__={hash:new Hn,map:new(In||Nn),string:new Hn}},Gn.prototype.delete=function(t){var e=so(this,t).delete(t);return this.size-=e?1:0,e},Gn.prototype.get=function(t){return so(this,t).get(t)},Gn.prototype.has=function(t){return so(this,t).has(t)},Gn.prototype.set=function(t,e){var n=so(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},Vn.prototype.add=Vn.prototype.push=function(t){return this.__data__.set(t,s),this},Vn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.clear=function(){this.__data__=new Nn,this.size=0},qn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},qn.prototype.get=function(t){return this.__data__.get(t)},qn.prototype.has=function(t){return this.__data__.has(t)},qn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Nn){var i=n.__data__;if(!In||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Gn(i)}return n.set(t,e),this.size=n.size,this};var li=Lr(yi),hi=Lr(vi,!0);function ui(t,e){var n=!0;return li(t,(function(t,i,r){return n=!!e(t,i,r)})),n}function pi(t,e,n){for(var i=-1,o=t.length;++i<o;){var s=t[i],a=e(s);if(null!=a&&(c===r?a==a&&!aa(a):n(a,c)))var c=a,d=s}return d}function fi(t,e){var n=[];return li(t,(function(t,i,r){e(t,i,r)&&n.push(t)})),n}function mi(t,e,n,i,r){var o=-1,s=t.length;for(n||(n=mo),r||(r=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?mi(a,e-1,n,i,r):Oe(r,a):i||(r[r.length]=a)}return r}var gi=Rr(),wi=Rr(!0);function yi(t,e){return t&&gi(t,e,La)}function vi(t,e){return t&&wi(t,e,La)}function _i(t,e){return Pe(e,(function(e){return Js(t[e])}))}function Ci(t,e){for(var n=0,i=(e=gr(e,t)).length;null!=t&&n<i;)t=t[Bo(e[n++])];return n&&n==i?t:r}function bi(t,e,n){var i=e(t);return Hs(t)?i:Oe(i,n(t))}function Ii(t){return null==t?t===r?"[object Undefined]":"[object Null]":Xt&&Xt in Et(t)?function(t){var e=Tt.call(t,Xt),n=t[Xt];try{t[Xt]=r;var i=!0}catch(t){}var o=Bt.call(t);return i&&(e?t[Xt]=n:delete t[Xt]),o}(t):function(t){return Bt.call(t)}(t)}function Ei(t,e){return t>e}function xi(t,e){return null!=t&&Tt.call(t,e)}function Si(t,e){return null!=t&&e in Et(t)}function Ai(t,e,n){for(var o=n?Le:Me,s=t[0].length,a=t.length,c=a,d=i(a),l=1/0,h=[];c--;){var u=t[c];c&&e&&(u=Re(u,Ye(e))),l=wn(u.length,l),d[c]=!n&&(e||s>=120&&u.length>=120)?new Vn(c&&u):r}u=t[0];var p=-1,f=d[0];t:for(;++p<s&&h.length<l;){var m=u[p],g=e?e(m):m;if(m=n||0!==m?m:0,!(f?Ke(f,g):o(h,g,n))){for(c=a;--c;){var w=d[c];if(!(w?Ke(w,g):o(t[c],g,n)))continue t}f&&f.push(g),h.push(m)}}return h}function Pi(t,e,n){var i=null==(t=xo(t,e=gr(e,t)))?t:t[Bo(Yo(e))];return null==i?r:Ie(i,t,n)}function Mi(t){return ta(t)&&Ii(t)==m}function Li(t,e,n,i,o){return t===e||(null==t||null==e||!ta(t)&&!ta(e)?t!=t&&e!=e:function(t,e,n,i,o,s){var a=Hs(t),c=Hs(e),d=a?g:uo(t),l=c?g:uo(e),h=(d=d==m?E:d)==E,u=(l=l==m?E:l)==E,p=d==l;if(p&&qs(t)){if(!qs(e))return!1;a=!0,h=!1}if(p&&!h)return s||(s=new qn),a||ca(t)?Xr(t,e,n,i,o,s):function(t,e,n,i,r,o,s){switch(n){case O:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case R:return!(t.byteLength!=e.byteLength||!o(new $t(t),new $t(e)));case w:case y:case I:return Us(+t,+e);case v:return t.name==e.name&&t.message==e.message;case S:case P:return t==e+"";case b:var a=on;case A:var c=1&i;if(a||(a=cn),t.size!=e.size&&!c)return!1;var d=s.get(t);if(d)return d==e;i|=2,s.set(t,e);var l=Xr(a(t),a(e),i,r,o,s);return s.delete(t),l;case M:if(Bn)return Bn.call(t)==Bn.call(e)}return!1}(t,e,d,n,i,o,s);if(!(1&n)){var f=h&&Tt.call(t,"__wrapped__"),_=u&&Tt.call(e,"__wrapped__");if(f||_){var C=f?t.value():t,x=_?e.value():e;return s||(s=new qn),o(C,x,n,i,s)}}return!!p&&(s||(s=new qn),function(t,e,n,i,o,s){var a=1&n,c=to(t),d=c.length;if(d!=to(e).length&&!a)return!1;for(var l=d;l--;){var h=c[l];if(!(a?h in e:Tt.call(e,h)))return!1}var u=s.get(t),p=s.get(e);if(u&&p)return u==e&&p==t;var f=!0;s.set(t,e),s.set(e,t);for(var m=a;++l<d;){var g=t[h=c[l]],w=e[h];if(i)var y=a?i(w,g,h,e,t,s):i(g,w,h,t,e,s);if(!(y===r?g===w||o(g,w,n,i,s):y)){f=!1;break}m||(m="constructor"==h)}if(f&&!m){var v=t.constructor,_=e.constructor;v==_||!("constructor"in t)||!("constructor"in e)||"function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _||(f=!1)}return s.delete(t),s.delete(e),f}(t,e,n,i,o,s))}(t,e,n,i,Li,o))}function Ri(t,e,n,i){var o=n.length,s=o,a=!i;if(null==t)return!s;for(t=Et(t);o--;){var c=n[o];if(a&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<s;){var d=(c=n[o])[0],l=t[d],h=c[1];if(a&&c[2]){if(l===r&&!(d in t))return!1}else{var u=new qn;if(i)var p=i(l,h,d,t,e,u);if(!(p===r?Li(h,l,3,i,u):p))return!1}}return!0}function Oi(t){return!(!Qs(t)||(e=t,zt&&zt in e))&&(Js(t)?Ut:mt).test(Fo(t));var e}function Ti(t){return"function"==typeof t?t:null==t?nc:"object"==typeof t?Hs(t)?Di(t[0],t[1]):Fi(t):hc(t)}function ki(t){if(!Co(t))return mn(t);var e=[];for(var n in Et(t))Tt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function zi(t,e){return t<e}function Bi(t,e){var n=-1,r=Gs(t)?i(t.length):[];return li(t,(function(t,i,o){r[++n]=e(t,i,o)})),r}function Fi(t){var e=ao(t);return 1==e.length&&e[0][2]?Io(e[0][0],e[0][1]):function(n){return n===t||Ri(n,t,e)}}function Di(t,e){return yo(t)&&bo(e)?Io(Bo(t),e):function(n){var i=xa(n,t);return i===r&&i===e?Sa(n,t):Li(e,i,3)}}function Ui(t,e,n,i,o){t!==e&&gi(e,(function(s,a){if(o||(o=new qn),Qs(s))!function(t,e,n,i,o,s,a){var c=So(t,n),d=So(e,n),l=a.get(d);if(l)Xn(t,n,l);else{var h=s?s(c,d,n+"",t,e,a):r,u=h===r;if(u){var p=Hs(d),f=!p&&qs(d),m=!p&&!f&&ca(d);h=d,p||f||m?Hs(c)?h=c:Vs(c)?h=Sr(c):f?(u=!1,h=_r(d,!0)):m?(u=!1,h=br(d,!0)):h=[]:ia(d)||$s(d)?(h=c,$s(c)?h=ga(c):Qs(c)&&!Js(c)||(h=fo(d))):u=!1}u&&(a.set(d,h),o(h,d,i,s,a),a.delete(d)),Xn(t,n,h)}}(t,e,a,n,Ui,i,o);else{var c=i?i(So(t,a),s,a+"",t,e,o):r;c===r&&(c=s),Xn(t,a,c)}}),Ra)}function ji(t,e){var n=t.length;if(n)return go(e+=e<0?n:0,n)?t[e]:r}function Wi(t,e,n){e=e.length?Re(e,(function(t){return Hs(t)?function(e){return Ci(e,1===t.length?t[0]:t)}:t})):[nc];var i=-1;e=Re(e,Ye(oo()));var r=Bi(t,(function(t,n,r){var o=Re(e,(function(e){return e(t)}));return{criteria:o,index:++i,value:t}}));return function(t,e){var i=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var i=-1,r=t.criteria,o=e.criteria,s=r.length,a=n.length;++i<s;){var c=Ir(r[i],o[i]);if(c)return i>=a?c:c*("desc"==n[i]?-1:1)}return t.index-e.index}(t,e,n)}));i--;)t[i]=t[i].value;return t}(r)}function $i(t,e,n){for(var i=-1,r=e.length,o={};++i<r;){var s=e[i],a=Ci(t,s);n(a,s)&&Ji(o,gr(s,t),a)}return o}function Hi(t,e,n,i){var r=i?je:Ue,o=-1,s=e.length,a=t;for(t===e&&(e=Sr(e)),n&&(a=Re(t,Ye(n)));++o<s;)for(var c=0,d=e[o],l=n?n(d):d;(c=r(a,l,c,i))>-1;)a!==t&&qt.call(a,c,1),qt.call(t,c,1);return t}function Ni(t,e){for(var n=t?e.length:0,i=n-1;n--;){var r=e[n];if(n==i||r!==o){var o=r;go(r)?qt.call(t,r,1):cr(t,r)}}return t}function Gi(t,e){return t+pe(_n()*(e-t+1))}function Vi(t,e){var n="";if(!t||e<1||e>h)return n;do{e%2&&(n+=t),(e=pe(e/2))&&(t+=t)}while(e);return n}function qi(t,e){return Mo(Eo(t,e,nc),t+"")}function Zi(t){return Yn(Ua(t))}function Yi(t,e){var n=Ua(t);return Oo(n,oi(e,0,n.length))}function Ji(t,e,n,i){if(!Qs(t))return t;for(var o=-1,s=(e=gr(e,t)).length,a=s-1,c=t;null!=c&&++o<s;){var d=Bo(e[o]),l=n;if("__proto__"===d||"constructor"===d||"prototype"===d)return t;if(o!=a){var h=c[d];(l=i?i(h,d,c):r)===r&&(l=Qs(h)?h:go(e[o+1])?[]:{})}Qn(c,d,l),c=c[d]}return t}var Ki=Pn?function(t,e){return Pn.set(t,e),t}:nc,Xi=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:Qa(e),writable:!0})}:nc;function Qi(t){return Oo(Ua(t))}function tr(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var s=i(o);++r<o;)s[r]=t[r+e];return s}function er(t,e){var n;return li(t,(function(t,i,r){return!(n=e(t,i,r))})),!!n}function nr(t,e,n){var i=0,r=null==t?i:t.length;if("number"==typeof e&&e==e&&r<=2147483647){for(;i<r;){var o=i+r>>>1,s=t[o];null!==s&&!aa(s)&&(n?s<=e:s<e)?i=o+1:r=o}return r}return ir(t,e,nc,n)}function ir(t,e,n,i){var o=0,s=null==t?0:t.length;if(0===s)return 0;for(var a=(e=n(e))!=e,c=null===e,d=aa(e),l=e===r;o<s;){var h=pe((o+s)/2),u=n(t[h]),p=u!==r,f=null===u,m=u==u,g=aa(u);if(a)var w=i||m;else w=l?m&&(i||p):c?m&&p&&(i||!f):d?m&&p&&!f&&(i||!g):!f&&!g&&(i?u<=e:u<e);w?o=h+1:s=h}return wn(s,4294967294)}function rr(t,e){for(var n=-1,i=t.length,r=0,o=[];++n<i;){var s=t[n],a=e?e(s):s;if(!n||!Us(a,c)){var c=a;o[r++]=0===s?0:s}}return o}function or(t){return"number"==typeof t?t:aa(t)?u:+t}function sr(t){if("string"==typeof t)return t;if(Hs(t))return Re(t,sr)+"";if(aa(t))return Fn?Fn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ar(t,e,n){var i=-1,r=Me,o=t.length,s=!0,a=[],c=a;if(n)s=!1,r=Le;else if(o>=200){var d=e?null:Vr(t);if(d)return cn(d);s=!1,r=Ke,c=new Vn}else c=e?[]:a;t:for(;++i<o;){var l=t[i],h=e?e(l):l;if(l=n||0!==l?l:0,s&&h==h){for(var u=c.length;u--;)if(c[u]===h)continue t;e&&c.push(h),a.push(l)}else r(c,h,n)||(c!==a&&c.push(h),a.push(l))}return a}function cr(t,e){return null==(t=xo(t,e=gr(e,t)))||delete t[Bo(Yo(e))]}function dr(t,e,n,i){return Ji(t,e,n(Ci(t,e)),i)}function lr(t,e,n,i){for(var r=t.length,o=i?r:-1;(i?o--:++o<r)&&e(t[o],o,t););return n?tr(t,i?0:o,i?o+1:r):tr(t,i?o+1:0,i?r:o)}function hr(t,e){var n=t;return n instanceof $n&&(n=n.value()),Te(e,(function(t,e){return e.func.apply(e.thisArg,Oe([t],e.args))}),n)}function ur(t,e,n){var r=t.length;if(r<2)return r?ar(t[0]):[];for(var o=-1,s=i(r);++o<r;)for(var a=t[o],c=-1;++c<r;)c!=o&&(s[o]=di(s[o]||a,t[c],e,n));return ar(mi(s,1),e,n)}function pr(t,e,n){for(var i=-1,o=t.length,s=e.length,a={};++i<o;){var c=i<s?e[i]:r;n(a,t[i],c)}return a}function fr(t){return Vs(t)?t:[]}function mr(t){return"function"==typeof t?t:nc}function gr(t,e){return Hs(t)?t:yo(t,e)?[t]:zo(wa(t))}var wr=qi;function yr(t,e,n){var i=t.length;return n=n===r?i:n,!e&&n>=i?t:tr(t,e,n)}var vr=se||function(t){return he.clearTimeout(t)};function _r(t,e){if(e)return t.slice();var n=t.length,i=Ht?Ht(n):new t.constructor(n);return t.copy(i),i}function Cr(t){var e=new t.constructor(t.byteLength);return new $t(e).set(new $t(t)),e}function br(t,e){var n=e?Cr(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function Ir(t,e){if(t!==e){var n=t!==r,i=null===t,o=t==t,s=aa(t),a=e!==r,c=null===e,d=e==e,l=aa(e);if(!c&&!l&&!s&&t>e||s&&a&&d&&!c&&!l||i&&a&&d||!n&&d||!o)return 1;if(!i&&!s&&!l&&t<e||l&&n&&o&&!i&&!s||c&&n&&o||!a&&o||!d)return-1}return 0}function Er(t,e,n,r){for(var o=-1,s=t.length,a=n.length,c=-1,d=e.length,l=gn(s-a,0),h=i(d+l),u=!r;++c<d;)h[c]=e[c];for(;++o<a;)(u||o<s)&&(h[n[o]]=t[o]);for(;l--;)h[c++]=t[o++];return h}function xr(t,e,n,r){for(var o=-1,s=t.length,a=-1,c=n.length,d=-1,l=e.length,h=gn(s-c,0),u=i(h+l),p=!r;++o<h;)u[o]=t[o];for(var f=o;++d<l;)u[f+d]=e[d];for(;++a<c;)(p||o<s)&&(u[f+n[a]]=t[o++]);return u}function Sr(t,e){var n=-1,r=t.length;for(e||(e=i(r));++n<r;)e[n]=t[n];return e}function Ar(t,e,n,i){var o=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var c=e[s],d=i?i(n[c],t[c],c,n,t):r;d===r&&(d=t[c]),o?ii(n,c,d):Qn(n,c,d)}return n}function Pr(t,e){return function(n,i){var r=Hs(n)?Ee:ei,o=e?e():{};return r(n,t,oo(i,2),o)}}function Mr(t){return qi((function(e,n){var i=-1,o=n.length,s=o>1?n[o-1]:r,a=o>2?n[2]:r;for(s=t.length>3&&"function"==typeof s?(o--,s):r,a&&wo(n[0],n[1],a)&&(s=o<3?r:s,o=1),e=Et(e);++i<o;){var c=n[i];c&&t(e,c,i,s)}return e}))}function Lr(t,e){return function(n,i){if(null==n)return n;if(!Gs(n))return t(n,i);for(var r=n.length,o=e?r:-1,s=Et(n);(e?o--:++o<r)&&!1!==i(s[o],o,s););return n}}function Rr(t){return function(e,n,i){for(var r=-1,o=Et(e),s=i(e),a=s.length;a--;){var c=s[t?a:++r];if(!1===n(o[c],c,o))break}return e}}function Or(t){return function(e){var n=rn(e=wa(e))?hn(e):r,i=n?n[0]:e.charAt(0),o=n?yr(n,1).join(""):e.slice(1);return i[t]()+o}}function Tr(t){return function(e){return Te(Ja($a(e).replace(Jt,"")),t,"")}}function kr(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=Un(t.prototype),i=t.apply(n,e);return Qs(i)?i:n}}function zr(t){return function(e,n,i){var o=Et(e);if(!Gs(e)){var s=oo(n,3);e=La(e),n=function(t){return s(o[t],t,o)}}var a=t(e,n,i);return a>-1?o[s?e[a]:a]:r}}function Br(t){return Qr((function(e){var n=e.length,i=n,s=Wn.prototype.thru;for(t&&e.reverse();i--;){var a=e[i];if("function"!=typeof a)throw new At(o);if(s&&!c&&"wrapper"==io(a))var c=new Wn([],!0)}for(i=c?i:n;++i<n;){var d=io(a=e[i]),l="wrapper"==d?no(a):r;c=l&&vo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?c[io(l[0])].apply(c,l[3]):1==a.length&&vo(a)?c[d]():c.thru(a)}return function(){var t=arguments,i=t[0];if(c&&1==t.length&&Hs(i))return c.plant(i).value();for(var r=0,o=n?e[r].apply(this,t):i;++r<n;)o=e[r].call(this,o);return o}}))}function Fr(t,e,n,o,s,a,c,l,h,u){var p=e&d,f=1&e,m=2&e,g=24&e,w=512&e,y=m?r:kr(t);return function d(){for(var v=arguments.length,_=i(v),C=v;C--;)_[C]=arguments[C];if(g)var b=ro(d),I=function(t,e){for(var n=t.length,i=0;n--;)t[n]===e&&++i;return i}(_,b);if(o&&(_=Er(_,o,s,g)),a&&(_=xr(_,a,c,g)),v-=I,g&&v<u){var E=an(_,b);return Nr(t,e,Fr,d.placeholder,n,_,E,l,h,u-v)}var x=f?n:this,S=m?x[t]:t;return v=_.length,l?_=function(t,e){for(var n=t.length,i=wn(e.length,n),o=Sr(t);i--;){var s=e[i];t[i]=go(s,n)?o[s]:r}return t}(_,l):w&&v>1&&_.reverse(),p&&h<v&&(_.length=h),this&&this!==he&&this instanceof d&&(S=y||kr(S)),S.apply(x,_)}}function Dr(t,e){return function(n,i){return function(t,e,n,i){return yi(t,(function(t,r,o){e(i,n(t),r,o)})),i}(n,t,e(i),{})}}function Ur(t,e){return function(n,i){var o;if(n===r&&i===r)return e;if(n!==r&&(o=n),i!==r){if(o===r)return i;"string"==typeof n||"string"==typeof i?(n=sr(n),i=sr(i)):(n=or(n),i=or(i)),o=t(n,i)}return o}}function jr(t){return Qr((function(e){return e=Re(e,Ye(oo())),qi((function(n){var i=this;return t(e,(function(t){return Ie(t,i,n)}))}))}))}function Wr(t,e){var n=(e=e===r?" ":sr(e)).length;if(n<2)return n?Vi(e,t):e;var i=Vi(e,ue(t/ln(e)));return rn(e)?yr(hn(i),0,t).join(""):i.slice(0,t)}function $r(t){return function(e,n,o){return o&&"number"!=typeof o&&wo(e,n,o)&&(n=o=r),e=ua(e),n===r?(n=e,e=0):n=ua(n),function(t,e,n,r){for(var o=-1,s=gn(ue((e-t)/(n||1)),0),a=i(s);s--;)a[r?s:++o]=t,t+=n;return a}(e,n,o=o===r?e<n?1:-1:ua(o),t)}}function Hr(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=ma(e),n=ma(n)),t(e,n)}}function Nr(t,e,n,i,o,s,a,d,l,h){var u=8&e;e|=u?c:64,4&(e&=~(u?64:c))||(e&=-4);var p=[t,e,o,u?s:r,u?a:r,u?r:s,u?r:a,d,l,h],f=n.apply(r,p);return vo(t)&&Ao(f,p),f.placeholder=i,Lo(f,t,e)}function Gr(t){var e=It[t];return function(t,n){if(t=ma(t),(n=null==n?0:wn(pa(n),292))&&Be(t)){var i=(wa(t)+"e").split("e");return+((i=(wa(e(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return e(t)}}var Vr=xn&&1/cn(new xn([,-0]))[1]==l?function(t){return new xn(t)}:ac;function qr(t){return function(e){var n=uo(e);return n==b?on(e):n==A?dn(e):function(t,e){return Re(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Zr(t,e,n,s,l,h,u,p){var f=2&e;if(!f&&"function"!=typeof t)throw new At(o);var m=s?s.length:0;if(m||(e&=-97,s=l=r),u=u===r?u:gn(pa(u),0),p=p===r?p:pa(p),m-=l?l.length:0,64&e){var g=s,w=l;s=l=r}var y=f?r:no(t),v=[t,e,n,s,l,g,w,h,u,p];if(y&&function(t,e){var n=t[1],i=e[1],r=n|i,o=r<131,s=i==d&&8==n||i==d&&256==n&&t[7].length<=e[8]||384==i&&e[7].length<=e[8]&&8==n;if(!o&&!s)return t;1&i&&(t[2]=e[2],r|=1&n?0:4);var c=e[3];if(c){var l=t[3];t[3]=l?Er(l,c,e[4]):c,t[4]=l?an(t[3],a):e[4]}(c=e[5])&&(l=t[5],t[5]=l?xr(l,c,e[6]):c,t[6]=l?an(t[5],a):e[6]),(c=e[7])&&(t[7]=c),i&d&&(t[8]=null==t[8]?e[8]:wn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=r}(v,y),t=v[0],e=v[1],n=v[2],s=v[3],l=v[4],!(p=v[9]=v[9]===r?f?0:t.length:gn(v[9]-m,0))&&24&e&&(e&=-25),e&&1!=e)_=8==e||16==e?function(t,e,n){var o=kr(t);return function s(){for(var a=arguments.length,c=i(a),d=a,l=ro(s);d--;)c[d]=arguments[d];var h=a<3&&c[0]!==l&&c[a-1]!==l?[]:an(c,l);return(a-=h.length)<n?Nr(t,e,Fr,s.placeholder,r,c,h,r,r,n-a):Ie(this&&this!==he&&this instanceof s?o:t,this,c)}}(t,e,p):e!=c&&33!=e||l.length?Fr.apply(r,v):function(t,e,n,r){var o=1&e,s=kr(t);return function e(){for(var a=-1,c=arguments.length,d=-1,l=r.length,h=i(l+c),u=this&&this!==he&&this instanceof e?s:t;++d<l;)h[d]=r[d];for(;c--;)h[d++]=arguments[++a];return Ie(u,o?n:this,h)}}(t,e,n,s);else var _=function(t,e,n){var i=1&e,r=kr(t);return function e(){return(this&&this!==he&&this instanceof e?r:t).apply(i?n:this,arguments)}}(t,e,n);return Lo((y?Ki:Ao)(_,v),t,e)}function Yr(t,e,n,i){return t===r||Us(t,Lt[n])&&!Tt.call(i,n)?e:t}function Jr(t,e,n,i,o,s){return Qs(t)&&Qs(e)&&(s.set(e,t),Ui(t,e,r,Jr,s),s.delete(e)),t}function Kr(t){return ia(t)?r:t}function Xr(t,e,n,i,o,s){var a=1&n,c=t.length,d=e.length;if(c!=d&&!(a&&d>c))return!1;var l=s.get(t),h=s.get(e);if(l&&h)return l==e&&h==t;var u=-1,p=!0,f=2&n?new Vn:r;for(s.set(t,e),s.set(e,t);++u<c;){var m=t[u],g=e[u];if(i)var w=a?i(g,m,u,e,t,s):i(m,g,u,t,e,s);if(w!==r){if(w)continue;p=!1;break}if(f){if(!ze(e,(function(t,e){if(!Ke(f,e)&&(m===t||o(m,t,n,i,s)))return f.push(e)}))){p=!1;break}}else if(m!==g&&!o(m,g,n,i,s)){p=!1;break}}return s.delete(t),s.delete(e),p}function Qr(t){return Mo(Eo(t,r,No),t+"")}function to(t){return bi(t,La,lo)}function eo(t){return bi(t,Ra,ho)}var no=Pn?function(t){return Pn.get(t)}:ac;function io(t){for(var e=t.name+"",n=Mn[e],i=Tt.call(Mn,e)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==t)return r.name}return e}function ro(t){return(Tt.call(Dn,"placeholder")?Dn:t).placeholder}function oo(){var t=Dn.iteratee||ic;return t=t===ic?Ti:t,arguments.length?t(arguments[0],arguments[1]):t}function so(t,e){var n,i,r=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?r["string"==typeof e?"string":"hash"]:r.map}function ao(t){for(var e=La(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,bo(r)]}return e}function co(t,e){var n=function(t,e){return null==t?r:t[e]}(t,e);return Oi(n)?n:r}var lo=me?function(t){return null==t?[]:(t=Et(t),Pe(me(t),(function(e){return Vt.call(t,e)})))}:fc,ho=me?function(t){for(var e=[];t;)Oe(e,lo(t)),t=Nt(t);return e}:fc,uo=Ii;function po(t,e,n){for(var i=-1,r=(e=gr(e,t)).length,o=!1;++i<r;){var s=Bo(e[i]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++i!=r?o:!!(r=null==t?0:t.length)&&Xs(r)&&go(s,r)&&(Hs(t)||$s(t))}function fo(t){return"function"!=typeof t.constructor||Co(t)?{}:Un(Nt(t))}function mo(t){return Hs(t)||$s(t)||!!(Zt&&t&&t[Zt])}function go(t,e){var n=typeof t;return!!(e=null==e?h:e)&&("number"==n||"symbol"!=n&&wt.test(t))&&t>-1&&t%1==0&&t<e}function wo(t,e,n){if(!Qs(n))return!1;var i=typeof e;return!!("number"==i?Gs(n)&&go(e,n.length):"string"==i&&e in n)&&Us(n[e],t)}function yo(t,e){if(Hs(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!aa(t))||Q.test(t)||!X.test(t)||null!=e&&t in Et(e)}function vo(t){var e=io(t),n=Dn[e];if("function"!=typeof n||!(e in $n.prototype))return!1;if(t===n)return!0;var i=no(n);return!!i&&t===i[0]}(bn&&uo(new bn(new ArrayBuffer(1)))!=O||In&&uo(new In)!=b||En&&uo(En.resolve())!=x||xn&&uo(new xn)!=A||Sn&&uo(new Sn)!=L)&&(uo=function(t){var e=Ii(t),n=e==E?t.constructor:r,i=n?Fo(n):"";if(i)switch(i){case Ln:return O;case Rn:return b;case On:return x;case Tn:return A;case kn:return L}return e});var _o=Rt?Js:mc;function Co(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Lt)}function bo(t){return t==t&&!Qs(t)}function Io(t,e){return function(n){return null!=n&&n[t]===e&&(e!==r||t in Et(n))}}function Eo(t,e,n){return e=gn(e===r?t.length-1:e,0),function(){for(var r=arguments,o=-1,s=gn(r.length-e,0),a=i(s);++o<s;)a[o]=r[e+o];o=-1;for(var c=i(e+1);++o<e;)c[o]=r[o];return c[e]=n(a),Ie(t,this,c)}}function xo(t,e){return e.length<2?t:Ci(t,tr(e,0,-1))}function So(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ao=Ro(Ki),Po=le||function(t,e){return he.setTimeout(t,e)},Mo=Ro(Xi);function Lo(t,e,n){var i=e+"";return Mo(t,function(t,e){var n=e.length;if(!n)return t;var i=n-1;return e[i]=(n>1?"& ":"")+e[i],e=e.join(n>2?", ":" "),t.replace(ot,"{\n/* [wrapped with "+e+"] */\n")}(i,function(t,e){return xe(f,(function(n){var i="_."+n[0];e&n[1]&&!Me(t,i)&&t.push(i)})),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(at):[]}(i),n)))}function Ro(t){var e=0,n=0;return function(){var i=yn(),o=16-(i-n);if(n=i,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(r,arguments)}}function Oo(t,e){var n=-1,i=t.length,o=i-1;for(e=e===r?i:e;++n<e;){var s=Gi(n,o),a=t[s];t[s]=t[n],t[n]=a}return t.length=e,t}var To,ko,zo=(To=Ts((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,i,r){e.push(i?r.replace(lt,"$1"):n||t)})),e}),(function(t){return 500===ko.size&&ko.clear(),t})),ko=To.cache,To);function Bo(t){if("string"==typeof t||aa(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Fo(t){if(null!=t){try{return Ot.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Do(t){if(t instanceof $n)return t.clone();var e=new Wn(t.__wrapped__,t.__chain__);return e.__actions__=Sr(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var Uo=qi((function(t,e){return Vs(t)?di(t,mi(e,1,Vs,!0)):[]})),jo=qi((function(t,e){var n=Yo(e);return Vs(n)&&(n=r),Vs(t)?di(t,mi(e,1,Vs,!0),oo(n,2)):[]})),Wo=qi((function(t,e){var n=Yo(e);return Vs(n)&&(n=r),Vs(t)?di(t,mi(e,1,Vs,!0),r,n):[]}));function $o(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:pa(n);return r<0&&(r=gn(i+r,0)),De(t,oo(e,3),r)}function Ho(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=i-1;return n!==r&&(o=pa(n),o=n<0?gn(i+o,0):wn(o,i-1)),De(t,oo(e,3),o,!0)}function No(t){return null!=t&&t.length?mi(t,1):[]}function Go(t){return t&&t.length?t[0]:r}var Vo=qi((function(t){var e=Re(t,fr);return e.length&&e[0]===t[0]?Ai(e):[]})),qo=qi((function(t){var e=Yo(t),n=Re(t,fr);return e===Yo(n)?e=r:n.pop(),n.length&&n[0]===t[0]?Ai(n,oo(e,2)):[]})),Zo=qi((function(t){var e=Yo(t),n=Re(t,fr);return(e="function"==typeof e?e:r)&&n.pop(),n.length&&n[0]===t[0]?Ai(n,r,e):[]}));function Yo(t){var e=null==t?0:t.length;return e?t[e-1]:r}var Jo=qi(Ko);function Ko(t,e){return t&&t.length&&e&&e.length?Hi(t,e):t}var Xo=Qr((function(t,e){var n=null==t?0:t.length,i=ri(t,e);return Ni(t,Re(e,(function(t){return go(t,n)?+t:t})).sort(Ir)),i}));function Qo(t){return null==t?t:Cn.call(t)}var ts=qi((function(t){return ar(mi(t,1,Vs,!0))})),es=qi((function(t){var e=Yo(t);return Vs(e)&&(e=r),ar(mi(t,1,Vs,!0),oo(e,2))})),ns=qi((function(t){var e=Yo(t);return e="function"==typeof e?e:r,ar(mi(t,1,Vs,!0),r,e)}));function is(t){if(!t||!t.length)return[];var e=0;return t=Pe(t,(function(t){if(Vs(t))return e=gn(t.length,e),!0})),qe(e,(function(e){return Re(t,He(e))}))}function rs(t,e){if(!t||!t.length)return[];var n=is(t);return null==e?n:Re(n,(function(t){return Ie(e,r,t)}))}var os=qi((function(t,e){return Vs(t)?di(t,e):[]})),ss=qi((function(t){return ur(Pe(t,Vs))})),as=qi((function(t){var e=Yo(t);return Vs(e)&&(e=r),ur(Pe(t,Vs),oo(e,2))})),cs=qi((function(t){var e=Yo(t);return e="function"==typeof e?e:r,ur(Pe(t,Vs),r,e)})),ds=qi(is),ls=qi((function(t){var e=t.length,n=e>1?t[e-1]:r;return n="function"==typeof n?(t.pop(),n):r,rs(t,n)}));function hs(t){var e=Dn(t);return e.__chain__=!0,e}function us(t,e){return e(t)}var ps=Qr((function(t){var e=t.length,n=e?t[0]:0,i=this.__wrapped__,o=function(e){return ri(e,t)};return!(e>1||this.__actions__.length)&&i instanceof $n&&go(n)?((i=i.slice(n,+n+(e?1:0))).__actions__.push({func:us,args:[o],thisArg:r}),new Wn(i,this.__chain__).thru((function(t){return e&&!t.length&&t.push(r),t}))):this.thru(o)})),fs=Pr((function(t,e,n){Tt.call(t,n)?++t[n]:ii(t,n,1)})),ms=zr($o),gs=zr(Ho);function ws(t,e){return(Hs(t)?xe:li)(t,oo(e,3))}function ys(t,e){return(Hs(t)?Se:hi)(t,oo(e,3))}var vs=Pr((function(t,e,n){Tt.call(t,n)?t[n].push(e):ii(t,n,[e])})),_s=qi((function(t,e,n){var r=-1,o="function"==typeof e,s=Gs(t)?i(t.length):[];return li(t,(function(t){s[++r]=o?Ie(e,t,n):Pi(t,e,n)})),s})),Cs=Pr((function(t,e,n){ii(t,n,e)}));function bs(t,e){return(Hs(t)?Re:Bi)(t,oo(e,3))}var Is=Pr((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),Es=qi((function(t,e){if(null==t)return[];var n=e.length;return n>1&&wo(t,e[0],e[1])?e=[]:n>2&&wo(e[0],e[1],e[2])&&(e=[e[0]]),Wi(t,mi(e,1),[])})),xs=de||function(){return he.Date.now()};function Ss(t,e,n){return e=n?r:e,e=t&&null==e?t.length:e,Zr(t,d,r,r,r,r,e)}function As(t,e){var n;if("function"!=typeof e)throw new At(o);return t=pa(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=r),n}}var Ps=qi((function(t,e,n){var i=1;if(n.length){var r=an(n,ro(Ps));i|=c}return Zr(t,i,e,n,r)})),Ms=qi((function(t,e,n){var i=3;if(n.length){var r=an(n,ro(Ms));i|=c}return Zr(e,i,t,n,r)}));function Ls(t,e,n){var i,s,a,c,d,l,h=0,u=!1,p=!1,f=!0;if("function"!=typeof t)throw new At(o);function m(e){var n=i,o=s;return i=s=r,h=e,c=t.apply(o,n)}function g(t){var n=t-l;return l===r||n>=e||n<0||p&&t-h>=a}function w(){var t=xs();if(g(t))return y(t);d=Po(w,function(t){var n=e-(t-l);return p?wn(n,a-(t-h)):n}(t))}function y(t){return d=r,f&&i?m(t):(i=s=r,c)}function v(){var t=xs(),n=g(t);if(i=arguments,s=this,l=t,n){if(d===r)return function(t){return h=t,d=Po(w,e),u?m(t):c}(l);if(p)return vr(d),d=Po(w,e),m(l)}return d===r&&(d=Po(w,e)),c}return e=ma(e)||0,Qs(n)&&(u=!!n.leading,a=(p="maxWait"in n)?gn(ma(n.maxWait)||0,e):a,f="trailing"in n?!!n.trailing:f),v.cancel=function(){d!==r&&vr(d),h=0,i=l=s=d=r},v.flush=function(){return d===r?c:y(xs())},v}var Rs=qi((function(t,e){return ci(t,1,e)})),Os=qi((function(t,e,n){return ci(t,ma(e)||0,n)}));function Ts(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new At(o);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var s=t.apply(this,i);return n.cache=o.set(r,s)||o,s};return n.cache=new(Ts.Cache||Gn),n}function ks(t){if("function"!=typeof t)throw new At(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}Ts.Cache=Gn;var zs=wr((function(t,e){var n=(e=1==e.length&&Hs(e[0])?Re(e[0],Ye(oo())):Re(mi(e,1),Ye(oo()))).length;return qi((function(i){for(var r=-1,o=wn(i.length,n);++r<o;)i[r]=e[r].call(this,i[r]);return Ie(t,this,i)}))})),Bs=qi((function(t,e){var n=an(e,ro(Bs));return Zr(t,c,r,e,n)})),Fs=qi((function(t,e){var n=an(e,ro(Fs));return Zr(t,64,r,e,n)})),Ds=Qr((function(t,e){return Zr(t,256,r,r,r,e)}));function Us(t,e){return t===e||t!=t&&e!=e}var js=Hr(Ei),Ws=Hr((function(t,e){return t>=e})),$s=Mi(function(){return arguments}())?Mi:function(t){return ta(t)&&Tt.call(t,"callee")&&!Vt.call(t,"callee")},Hs=i.isArray,Ns=we?Ye(we):function(t){return ta(t)&&Ii(t)==R};function Gs(t){return null!=t&&Xs(t.length)&&!Js(t)}function Vs(t){return ta(t)&&Gs(t)}var qs=ge||mc,Zs=ye?Ye(ye):function(t){return ta(t)&&Ii(t)==y};function Ys(t){if(!ta(t))return!1;var e=Ii(t);return e==v||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ia(t)}function Js(t){if(!Qs(t))return!1;var e=Ii(t);return e==_||e==C||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ks(t){return"number"==typeof t&&t==pa(t)}function Xs(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=h}function Qs(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ta(t){return null!=t&&"object"==typeof t}var ea=ve?Ye(ve):function(t){return ta(t)&&uo(t)==b};function na(t){return"number"==typeof t||ta(t)&&Ii(t)==I}function ia(t){if(!ta(t)||Ii(t)!=E)return!1;var e=Nt(t);if(null===e)return!0;var n=Tt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ot.call(n)==Ft}var ra=_e?Ye(_e):function(t){return ta(t)&&Ii(t)==S},oa=Ce?Ye(Ce):function(t){return ta(t)&&uo(t)==A};function sa(t){return"string"==typeof t||!Hs(t)&&ta(t)&&Ii(t)==P}function aa(t){return"symbol"==typeof t||ta(t)&&Ii(t)==M}var ca=be?Ye(be):function(t){return ta(t)&&Xs(t.length)&&!!re[Ii(t)]},da=Hr(zi),la=Hr((function(t,e){return t<=e}));function ha(t){if(!t)return[];if(Gs(t))return sa(t)?hn(t):Sr(t);if(Yt&&t[Yt])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Yt]());var e=uo(t);return(e==b?on:e==A?cn:Ua)(t)}function ua(t){return t?(t=ma(t))===l||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function pa(t){var e=ua(t),n=e%1;return e==e?n?e-n:e:0}function fa(t){return t?oi(pa(t),0,p):0}function ma(t){if("number"==typeof t)return t;if(aa(t))return u;if(Qs(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Qs(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Ze(t);var n=ft.test(t);return n||gt.test(t)?ce(t.slice(2),n?2:8):pt.test(t)?u:+t}function ga(t){return Ar(t,Ra(t))}function wa(t){return null==t?"":sr(t)}var ya=Mr((function(t,e){if(Co(e)||Gs(e))Ar(e,La(e),t);else for(var n in e)Tt.call(e,n)&&Qn(t,n,e[n])})),va=Mr((function(t,e){Ar(e,Ra(e),t)})),_a=Mr((function(t,e,n,i){Ar(e,Ra(e),t,i)})),Ca=Mr((function(t,e,n,i){Ar(e,La(e),t,i)})),ba=Qr(ri),Ia=qi((function(t,e){t=Et(t);var n=-1,i=e.length,o=i>2?e[2]:r;for(o&&wo(e[0],e[1],o)&&(i=1);++n<i;)for(var s=e[n],a=Ra(s),c=-1,d=a.length;++c<d;){var l=a[c],h=t[l];(h===r||Us(h,Lt[l])&&!Tt.call(t,l))&&(t[l]=s[l])}return t})),Ea=qi((function(t){return t.push(r,Jr),Ie(Ta,r,t)}));function xa(t,e,n){var i=null==t?r:Ci(t,e);return i===r?n:i}function Sa(t,e){return null!=t&&po(t,e,Si)}var Aa=Dr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Bt.call(e)),t[e]=n}),Qa(nc)),Pa=Dr((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Bt.call(e)),Tt.call(t,e)?t[e].push(n):t[e]=[n]}),oo),Ma=qi(Pi);function La(t){return Gs(t)?Zn(t):ki(t)}function Ra(t){return Gs(t)?Zn(t,!0):function(t){if(!Qs(t))return function(t){var e=[];if(null!=t)for(var n in Et(t))e.push(n);return e}(t);var e=Co(t),n=[];for(var i in t)("constructor"!=i||!e&&Tt.call(t,i))&&n.push(i);return n}(t)}var Oa=Mr((function(t,e,n){Ui(t,e,n)})),Ta=Mr((function(t,e,n,i){Ui(t,e,n,i)})),ka=Qr((function(t,e){var n={};if(null==t)return n;var i=!1;e=Re(e,(function(e){return e=gr(e,t),i||(i=e.length>1),e})),Ar(t,eo(t),n),i&&(n=si(n,7,Kr));for(var r=e.length;r--;)cr(n,e[r]);return n})),za=Qr((function(t,e){return null==t?{}:function(t,e){return $i(t,e,(function(e,n){return Sa(t,n)}))}(t,e)}));function Ba(t,e){if(null==t)return{};var n=Re(eo(t),(function(t){return[t]}));return e=oo(e),$i(t,n,(function(t,n){return e(t,n[0])}))}var Fa=qr(La),Da=qr(Ra);function Ua(t){return null==t?[]:Je(t,La(t))}var ja=Tr((function(t,e,n){return e=e.toLowerCase(),t+(n?Wa(e):e)}));function Wa(t){return Ya(wa(t).toLowerCase())}function $a(t){return(t=wa(t))&&t.replace(yt,tn).replace(Kt,"")}var Ha=Tr((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Na=Tr((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),Ga=Or("toLowerCase"),Va=Tr((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),qa=Tr((function(t,e,n){return t+(n?" ":"")+Ya(e)})),Za=Tr((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ya=Or("toUpperCase");function Ja(t,e,n){return t=wa(t),(e=n?r:e)===r?function(t){return ee.test(t)}(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.match(ct)||[]}(t):t.match(e)||[]}var Ka=qi((function(t,e){try{return Ie(t,r,e)}catch(t){return Ys(t)?t:new Ct(t)}})),Xa=Qr((function(t,e){return xe(e,(function(e){e=Bo(e),ii(t,e,Ps(t[e],t))})),t}));function Qa(t){return function(){return t}}var tc=Br(),ec=Br(!0);function nc(t){return t}function ic(t){return Ti("function"==typeof t?t:si(t,1))}var rc=qi((function(t,e){return function(n){return Pi(n,t,e)}})),oc=qi((function(t,e){return function(n){return Pi(t,n,e)}}));function sc(t,e,n){var i=La(e),r=_i(e,i);null!=n||Qs(e)&&(r.length||!i.length)||(n=e,e=t,t=this,r=_i(e,La(e)));var o=!(Qs(n)&&"chain"in n&&!n.chain),s=Js(t);return xe(r,(function(n){var i=e[n];t[n]=i,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=Sr(this.__actions__)).push({func:i,args:arguments,thisArg:t}),n.__chain__=e,n}return i.apply(t,Oe([this.value()],arguments))})})),t}function ac(){}var cc=jr(Re),dc=jr(Ae),lc=jr(ze);function hc(t){return yo(t)?He(Bo(t)):function(t){return function(e){return Ci(e,t)}}(t)}var uc=$r(),pc=$r(!0);function fc(){return[]}function mc(){return!1}var gc,wc=Ur((function(t,e){return t+e}),0),yc=Gr("ceil"),vc=Ur((function(t,e){return t/e}),1),_c=Gr("floor"),Cc=Ur((function(t,e){return t*e}),1),bc=Gr("round"),Ic=Ur((function(t,e){return t-e}),0);return Dn.after=function(t,e){if("function"!=typeof e)throw new At(o);return t=pa(t),function(){if(--t<1)return e.apply(this,arguments)}},Dn.ary=Ss,Dn.assign=ya,Dn.assignIn=va,Dn.assignInWith=_a,Dn.assignWith=Ca,Dn.at=ba,Dn.before=As,Dn.bind=Ps,Dn.bindAll=Xa,Dn.bindKey=Ms,Dn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Hs(t)?t:[t]},Dn.chain=hs,Dn.chunk=function(t,e,n){e=(n?wo(t,e,n):e===r)?1:gn(pa(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var s=0,a=0,c=i(ue(o/e));s<o;)c[a++]=tr(t,s,s+=e);return c},Dn.compact=function(t){for(var e=-1,n=null==t?0:t.length,i=0,r=[];++e<n;){var o=t[e];o&&(r[i++]=o)}return r},Dn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=i(t-1),n=arguments[0],r=t;r--;)e[r-1]=arguments[r];return Oe(Hs(n)?Sr(n):[n],mi(e,1))},Dn.cond=function(t){var e=null==t?0:t.length,n=oo();return t=e?Re(t,(function(t){if("function"!=typeof t[1])throw new At(o);return[n(t[0]),t[1]]})):[],qi((function(n){for(var i=-1;++i<e;){var r=t[i];if(Ie(r[0],this,n))return Ie(r[1],this,n)}}))},Dn.conforms=function(t){return function(t){var e=La(t);return function(n){return ai(n,t,e)}}(si(t,1))},Dn.constant=Qa,Dn.countBy=fs,Dn.create=function(t,e){var n=Un(t);return null==e?n:ni(n,e)},Dn.curry=function t(e,n,i){var o=Zr(e,8,r,r,r,r,r,n=i?r:n);return o.placeholder=t.placeholder,o},Dn.curryRight=function t(e,n,i){var o=Zr(e,16,r,r,r,r,r,n=i?r:n);return o.placeholder=t.placeholder,o},Dn.debounce=Ls,Dn.defaults=Ia,Dn.defaultsDeep=Ea,Dn.defer=Rs,Dn.delay=Os,Dn.difference=Uo,Dn.differenceBy=jo,Dn.differenceWith=Wo,Dn.drop=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,(e=n||e===r?1:pa(e))<0?0:e,i):[]},Dn.dropRight=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,0,(e=i-(e=n||e===r?1:pa(e)))<0?0:e):[]},Dn.dropRightWhile=function(t,e){return t&&t.length?lr(t,oo(e,3),!0,!0):[]},Dn.dropWhile=function(t,e){return t&&t.length?lr(t,oo(e,3),!0):[]},Dn.fill=function(t,e,n,i){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&wo(t,e,n)&&(n=0,i=o),function(t,e,n,i){var o=t.length;for((n=pa(n))<0&&(n=-n>o?0:o+n),(i=i===r||i>o?o:pa(i))<0&&(i+=o),i=n>i?0:fa(i);n<i;)t[n++]=e;return t}(t,e,n,i)):[]},Dn.filter=function(t,e){return(Hs(t)?Pe:fi)(t,oo(e,3))},Dn.flatMap=function(t,e){return mi(bs(t,e),1)},Dn.flatMapDeep=function(t,e){return mi(bs(t,e),l)},Dn.flatMapDepth=function(t,e,n){return n=n===r?1:pa(n),mi(bs(t,e),n)},Dn.flatten=No,Dn.flattenDeep=function(t){return null!=t&&t.length?mi(t,l):[]},Dn.flattenDepth=function(t,e){return null!=t&&t.length?mi(t,e=e===r?1:pa(e)):[]},Dn.flip=function(t){return Zr(t,512)},Dn.flow=tc,Dn.flowRight=ec,Dn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,i={};++e<n;){var r=t[e];i[r[0]]=r[1]}return i},Dn.functions=function(t){return null==t?[]:_i(t,La(t))},Dn.functionsIn=function(t){return null==t?[]:_i(t,Ra(t))},Dn.groupBy=vs,Dn.initial=function(t){return null!=t&&t.length?tr(t,0,-1):[]},Dn.intersection=Vo,Dn.intersectionBy=qo,Dn.intersectionWith=Zo,Dn.invert=Aa,Dn.invertBy=Pa,Dn.invokeMap=_s,Dn.iteratee=ic,Dn.keyBy=Cs,Dn.keys=La,Dn.keysIn=Ra,Dn.map=bs,Dn.mapKeys=function(t,e){var n={};return e=oo(e,3),yi(t,(function(t,i,r){ii(n,e(t,i,r),t)})),n},Dn.mapValues=function(t,e){var n={};return e=oo(e,3),yi(t,(function(t,i,r){ii(n,i,e(t,i,r))})),n},Dn.matches=function(t){return Fi(si(t,1))},Dn.matchesProperty=function(t,e){return Di(t,si(e,1))},Dn.memoize=Ts,Dn.merge=Oa,Dn.mergeWith=Ta,Dn.method=rc,Dn.methodOf=oc,Dn.mixin=sc,Dn.negate=ks,Dn.nthArg=function(t){return t=pa(t),qi((function(e){return ji(e,t)}))},Dn.omit=ka,Dn.omitBy=function(t,e){return Ba(t,ks(oo(e)))},Dn.once=function(t){return As(2,t)},Dn.orderBy=function(t,e,n,i){return null==t?[]:(Hs(e)||(e=null==e?[]:[e]),Hs(n=i?r:n)||(n=null==n?[]:[n]),Wi(t,e,n))},Dn.over=cc,Dn.overArgs=zs,Dn.overEvery=dc,Dn.overSome=lc,Dn.partial=Bs,Dn.partialRight=Fs,Dn.partition=Is,Dn.pick=za,Dn.pickBy=Ba,Dn.property=hc,Dn.propertyOf=function(t){return function(e){return null==t?r:Ci(t,e)}},Dn.pull=Jo,Dn.pullAll=Ko,Dn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Hi(t,e,oo(n,2)):t},Dn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Hi(t,e,r,n):t},Dn.pullAt=Xo,Dn.range=uc,Dn.rangeRight=pc,Dn.rearg=Ds,Dn.reject=function(t,e){return(Hs(t)?Pe:fi)(t,ks(oo(e,3)))},Dn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var i=-1,r=[],o=t.length;for(e=oo(e,3);++i<o;){var s=t[i];e(s,i,t)&&(n.push(s),r.push(i))}return Ni(t,r),n},Dn.rest=function(t,e){if("function"!=typeof t)throw new At(o);return qi(t,e=e===r?e:pa(e))},Dn.reverse=Qo,Dn.sampleSize=function(t,e,n){return e=(n?wo(t,e,n):e===r)?1:pa(e),(Hs(t)?Jn:Yi)(t,e)},Dn.set=function(t,e,n){return null==t?t:Ji(t,e,n)},Dn.setWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:Ji(t,e,n,i)},Dn.shuffle=function(t){return(Hs(t)?Kn:Qi)(t)},Dn.slice=function(t,e,n){var i=null==t?0:t.length;return i?(n&&"number"!=typeof n&&wo(t,e,n)?(e=0,n=i):(e=null==e?0:pa(e),n=n===r?i:pa(n)),tr(t,e,n)):[]},Dn.sortBy=Es,Dn.sortedUniq=function(t){return t&&t.length?rr(t):[]},Dn.sortedUniqBy=function(t,e){return t&&t.length?rr(t,oo(e,2)):[]},Dn.split=function(t,e,n){return n&&"number"!=typeof n&&wo(t,e,n)&&(e=n=r),(n=n===r?p:n>>>0)?(t=wa(t))&&("string"==typeof e||null!=e&&!ra(e))&&!(e=sr(e))&&rn(t)?yr(hn(t),0,n):t.split(e,n):[]},Dn.spread=function(t,e){if("function"!=typeof t)throw new At(o);return e=null==e?0:gn(pa(e),0),qi((function(n){var i=n[e],r=yr(n,0,e);return i&&Oe(r,i),Ie(t,this,r)}))},Dn.tail=function(t){var e=null==t?0:t.length;return e?tr(t,1,e):[]},Dn.take=function(t,e,n){return t&&t.length?tr(t,0,(e=n||e===r?1:pa(e))<0?0:e):[]},Dn.takeRight=function(t,e,n){var i=null==t?0:t.length;return i?tr(t,(e=i-(e=n||e===r?1:pa(e)))<0?0:e,i):[]},Dn.takeRightWhile=function(t,e){return t&&t.length?lr(t,oo(e,3),!1,!0):[]},Dn.takeWhile=function(t,e){return t&&t.length?lr(t,oo(e,3)):[]},Dn.tap=function(t,e){return e(t),t},Dn.throttle=function(t,e,n){var i=!0,r=!0;if("function"!=typeof t)throw new At(o);return Qs(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Ls(t,e,{leading:i,maxWait:e,trailing:r})},Dn.thru=us,Dn.toArray=ha,Dn.toPairs=Fa,Dn.toPairsIn=Da,Dn.toPath=function(t){return Hs(t)?Re(t,Bo):aa(t)?[t]:Sr(zo(wa(t)))},Dn.toPlainObject=ga,Dn.transform=function(t,e,n){var i=Hs(t),r=i||qs(t)||ca(t);if(e=oo(e,4),null==n){var o=t&&t.constructor;n=r?i?new o:[]:Qs(t)&&Js(o)?Un(Nt(t)):{}}return(r?xe:yi)(t,(function(t,i,r){return e(n,t,i,r)})),n},Dn.unary=function(t){return Ss(t,1)},Dn.union=ts,Dn.unionBy=es,Dn.unionWith=ns,Dn.uniq=function(t){return t&&t.length?ar(t):[]},Dn.uniqBy=function(t,e){return t&&t.length?ar(t,oo(e,2)):[]},Dn.uniqWith=function(t,e){return e="function"==typeof e?e:r,t&&t.length?ar(t,r,e):[]},Dn.unset=function(t,e){return null==t||cr(t,e)},Dn.unzip=is,Dn.unzipWith=rs,Dn.update=function(t,e,n){return null==t?t:dr(t,e,mr(n))},Dn.updateWith=function(t,e,n,i){return i="function"==typeof i?i:r,null==t?t:dr(t,e,mr(n),i)},Dn.values=Ua,Dn.valuesIn=function(t){return null==t?[]:Je(t,Ra(t))},Dn.without=os,Dn.words=Ja,Dn.wrap=function(t,e){return Bs(mr(e),t)},Dn.xor=ss,Dn.xorBy=as,Dn.xorWith=cs,Dn.zip=ds,Dn.zipObject=function(t,e){return pr(t||[],e||[],Qn)},Dn.zipObjectDeep=function(t,e){return pr(t||[],e||[],Ji)},Dn.zipWith=ls,Dn.entries=Fa,Dn.entriesIn=Da,Dn.extend=va,Dn.extendWith=_a,sc(Dn,Dn),Dn.add=wc,Dn.attempt=Ka,Dn.camelCase=ja,Dn.capitalize=Wa,Dn.ceil=yc,Dn.clamp=function(t,e,n){return n===r&&(n=e,e=r),n!==r&&(n=(n=ma(n))==n?n:0),e!==r&&(e=(e=ma(e))==e?e:0),oi(ma(t),e,n)},Dn.clone=function(t){return si(t,4)},Dn.cloneDeep=function(t){return si(t,5)},Dn.cloneDeepWith=function(t,e){return si(t,5,e="function"==typeof e?e:r)},Dn.cloneWith=function(t,e){return si(t,4,e="function"==typeof e?e:r)},Dn.conformsTo=function(t,e){return null==e||ai(t,e,La(e))},Dn.deburr=$a,Dn.defaultTo=function(t,e){return null==t||t!=t?e:t},Dn.divide=vc,Dn.endsWith=function(t,e,n){t=wa(t),e=sr(e);var i=t.length,o=n=n===r?i:oi(pa(n),0,i);return(n-=e.length)>=0&&t.slice(n,o)==e},Dn.eq=Us,Dn.escape=function(t){return(t=wa(t))&&Z.test(t)?t.replace(V,en):t},Dn.escapeRegExp=function(t){return(t=wa(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Dn.every=function(t,e,n){var i=Hs(t)?Ae:ui;return n&&wo(t,e,n)&&(e=r),i(t,oo(e,3))},Dn.find=ms,Dn.findIndex=$o,Dn.findKey=function(t,e){return Fe(t,oo(e,3),yi)},Dn.findLast=gs,Dn.findLastIndex=Ho,Dn.findLastKey=function(t,e){return Fe(t,oo(e,3),vi)},Dn.floor=_c,Dn.forEach=ws,Dn.forEachRight=ys,Dn.forIn=function(t,e){return null==t?t:gi(t,oo(e,3),Ra)},Dn.forInRight=function(t,e){return null==t?t:wi(t,oo(e,3),Ra)},Dn.forOwn=function(t,e){return t&&yi(t,oo(e,3))},Dn.forOwnRight=function(t,e){return t&&vi(t,oo(e,3))},Dn.get=xa,Dn.gt=js,Dn.gte=Ws,Dn.has=function(t,e){return null!=t&&po(t,e,xi)},Dn.hasIn=Sa,Dn.head=Go,Dn.identity=nc,Dn.includes=function(t,e,n,i){t=Gs(t)?t:Ua(t),n=n&&!i?pa(n):0;var r=t.length;return n<0&&(n=gn(r+n,0)),sa(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&Ue(t,e,n)>-1},Dn.indexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:pa(n);return r<0&&(r=gn(i+r,0)),Ue(t,e,r)},Dn.inRange=function(t,e,n){return e=ua(e),n===r?(n=e,e=0):n=ua(n),function(t,e,n){return t>=wn(e,n)&&t<gn(e,n)}(t=ma(t),e,n)},Dn.invoke=Ma,Dn.isArguments=$s,Dn.isArray=Hs,Dn.isArrayBuffer=Ns,Dn.isArrayLike=Gs,Dn.isArrayLikeObject=Vs,Dn.isBoolean=function(t){return!0===t||!1===t||ta(t)&&Ii(t)==w},Dn.isBuffer=qs,Dn.isDate=Zs,Dn.isElement=function(t){return ta(t)&&1===t.nodeType&&!ia(t)},Dn.isEmpty=function(t){if(null==t)return!0;if(Gs(t)&&(Hs(t)||"string"==typeof t||"function"==typeof t.splice||qs(t)||ca(t)||$s(t)))return!t.length;var e=uo(t);if(e==b||e==A)return!t.size;if(Co(t))return!ki(t).length;for(var n in t)if(Tt.call(t,n))return!1;return!0},Dn.isEqual=function(t,e){return Li(t,e)},Dn.isEqualWith=function(t,e,n){var i=(n="function"==typeof n?n:r)?n(t,e):r;return i===r?Li(t,e,r,n):!!i},Dn.isError=Ys,Dn.isFinite=function(t){return"number"==typeof t&&Be(t)},Dn.isFunction=Js,Dn.isInteger=Ks,Dn.isLength=Xs,Dn.isMap=ea,Dn.isMatch=function(t,e){return t===e||Ri(t,e,ao(e))},Dn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:r,Ri(t,e,ao(e),n)},Dn.isNaN=function(t){return na(t)&&t!=+t},Dn.isNative=function(t){if(_o(t))throw new Ct("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Oi(t)},Dn.isNil=function(t){return null==t},Dn.isNull=function(t){return null===t},Dn.isNumber=na,Dn.isObject=Qs,Dn.isObjectLike=ta,Dn.isPlainObject=ia,Dn.isRegExp=ra,Dn.isSafeInteger=function(t){return Ks(t)&&t>=-9007199254740991&&t<=h},Dn.isSet=oa,Dn.isString=sa,Dn.isSymbol=aa,Dn.isTypedArray=ca,Dn.isUndefined=function(t){return t===r},Dn.isWeakMap=function(t){return ta(t)&&uo(t)==L},Dn.isWeakSet=function(t){return ta(t)&&"[object WeakSet]"==Ii(t)},Dn.join=function(t,e){return null==t?"":Ne.call(t,e)},Dn.kebabCase=Ha,Dn.last=Yo,Dn.lastIndexOf=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var o=i;return n!==r&&(o=(o=pa(n))<0?gn(i+o,0):wn(o,i-1)),e==e?function(t,e,n){for(var i=n+1;i--;)if(t[i]===e)return i;return i}(t,e,o):De(t,We,o,!0)},Dn.lowerCase=Na,Dn.lowerFirst=Ga,Dn.lt=da,Dn.lte=la,Dn.max=function(t){return t&&t.length?pi(t,nc,Ei):r},Dn.maxBy=function(t,e){return t&&t.length?pi(t,oo(e,2),Ei):r},Dn.mean=function(t){return $e(t,nc)},Dn.meanBy=function(t,e){return $e(t,oo(e,2))},Dn.min=function(t){return t&&t.length?pi(t,nc,zi):r},Dn.minBy=function(t,e){return t&&t.length?pi(t,oo(e,2),zi):r},Dn.stubArray=fc,Dn.stubFalse=mc,Dn.stubObject=function(){return{}},Dn.stubString=function(){return""},Dn.stubTrue=function(){return!0},Dn.multiply=Cc,Dn.nth=function(t,e){return t&&t.length?ji(t,pa(e)):r},Dn.noConflict=function(){return he._===this&&(he._=Dt),this},Dn.noop=ac,Dn.now=xs,Dn.pad=function(t,e,n){t=wa(t);var i=(e=pa(e))?ln(t):0;if(!e||i>=e)return t;var r=(e-i)/2;return Wr(pe(r),n)+t+Wr(ue(r),n)},Dn.padEnd=function(t,e,n){t=wa(t);var i=(e=pa(e))?ln(t):0;return e&&i<e?t+Wr(e-i,n):t},Dn.padStart=function(t,e,n){t=wa(t);var i=(e=pa(e))?ln(t):0;return e&&i<e?Wr(e-i,n)+t:t},Dn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),vn(wa(t).replace(it,""),e||0)},Dn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&wo(t,e,n)&&(e=n=r),n===r&&("boolean"==typeof e?(n=e,e=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&e===r?(t=0,e=1):(t=ua(t),e===r?(e=t,t=0):e=ua(e)),t>e){var i=t;t=e,e=i}if(n||t%1||e%1){var o=_n();return wn(t+o*(e-t+ae("1e-"+((o+"").length-1))),e)}return Gi(t,e)},Dn.reduce=function(t,e,n){var i=Hs(t)?Te:Ge,r=arguments.length<3;return i(t,oo(e,4),n,r,li)},Dn.reduceRight=function(t,e,n){var i=Hs(t)?ke:Ge,r=arguments.length<3;return i(t,oo(e,4),n,r,hi)},Dn.repeat=function(t,e,n){return e=(n?wo(t,e,n):e===r)?1:pa(e),Vi(wa(t),e)},Dn.replace=function(){var t=arguments,e=wa(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Dn.result=function(t,e,n){var i=-1,o=(e=gr(e,t)).length;for(o||(o=1,t=r);++i<o;){var s=null==t?r:t[Bo(e[i])];s===r&&(i=o,s=n),t=Js(s)?s.call(t):s}return t},Dn.round=bc,Dn.runInContext=t,Dn.sample=function(t){return(Hs(t)?Yn:Zi)(t)},Dn.size=function(t){if(null==t)return 0;if(Gs(t))return sa(t)?ln(t):t.length;var e=uo(t);return e==b||e==A?t.size:ki(t).length},Dn.snakeCase=Va,Dn.some=function(t,e,n){var i=Hs(t)?ze:er;return n&&wo(t,e,n)&&(e=r),i(t,oo(e,3))},Dn.sortedIndex=function(t,e){return nr(t,e)},Dn.sortedIndexBy=function(t,e,n){return ir(t,e,oo(n,2))},Dn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var i=nr(t,e);if(i<n&&Us(t[i],e))return i}return-1},Dn.sortedLastIndex=function(t,e){return nr(t,e,!0)},Dn.sortedLastIndexBy=function(t,e,n){return ir(t,e,oo(n,2),!0)},Dn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=nr(t,e,!0)-1;if(Us(t[n],e))return n}return-1},Dn.startCase=qa,Dn.startsWith=function(t,e,n){return t=wa(t),n=null==n?0:oi(pa(n),0,t.length),e=sr(e),t.slice(n,n+e.length)==e},Dn.subtract=Ic,Dn.sum=function(t){return t&&t.length?Ve(t,nc):0},Dn.sumBy=function(t,e){return t&&t.length?Ve(t,oo(e,2)):0},Dn.template=function(t,e,n){var i=Dn.templateSettings;n&&wo(t,e,n)&&(e=r),t=wa(t),e=_a({},e,i,Yr);var o,s,a=_a({},e.imports,i.imports,Yr),c=La(a),d=Je(a,c),l=0,h=e.interpolate||vt,u="__p += '",p=xt((e.escape||vt).source+"|"+h.source+"|"+(h===K?ht:vt).source+"|"+(e.evaluate||vt).source+"|$","g"),f="//# sourceURL="+(Tt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ie+"]")+"\n";t.replace(p,(function(e,n,i,r,a,c){return i||(i=r),u+=t.slice(l,c).replace(_t,nn),n&&(o=!0,u+="' +\n__e("+n+") +\n'"),a&&(s=!0,u+="';\n"+a+";\n__p += '"),i&&(u+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),l=c+e.length,e})),u+="';\n";var m=Tt.call(e,"variable")&&e.variable;if(m){if(dt.test(m))throw new Ct("Invalid `variable` option passed into `_.template`")}else u="with (obj) {\n"+u+"\n}\n";u=(s?u.replace($,""):u).replace(H,"$1").replace(N,"$1;"),u="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+u+"return __p\n}";var g=Ka((function(){return bt(c,f+"return "+u).apply(r,d)}));if(g.source=u,Ys(g))throw g;return g},Dn.times=function(t,e){if((t=pa(t))<1||t>h)return[];var n=p,i=wn(t,p);e=oo(e),t-=p;for(var r=qe(i,e);++n<t;)e(n);return r},Dn.toFinite=ua,Dn.toInteger=pa,Dn.toLength=fa,Dn.toLower=function(t){return wa(t).toLowerCase()},Dn.toNumber=ma,Dn.toSafeInteger=function(t){return t?oi(pa(t),-9007199254740991,h):0===t?t:0},Dn.toString=wa,Dn.toUpper=function(t){return wa(t).toUpperCase()},Dn.trim=function(t,e,n){if((t=wa(t))&&(n||e===r))return Ze(t);if(!t||!(e=sr(e)))return t;var i=hn(t),o=hn(e);return yr(i,Xe(i,o),Qe(i,o)+1).join("")},Dn.trimEnd=function(t,e,n){if((t=wa(t))&&(n||e===r))return t.slice(0,un(t)+1);if(!t||!(e=sr(e)))return t;var i=hn(t);return yr(i,0,Qe(i,hn(e))+1).join("")},Dn.trimStart=function(t,e,n){if((t=wa(t))&&(n||e===r))return t.replace(it,"");if(!t||!(e=sr(e)))return t;var i=hn(t);return yr(i,Xe(i,hn(e))).join("")},Dn.truncate=function(t,e){var n=30,i="...";if(Qs(e)){var o="separator"in e?e.separator:o;n="length"in e?pa(e.length):n,i="omission"in e?sr(e.omission):i}var s=(t=wa(t)).length;if(rn(t)){var a=hn(t);s=a.length}if(n>=s)return t;var c=n-ln(i);if(c<1)return i;var d=a?yr(a,0,c).join(""):t.slice(0,c);if(o===r)return d+i;if(a&&(c+=d.length-c),ra(o)){if(t.slice(c).search(o)){var l,h=d;for(o.global||(o=xt(o.source,wa(ut.exec(o))+"g")),o.lastIndex=0;l=o.exec(h);)var u=l.index;d=d.slice(0,u===r?c:u)}}else if(t.indexOf(sr(o),c)!=c){var p=d.lastIndexOf(o);p>-1&&(d=d.slice(0,p))}return d+i},Dn.unescape=function(t){return(t=wa(t))&&q.test(t)?t.replace(G,pn):t},Dn.uniqueId=function(t){var e=++kt;return wa(t)+e},Dn.upperCase=Za,Dn.upperFirst=Ya,Dn.each=ws,Dn.eachRight=ys,Dn.first=Go,sc(Dn,(gc={},yi(Dn,(function(t,e){Tt.call(Dn.prototype,e)||(gc[e]=t)})),gc),{chain:!1}),Dn.VERSION="4.17.21",xe(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Dn[t].placeholder=Dn})),xe(["drop","take"],(function(t,e){$n.prototype[t]=function(n){n=n===r?1:gn(pa(n),0);var i=this.__filtered__&&!e?new $n(this):this.clone();return i.__filtered__?i.__takeCount__=wn(n,i.__takeCount__):i.__views__.push({size:wn(n,p),type:t+(i.__dir__<0?"Right":"")}),i},$n.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),xe(["filter","map","takeWhile"],(function(t,e){var n=e+1,i=1==n||3==n;$n.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:oo(t,3),type:n}),e.__filtered__=e.__filtered__||i,e}})),xe(["head","last"],(function(t,e){var n="take"+(e?"Right":"");$n.prototype[t]=function(){return this[n](1).value()[0]}})),xe(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");$n.prototype[t]=function(){return this.__filtered__?new $n(this):this[n](1)}})),$n.prototype.compact=function(){return this.filter(nc)},$n.prototype.find=function(t){return this.filter(t).head()},$n.prototype.findLast=function(t){return this.reverse().find(t)},$n.prototype.invokeMap=qi((function(t,e){return"function"==typeof t?new $n(this):this.map((function(n){return Pi(n,t,e)}))})),$n.prototype.reject=function(t){return this.filter(ks(oo(t)))},$n.prototype.slice=function(t,e){t=pa(t);var n=this;return n.__filtered__&&(t>0||e<0)?new $n(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==r&&(n=(e=pa(e))<0?n.dropRight(-e):n.take(e-t)),n)},$n.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},$n.prototype.toArray=function(){return this.take(p)},yi($n.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),i=/^(?:head|last)$/.test(e),o=Dn[i?"take"+("last"==e?"Right":""):e],s=i||/^find/.test(e);o&&(Dn.prototype[e]=function(){var e=this.__wrapped__,a=i?[1]:arguments,c=e instanceof $n,d=a[0],l=c||Hs(e),h=function(t){var e=o.apply(Dn,Oe([t],a));return i&&u?e[0]:e};l&&n&&"function"==typeof d&&1!=d.length&&(c=l=!1);var u=this.__chain__,p=!!this.__actions__.length,f=s&&!u,m=c&&!p;if(!s&&l){e=m?e:new $n(this);var g=t.apply(e,a);return g.__actions__.push({func:us,args:[h],thisArg:r}),new Wn(g,u)}return f&&m?t.apply(this,a):(g=this.thru(h),f?i?g.value()[0]:g.value():g)})})),xe(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Pt[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",i=/^(?:pop|shift)$/.test(t);Dn.prototype[t]=function(){var t=arguments;if(i&&!this.__chain__){var r=this.value();return e.apply(Hs(r)?r:[],t)}return this[n]((function(n){return e.apply(Hs(n)?n:[],t)}))}})),yi($n.prototype,(function(t,e){var n=Dn[e];if(n){var i=n.name+"";Tt.call(Mn,i)||(Mn[i]=[]),Mn[i].push({name:e,func:n})}})),Mn[Fr(r,2).name]=[{name:"wrapper",func:r}],$n.prototype.clone=function(){var t=new $n(this.__wrapped__);return t.__actions__=Sr(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Sr(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Sr(this.__views__),t},$n.prototype.reverse=function(){if(this.__filtered__){var t=new $n(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},$n.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Hs(t),i=e<0,r=n?t.length:0,o=function(t,e,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=wn(e,t+s);break;case"takeRight":t=gn(t,e-s)}}return{start:t,end:e}}(0,r,this.__views__),s=o.start,a=o.end,c=a-s,d=i?a:s-1,l=this.__iteratees__,h=l.length,u=0,p=wn(c,this.__takeCount__);if(!n||!i&&r==c&&p==c)return hr(t,this.__actions__);var f=[];t:for(;c--&&u<p;){for(var m=-1,g=t[d+=e];++m<h;){var w=l[m],y=w.iteratee,v=w.type,_=y(g);if(2==v)g=_;else if(!_){if(1==v)continue t;break t}}f[u++]=g}return f},Dn.prototype.at=ps,Dn.prototype.chain=function(){return hs(this)},Dn.prototype.commit=function(){return new Wn(this.value(),this.__chain__)},Dn.prototype.next=function(){this.__values__===r&&(this.__values__=ha(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?r:this.__values__[this.__index__++]}},Dn.prototype.plant=function(t){for(var e,n=this;n instanceof jn;){var i=Do(n);i.__index__=0,i.__values__=r,e?o.__wrapped__=i:e=i;var o=i;n=n.__wrapped__}return o.__wrapped__=t,e},Dn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof $n){var e=t;return this.__actions__.length&&(e=new $n(this)),(e=e.reverse()).__actions__.push({func:us,args:[Qo],thisArg:r}),new Wn(e,this.__chain__)}return this.thru(Qo)},Dn.prototype.toJSON=Dn.prototype.valueOf=Dn.prototype.value=function(){return hr(this.__wrapped__,this.__actions__)},Dn.prototype.first=Dn.prototype.head,Yt&&(Dn.prototype[Yt]=function(){return this}),Dn}();he._=fn,(i=function(){return fn}.call(e,n,e,t))===r||(t.exports=i)}.call(this)},412:(t,e,n)=>{var i;n.r(e),n.d(e,{NIL:()=>L,parse:()=>g,stringify:()=>l,v1:()=>m,v3:()=>x,v4:()=>S,v5:()=>M,validate:()=>a,version:()=>R});var r=new Uint8Array(16);function o(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(r)}const s=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(t){return"string"==typeof t&&s.test(t)};for(var c=[],d=0;d<256;++d)c.push((d+256).toString(16).substr(1));const l=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[t[e+0]]+c[t[e+1]]+c[t[e+2]]+c[t[e+3]]+"-"+c[t[e+4]]+c[t[e+5]]+"-"+c[t[e+6]]+c[t[e+7]]+"-"+c[t[e+8]]+c[t[e+9]]+"-"+c[t[e+10]]+c[t[e+11]]+c[t[e+12]]+c[t[e+13]]+c[t[e+14]]+c[t[e+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n};var h,u,p=0,f=0;const m=function(t,e,n){var i=e&&n||0,r=e||new Array(16),s=(t=t||{}).node||h,a=void 0!==t.clockseq?t.clockseq:u;if(null==s||null==a){var c=t.random||(t.rng||o)();null==s&&(s=h=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==a&&(a=u=16383&(c[6]<<8|c[7]))}var d=void 0!==t.msecs?t.msecs:Date.now(),m=void 0!==t.nsecs?t.nsecs:f+1,g=d-p+(m-f)/1e4;if(g<0&&void 0===t.clockseq&&(a=a+1&16383),(g<0||d>p)&&void 0===t.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=d,f=m,u=a;var w=(1e4*(268435455&(d+=122192928e5))+m)%4294967296;r[i++]=w>>>24&255,r[i++]=w>>>16&255,r[i++]=w>>>8&255,r[i++]=255&w;var y=d/4294967296*1e4&268435455;r[i++]=y>>>8&255,r[i++]=255&y,r[i++]=y>>>24&15|16,r[i++]=y>>>16&255,r[i++]=a>>>8|128,r[i++]=255&a;for(var v=0;v<6;++v)r[i+v]=s[v];return e||l(r)},g=function(t){if(!a(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n};function w(t,e,n){function i(t,i,r,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof i&&(i=g(i)),16!==i.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(i),s.set(t,i.length),(s=n(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,r){o=o||0;for(var a=0;a<16;++a)r[o+a]=s[a];return r}return l(s)}try{i.name=t}catch(t){}return i.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",i.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",i}function y(t){return 14+(t+64>>>9<<4)+1}function v(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function _(t,e,n,i,r,o){return v((s=v(v(e,t),v(i,o)))<<(a=r)|s>>>32-a,n);var s,a}function C(t,e,n,i,r,o,s){return _(e&n|~e&i,t,e,r,o,s)}function b(t,e,n,i,r,o,s){return _(e&i|n&~i,t,e,r,o,s)}function I(t,e,n,i,r,o,s){return _(e^n^i,t,e,r,o,s)}function E(t,e,n,i,r,o,s){return _(n^(e|~i),t,e,r,o,s)}const x=w("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)}return function(t){for(var e=[],n=32*t.length,i="0123456789abcdef",r=0;r<n;r+=8){var o=t[r>>5]>>>r%32&255,s=parseInt(i.charAt(o>>>4&15)+i.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[y(e)-1]=e;for(var n=1732584193,i=-271733879,r=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=n,c=i,d=r,l=o;n=C(n,i,r,o,t[s],7,-680876936),o=C(o,n,i,r,t[s+1],12,-389564586),r=C(r,o,n,i,t[s+2],17,606105819),i=C(i,r,o,n,t[s+3],22,-1044525330),n=C(n,i,r,o,t[s+4],7,-176418897),o=C(o,n,i,r,t[s+5],12,1200080426),r=C(r,o,n,i,t[s+6],17,-1473231341),i=C(i,r,o,n,t[s+7],22,-45705983),n=C(n,i,r,o,t[s+8],7,1770035416),o=C(o,n,i,r,t[s+9],12,-1958414417),r=C(r,o,n,i,t[s+10],17,-42063),i=C(i,r,o,n,t[s+11],22,-1990404162),n=C(n,i,r,o,t[s+12],7,1804603682),o=C(o,n,i,r,t[s+13],12,-40341101),r=C(r,o,n,i,t[s+14],17,-1502002290),n=b(n,i=C(i,r,o,n,t[s+15],22,1236535329),r,o,t[s+1],5,-165796510),o=b(o,n,i,r,t[s+6],9,-1069501632),r=b(r,o,n,i,t[s+11],14,643717713),i=b(i,r,o,n,t[s],20,-373897302),n=b(n,i,r,o,t[s+5],5,-701558691),o=b(o,n,i,r,t[s+10],9,38016083),r=b(r,o,n,i,t[s+15],14,-660478335),i=b(i,r,o,n,t[s+4],20,-405537848),n=b(n,i,r,o,t[s+9],5,568446438),o=b(o,n,i,r,t[s+14],9,-1019803690),r=b(r,o,n,i,t[s+3],14,-187363961),i=b(i,r,o,n,t[s+8],20,1163531501),n=b(n,i,r,o,t[s+13],5,-1444681467),o=b(o,n,i,r,t[s+2],9,-51403784),r=b(r,o,n,i,t[s+7],14,1735328473),n=I(n,i=b(i,r,o,n,t[s+12],20,-1926607734),r,o,t[s+5],4,-378558),o=I(o,n,i,r,t[s+8],11,-2022574463),r=I(r,o,n,i,t[s+11],16,1839030562),i=I(i,r,o,n,t[s+14],23,-35309556),n=I(n,i,r,o,t[s+1],4,-1530992060),o=I(o,n,i,r,t[s+4],11,1272893353),r=I(r,o,n,i,t[s+7],16,-155497632),i=I(i,r,o,n,t[s+10],23,-1094730640),n=I(n,i,r,o,t[s+13],4,681279174),o=I(o,n,i,r,t[s],11,-358537222),r=I(r,o,n,i,t[s+3],16,-722521979),i=I(i,r,o,n,t[s+6],23,76029189),n=I(n,i,r,o,t[s+9],4,-640364487),o=I(o,n,i,r,t[s+12],11,-421815835),r=I(r,o,n,i,t[s+15],16,530742520),n=E(n,i=I(i,r,o,n,t[s+2],23,-995338651),r,o,t[s],6,-198630844),o=E(o,n,i,r,t[s+7],10,1126891415),r=E(r,o,n,i,t[s+14],15,-1416354905),i=E(i,r,o,n,t[s+5],21,-57434055),n=E(n,i,r,o,t[s+12],6,1700485571),o=E(o,n,i,r,t[s+3],10,-1894986606),r=E(r,o,n,i,t[s+10],15,-1051523),i=E(i,r,o,n,t[s+1],21,-2054922799),n=E(n,i,r,o,t[s+8],6,1873313359),o=E(o,n,i,r,t[s+15],10,-30611744),r=E(r,o,n,i,t[s+6],15,-1560198380),i=E(i,r,o,n,t[s+13],21,1309151649),n=E(n,i,r,o,t[s+4],6,-145523070),o=E(o,n,i,r,t[s+11],10,-1120210379),r=E(r,o,n,i,t[s+2],15,718787259),i=E(i,r,o,n,t[s+9],21,-343485551),n=v(n,a),i=v(i,c),r=v(r,d),o=v(o,l)}return[n,i,r,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,n=new Uint32Array(y(e)),i=0;i<e;i+=8)n[i>>5]|=(255&t[i/8])<<i%32;return n}(t),8*t.length))})),S=function(t,e,n){var i=(t=t||{}).random||(t.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=i[r];return e}return l(i)};function A(t,e,n,i){switch(t){case 0:return e&n^~e&i;case 1:case 3:return e^n^i;case 2:return e&n^e&i^n&i}}function P(t,e){return t<<e|t>>>32-e}const M=w("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var i=unescape(encodeURIComponent(t));t=[];for(var r=0;r<i.length;++r)t.push(i.charCodeAt(r))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s),c=0;c<s;++c){for(var d=new Uint32Array(16),l=0;l<16;++l)d[l]=t[64*c+4*l]<<24|t[64*c+4*l+1]<<16|t[64*c+4*l+2]<<8|t[64*c+4*l+3];a[c]=d}a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295;for(var h=0;h<s;++h){for(var u=new Uint32Array(80),p=0;p<16;++p)u[p]=a[h][p];for(var f=16;f<80;++f)u[f]=P(u[f-3]^u[f-8]^u[f-14]^u[f-16],1);for(var m=n[0],g=n[1],w=n[2],y=n[3],v=n[4],_=0;_<80;++_){var C=Math.floor(_/20),b=P(m,5)+A(C,g,w,y)+v+e[C]+u[_]>>>0;v=y,y=w,w=P(g,30)>>>0,g=m,m=b}n[0]=n[0]+m>>>0,n[1]=n[1]+g>>>0,n[2]=n[2]+w>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+v>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]})),L="00000000-0000-0000-0000-000000000000",R=function(t){if(!a(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var i={};(()=>{var t=i;Object.defineProperty(t,"B",{value:!0}),t.d=async function(t){const n={};let i=!1,c=!1;if(void 0===t.api&&(t.api=s),void 0===t.logger&&(t.logger=r),t.api.fin)if("undefined"!=typeof window&&"object"==typeof window.fin)t.logger.info("Fin API instance already exists. Using the reference that exists in the window object."),n.fin=window.fin;else{let r;try{if(t.logger.info(`Creating Fin API instance through @openfin/core-web connect using the following options. \n\t\t\t\t\tConnect Options: \n\t\t\t\t\t${JSON.stringify(t.connectOptions)} \n\t\t\t\t\tRequest Connect Options:\n\t\t\t\t\t${JSON.stringify(t.requestConnectOptions)}`),void 0!==t.connectOptions)r=await(0,e.connect)(t.connectOptions);else if(void 0!==t.requestConnectOptions&&"request"===t.requestConnectOptions.strategy){const n=await a(t.requestConnectOptions);r=await(0,e.connect)(n)}else r=await(0,e.connect)(o)}catch(n){if(n instanceof Error&&n.message.includes("Broker URL was not specified nor provided by a platform container")&&"request-on-failure"===t.requestConnectOptions?.strategy)try{const n=await a(t.requestConnectOptions);r=await(0,e.connect)(n)}catch(e){t.logger.error(`Error creating Fin API instance through @openfin/core-web connect using the following options: \n\t\t\t\t\t\t\tConnect Options: \n\t\t\t\t\t\t\t${JSON.stringify(t.connectOptions)} \n\t\t\t\t\t\t\tRequest Connect Options:\n\t\t\t\t\t\t\t${JSON.stringify(t.requestConnectOptions)}`,e)}else t.logger.error(`Error creating Fin API instance through @openfin/core-web connect using the following options: \n\t\t\t\t\t\tConnect Options: \n\t\t\t\t\t\t${JSON.stringify(t.connectOptions)} \n\t\t\t\t\t\tRequest Connect Options:\n\t\t\t\t\t\t${JSON.stringify(t.requestConnectOptions)}`,n)}if(void 0===r)throw new Error("Failed to create a fin API instance.");n.fin=r,i=!0}if(t.api.fdc3)if("undefined"!=typeof window&&"object"==typeof window.fdc3)t.logger.info("fdc3 API instance already exists. Using the reference that exists in the window object."),n.fdc3=window.fdc3;else if(void 0!==n.fin?.me?.interop?.getFDC3){const e=t.api.fdc3Version??"2.0";try{t.logger.info(`Creating fdc3 API through the @openfin/core-web getFDC3 function specifying version ${e}.`),n.fdc3=await n.fin.me.interop.getFDC3(e),c=!0}catch(n){t.logger.error(`Error creating fdc3 API through the @openfin/core-web getFDC3 function specifying version ${e}.`,n)}}else t.logger.error("Creating an fdc3 API through the @openfin/core-web getFDC3 function isn't possible without the @openfin/core-web fin api being available. If you are running inside of a container please enable FDC3 for your view/window.");if(void 0!==t.target){const e=t.target===window;if(void 0!==n.fin&&(t.target.fin=n.fin,e&&i)){const t=new CustomEvent("finReady");window.dispatchEvent(t)}if(void 0!==n.fdc3&&(t.target.fdc3=n.fdc3,e&&c)){const t=new CustomEvent("fdc3Ready");window.dispatchEvent(t)}}return n};const e=n(67),r={error:console.error,warn:console.warn,info:console.info},o={connectionInheritance:"enabled"},s={fin:!0,fdc3:!0,fdc3Version:"2.0"};async function a(t){return new Promise(((e,n)=>{const i=setTimeout((()=>{n(new Error("Timed out waiting for connection options."))}),t.timeout??3e3);window.addEventListener("message",(async function r(o){if(Array.isArray(t.receivingOrigin)&&!t.receivingOrigin.includes(o.origin))n(new Error(`Received message from unexpected origin: ${o.origin}`));else if(o.data&&"openfin.coreWeb.connectConfig"===o.data.type){window.removeEventListener("message",r);const t=o.data.connectConfig;void 0===t?n(new Error("No connection options were provided.")):(clearTimeout(i),e(t))}}));let r=window.top??window.parent;"parent"===t.target&&(r=window.parent),r.postMessage({type:"openfin.coreWeb.connectConfig"},t.targetOrigin??"*")}))}})();var r=i.B,o=i.d;export{r as __esModule,o as getAPI};
//# sourceMappingURL=web.client.api.bundle.js.map